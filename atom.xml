<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>William&#39;s éš¨æ‰‹æœ­è¨˜</title>
  
  <subtitle>Blog of William</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://a10000005588.github.io/"/>
  <updated>2021-02-15T10:40:21.313Z</updated>
  <id>http://a10000005588.github.io/</id>
  
  <author>
    <name>William L.K.</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Go CLI Playbook å­¸ç¿’ç­†è¨˜</title>
    <link href="http://a10000005588.github.io/2021/02/15/go-cli/"/>
    <id>http://a10000005588.github.io/2021/02/15/go-cli/</id>
    <published>2021-02-15T10:38:03.000Z</published>
    <updated>2021-02-15T10:40:21.313Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹ç‚ºå­¸ç¿’æœ¬èª²ç¨‹ <a href="https://app.pluralsight.com/library/courses/go-cli-playbook/table-of-contents" target="_blank" rel="noopener">Pluralshight: The Go CLI Playbook</a> æ‰€è¨˜éŒ„çš„ç­†è¨˜ï¼Œäº†è§£Golangæœ¬èº«æ‰€æä¾›çš„æŒ‡ä»¤é›†å·¥å…·è¦å¦‚ä½•ä½¿ç”¨</p><p><a href="https://app.pluralsight.com/course-player?clipId=38b3a654-cbfd-436c-acb1-df088dfb5a48" target="_blank" rel="noopener">https://app.pluralsight.com/course-player?clipId=38b3a654-cbfd-436c-acb1-df088dfb5a48</a></p><h2 id="Go-Command-åŠŸèƒ½"><a href="#Go-Command-åŠŸèƒ½" class="headerlink" title="Go Command åŠŸèƒ½"></a>Go Command åŠŸèƒ½</h2><p>Go çš„åŸºæœ¬Commandå¯ä»¥æä¾›ä»¥ä¸‹åŠŸèƒ½</p><ul><li>Building Application: æŠŠ<code>.go</code>æª”æ¡ˆç·¨è­¯æˆåŸ·è¡Œæª”</li><li>Testing Application: æ¸¬è©¦<code>.go</code>ç¨‹å¼</li><li>Profiling Application: æ•ˆèƒ½æ¸¬è©¦</li><li>Managing Workspaces: ç®¡ç†é–‹ç™¼ç’°å¢ƒ</li><li>Interacting with Environment: èˆ‡ç’°å¢ƒäº’å‹•</li></ul><h3 id="Go-Commandçš„åˆ—è¡¨"><a href="#Go-Commandçš„åˆ—è¡¨" class="headerlink" title="Go Commandçš„åˆ—è¡¨"></a>Go Commandçš„åˆ—è¡¨</h3><p>åœ¨çµ‚ç«¯æ©Ÿä¸‹ <code>go</code> æŒ‡ä»¤ï¼Œå°±æœƒé¡¯ç¤ºgo commandçš„è©³ç´°è³‡è¨Š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">âœ go</span><br><span class="line">Go is a tool for managing Go source code.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line"></span><br><span class="line">        go command [arguments]</span><br><span class="line"></span><br><span class="line">The commands are:</span><br><span class="line"></span><br><span class="line">        build       compile packages and dependencies</span><br><span class="line">        clean       remove object files and cached files</span><br><span class="line">        doc         show documentation for package or symbol</span><br><span class="line">        env         print Go environment information</span><br><span class="line">        bug         start a bug report</span><br><span class="line">        fix         update packages to use new APIs</span><br><span class="line">        fmt         gofmt (reformat) package sources</span><br><span class="line">        generate    generate Go files by processing source</span><br><span class="line">        get         download and install packages and dependencies</span><br><span class="line">        install     compile and install packages and dependencies</span><br><span class="line">        list        list packages</span><br><span class="line">        run         compile and run Go program</span><br><span class="line">        test        test packages</span><br><span class="line">        tool        run specified go tool</span><br><span class="line">        version     print Go version</span><br><span class="line">        vet         report likely mistakes in packages</span><br><span class="line"></span><br><span class="line">Use &quot;go help [command]&quot; for more information about a command.</span><br><span class="line"></span><br><span class="line">Additional help topics:</span><br><span class="line"></span><br><span class="line">        c           calling between Go and C</span><br><span class="line">        buildmode   build modes</span><br><span class="line">        cache       build and test caching</span><br><span class="line">        filetype    file types</span><br><span class="line">        gopath      GOPATH environment variable</span><br><span class="line">        environment environment variables</span><br><span class="line">        importpath  import path syntax</span><br><span class="line">        packages    package lists</span><br><span class="line">        testflag    testing flags</span><br><span class="line">        testfunc    testing functions</span><br><span class="line"></span><br><span class="line">Use &quot;go help [topic]&quot; for more information about that topic.</span><br></pre></td></tr></table></figure></p><h3 id="å¯é€é-go-help-å¯çœ‹åˆ°ç‰¹å®šcommandçš„æŒ‡ä»¤"><a href="#å¯é€é-go-help-å¯çœ‹åˆ°ç‰¹å®šcommandçš„æŒ‡ä»¤" class="headerlink" title="å¯é€é go help å¯çœ‹åˆ°ç‰¹å®šcommandçš„æŒ‡ä»¤"></a>å¯é€é <code>go help</code> å¯çœ‹åˆ°ç‰¹å®šcommandçš„æŒ‡ä»¤</h3><p>å‡å¦‚è¦çœ‹go testçš„ä»‹ç´¹ï¼Œé‚£å°±ä¸‹é€™è¡ŒæŒ‡ä»¤ <code>go help test</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">âœ go help test</span><br><span class="line">usage: go test [build/test flags] [packages] [build/test flags &amp; test binary flags]</span><br><span class="line"></span><br><span class="line">&apos;Go test&apos; automates testing the packages named by the import paths.</span><br><span class="line">It prints a summary of the test results in the format:</span><br><span class="line"></span><br><span class="line">        ok   archive/tar   0.011s</span><br><span class="line">        FAIL archive/zip   0.022s</span><br><span class="line">        ok   compress/gzip 0.033s</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">followed by detailed output for each failed package.</span><br><span class="line"></span><br><span class="line">&apos;Go test&apos; recompiles each package along with any files with names matching</span><br><span class="line">the file pattern &quot;*_test.go&quot;.</span><br><span class="line">These additional files can contain test functions, benchmark functions, and</span><br><span class="line">example functions. See &apos;go help testfunc&apos; for more.</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">The test binary also accepts flags that control execution of the test; these</span><br><span class="line">flags are also accessible by &apos;go test&apos;. See &apos;go help testflag&apos; for details.</span><br><span class="line"></span><br><span class="line">For more about build flags, see &apos;go help build&apos;.</span><br><span class="line">For more about specifying packages, see &apos;go help packages&apos;.</span><br></pre></td></tr></table></figure><h2 id="go-env-æŸ¥çœ‹ç’°å¢ƒè®Šæ•¸"><a href="#go-env-æŸ¥çœ‹ç’°å¢ƒè®Šæ•¸" class="headerlink" title="go env æŸ¥çœ‹ç’°å¢ƒè®Šæ•¸"></a><code>go env</code> æŸ¥çœ‹ç’°å¢ƒè®Šæ•¸</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt; go env</span><br><span class="line"></span><br><span class="line">GOARCH=&quot;amd64&quot;</span><br><span class="line">GOBIN=&quot;/Users/username/go/bin&quot;</span><br><span class="line">GOCACHE=&quot;/Users/username/Library/Caches/go-build&quot;</span><br><span class="line">GOEXE=&quot;&quot;</span><br><span class="line">GOHOSTARCH=&quot;amd64&quot;</span><br><span class="line">GOHOSTOS=&quot;darwin&quot;</span><br><span class="line">GOOS=&quot;darwin&quot;</span><br><span class="line">GOPATH=&quot;/Users/username/go&quot;</span><br><span class="line">GORACE=&quot;&quot;</span><br><span class="line">GOROOT=&quot;/usr/local/Cellar/go/1.10.2/libexec&quot;</span><br><span class="line">GOTMPDIR=&quot;&quot;</span><br><span class="line">GOTOOLDIR=&quot;/usr/local/Cellar/go/1.10.2/libexec/pkg/tool/darwin_amd64&quot;</span><br><span class="line">GCCGO=&quot;gccgo&quot;</span><br><span class="line">CC=&quot;clang&quot;</span><br><span class="line">CXX=&quot;clang++&quot;</span><br><span class="line">CGO_ENABLED=&quot;1&quot;</span><br><span class="line">CGO_CFLAGS=&quot;-g -O2&quot;</span><br><span class="line">CGO_CPPFLAGS=&quot;&quot;</span><br><span class="line">CGO_CXXFLAGS=&quot;-g -O2&quot;</span><br><span class="line">CGO_FFLAGS=&quot;-g -O2&quot;</span><br><span class="line">CGO_LDFLAGS=&quot;-g -O2&quot;</span><br><span class="line">PKG_CONFIG=&quot;pkg-config&quot;</span><br><span class="line">GOGCCFLAGS=&quot;-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/3t/8jsg2cz52yn2glq8rk_9y7x40000gn/T/go-build760606218=/tmp/go-build -gno-record-gcc-switches -fno-common&quot;</span><br></pre></td></tr></table></figure><h2 id="go-run-åŸ·è¡Œç¨‹å¼"><a href="#go-run-åŸ·è¡Œç¨‹å¼" class="headerlink" title="go run åŸ·è¡Œç¨‹å¼"></a><code>go run</code> åŸ·è¡Œç¨‹å¼</h2><blockquote><p>æ³¨æ„ï¼Œè‹¥è¦é‹ç¨‹<code>go run</code>ï¼Œéœ€è¦åœ¨<code>$GOPATH</code>åº•ä¸‹çš„<code>src</code>ç›®éŒ„é€²è¡Œ</p></blockquote><p>é‹è¡Œä¸€å€‹åŒ…å«main()æ–¹æ³•çš„ç¨‹å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; go run main.go</span><br></pre></td></tr></table></figure><h3 id="é€é-go-run-raceä¾†åµæ¸¬æ˜¯å¦æœƒæœ‰race-conditionçš„ç‹€æ³ç™¼ç”Ÿ"><a href="#é€é-go-run-raceä¾†åµæ¸¬æ˜¯å¦æœƒæœ‰race-conditionçš„ç‹€æ³ç™¼ç”Ÿ" class="headerlink" title="é€é go run --raceä¾†åµæ¸¬æ˜¯å¦æœƒæœ‰race conditionçš„ç‹€æ³ç™¼ç”Ÿ"></a>é€é <code>go run --race</code>ä¾†åµæ¸¬æ˜¯å¦æœƒæœ‰race conditionçš„ç‹€æ³ç™¼ç”Ÿ</h3><p>è‹¥ç›®å‰æœ‰å€‹ä½¿ç”¨<code>gorouting</code>çš„ç¨‹å¼ï¼Œè‹¥è¦åµæ¸¬æ˜¯å¦æœƒç™¼ç”Ÿrace conditionç‹€æ³ï¼Œå¯ä»¥åŠ ä¸Š<code>-race</code>é€™å€‹flag</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥æœ‰race conditionï¼Œgo toolæœƒç”¢å‡ºå ±å‘Šä¾†è§£é‡‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">âœ go run -race race_condition/main.go </span><br><span class="line">==================</span><br><span class="line">WARNING: DATA RACE</span><br><span class="line">Read at 0x00c00013e010 by goroutine 8:</span><br><span class="line">  main.main.func1()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:13 +0x3c</span><br><span class="line"></span><br><span class="line">Previous write at 0x00c00013e010 by main goroutine:</span><br><span class="line">  main.main()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:10 +0x108</span><br><span class="line"></span><br><span class="line">Goroutine 8 (running) created at:</span><br><span class="line">  main.main()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:12 +0xe4</span><br><span class="line">==================</span><br><span class="line">==================</span><br><span class="line">WARNING: DATA RACE</span><br><span class="line">Read at 0x00c00013e010 by goroutine 7:</span><br><span class="line">  main.main.func1()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:13 +0x3c</span><br><span class="line"></span><br><span class="line">Previous write at 0x00c00013e010 by main goroutine:</span><br><span class="line">  main.main()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:10 +0x108</span><br><span class="line"></span><br><span class="line">Goroutine 7 (running) created at:</span><br><span class="line">  main.main()</span><br><span class="line">      /Users/a10000005588/go/src/race_condition/main.go:12 +0xe4</span><br><span class="line">==================</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">Found 2 data race(s)</span><br><span class="line">exit status 66</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€èˆ¬ä¾†èªªåœ¨devæ¨¡å¼æ™‚ï¼Œæœƒå»ºè­°æ¯æ¬¡é‹è¡Œå°ˆæ¡ˆæ™‚ï¼Œéƒ½åŠ ä¸Š-race</span><br></pre></td></tr></table></figure><h2 id="go-build-ç·¨è­¯ç¨‹å¼èˆ‡å…¶ä¾è³´"><a href="#go-build-ç·¨è­¯ç¨‹å¼èˆ‡å…¶ä¾è³´" class="headerlink" title="go build ç·¨è­¯ç¨‹å¼èˆ‡å…¶ä¾è³´"></a><code>go build</code> ç·¨è­¯ç¨‹å¼èˆ‡å…¶ä¾è³´</h2><p><code>go build</code>æœƒæŠŠå°ˆæ¡ˆç·¨è­¯æˆåŸ·è¡Œæª”</p><p>è‹¥ç›®å‰æœ‰å€‹åœ¨cmdsè³‡æ–™å¤¾å…§çš„å°ˆæ¡ˆå«åš <code>hello</code> ä¸¦å¼•ç”¨äº†<code>helloService</code>é€™å€‹ä¾è³´å…§çš„æ–¹æ³•</p><p>cmds/hello.go<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"helloService"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">helloService.SayHello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>helloService/msg.go<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> hello</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// SayHello represents a greeting to developer.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Hello gofer! I came from `cmds/hello` package."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é‚£åœ¨ <code>/cmds/hello</code>å°ˆæ¡ˆä¸­åŸ·è¡Œ <code>go build</code>ï¼Œæœƒåœ¨ç•¶å‰ç›®éŒ„ç”¢ç”Ÿ<code>hello</code>åŸ·è¡Œæª”</p><p><img src="./pics/01.png" alt=""></p><p>å¯ç›´æ¥åŸ·è¡Œè©²åŸ·è¡Œæª”</p><p><img src="./pics/02.png" alt=""></p><h3 id="ä½¿ç”¨-go-build-oå®šç¾©ç·¨è­¯å¾Œæª”æ¡ˆåç¨±"><a href="#ä½¿ç”¨-go-build-oå®šç¾©ç·¨è­¯å¾Œæª”æ¡ˆåç¨±" class="headerlink" title="ä½¿ç”¨ go build -oå®šç¾©ç·¨è­¯å¾Œæª”æ¡ˆåç¨±"></a>ä½¿ç”¨ <code>go build -o</code>å®šç¾©ç·¨è­¯å¾Œæª”æ¡ˆåç¨±</h3><p>å‡å¦‚è¦æŠŠç·¨è­¯æª”æ¡ˆå«åš<code>hello_exe.a</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœ <span class="keyword">go</span> build -o hello_exe.a</span><br></pre></td></tr></table></figure><p><img src="./pics/03.png" alt=""></p><h3 id="ä½¿ç”¨-go-build-i-ç·¨è­¯å°ˆæ¡ˆçš„ä¾è³´"><a href="#ä½¿ç”¨-go-build-i-ç·¨è­¯å°ˆæ¡ˆçš„ä¾è³´" class="headerlink" title="ä½¿ç”¨ go build -i ç·¨è­¯å°ˆæ¡ˆçš„ä¾è³´"></a>ä½¿ç”¨ <code>go build -i</code> ç·¨è­¯å°ˆæ¡ˆçš„ä¾è³´</h3><p>è‹¥å°å°ˆæ¡ˆé€²è¡Œç·¨è­¯æ™‚ï¼ŒåŠ ä¸Š<code>-i</code>åƒæ•¸ï¼ŒæœƒåŒæ™‚å°‡importçš„ä¾è³´ (ex:<code>helloService</code>)ä¹Ÿæœƒç·¨è­¯è©²ä¾è³´å€‘ä¸¦å®‰è£åœ¨ <code>$GOPATH/pkg</code>åº•ä¸‹</p><p><img src="./pics/04.png" alt=""></p><h3 id="åƒè€ƒ"><a href="#åƒè€ƒ" class="headerlink" title="åƒè€ƒ"></a>åƒè€ƒ</h3><p>Go Official Docs: Command go<br><a href="https://golang.org/cmd/go/#Compile%20packages%20and%20dependencies" target="_blank" rel="noopener">https://golang.org/cmd/go/#Compile%20packages%20and%20dependencies</a></p><h2 id="go-install-ç·¨è­¯å°ˆæ¡ˆæˆç‚ºpackage"><a href="#go-install-ç·¨è­¯å°ˆæ¡ˆæˆç‚ºpackage" class="headerlink" title="go install ç·¨è­¯å°ˆæ¡ˆæˆç‚ºpackage"></a><code>go install</code> ç·¨è­¯å°ˆæ¡ˆæˆç‚ºpackage</h2><p>æœƒå°‡å°ˆæ¡ˆ (main) é€²è¡Œç·¨è­¯æˆbinæª”æ¡ˆä¸¦æ”¾ç½®åœ¨<code>$GOPATH/bin</code>åº•ä¸‹</p><p>æœƒå°‡ä¾è³´ (package) é€²è¡Œç·¨è­¯ä¸¦å®‰è£åœ¨<code>$GOPATH/pkg</code>åº•ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœå·²ç¶“æœ‰å­˜åœ¨çš„ä¾è³´æˆ–æ˜¯binaryæª”æ¡ˆã€é‚£go installå°±ä¸æœƒæœ‰ä½œç”¨</span><br></pre></td></tr></table></figure><h3 id="go-install-nï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†ä¸æœƒçœŸæ­£åŸ·è¡Œ"><a href="#go-install-nï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†ä¸æœƒçœŸæ­£åŸ·è¡Œ" class="headerlink" title="go install -nï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†ä¸æœƒçœŸæ­£åŸ·è¡Œ"></a><code>go install -n</code>ï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†ä¸æœƒçœŸæ­£åŸ·è¡Œ</h3><p>å‡å¦‚æˆ‘å€‘åœ¨å°å‰›å‰›çš„helloServiceé€™å€‹ä¾è³´ï¼Œé€²è¡Œ<code>go install -n</code></p><p>æœƒçœ‹åˆ°ä¸æœƒåšä»€éº¼å‹•ä½œï¼Œå› ç‚ºå·²ç¶“æœ‰å®‰è£è©²ä¾è³´åœ¨<code>pkg</code>åº•ä¸‹</p><p><img src="./pics/05.png" alt=""></p><p>å°‡è©²ä¾è³´ç§»é™¤ï¼Œå†æ¬¡åŸ·è¡Œä¸€éï¼Œæœƒçœ‹åˆ°go toolåŸ·è¡Œäº†ä»€éº¼å‹•ä½œ</p><p><img src="./pics/06.png" alt=""></p><h3 id="go-install-xï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†æœƒçœŸæ­£åŸ·è¡Œ"><a href="#go-install-xï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†æœƒçœŸæ­£åŸ·è¡Œ" class="headerlink" title="go install -xï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†æœƒçœŸæ­£åŸ·è¡Œ"></a><code>go install -x</code>ï¼šé¡¯ç¤ºæœƒé€²è¡Œçš„å‹•ä½œï¼Œä½†æœƒçœŸæ­£åŸ·è¡Œ</h3><h4 id="å…¶ä»–flag"><a href="#å…¶ä»–flag" class="headerlink" title="å…¶ä»–flag"></a>å…¶ä»–flag</h4><ul><li>-p n: æŒ‡å®šç”¨å¤šå°‘å€‹cpuä¾†é€²è¡Œinstall, é è¨­æ˜¯å¯å–å¾—çš„æ•¸é‡</li></ul><h3 id="ç”¢ç”ŸShared-Librariesï¼Œä½¿ç”¨-buildmode-flag"><a href="#ç”¢ç”ŸShared-Librariesï¼Œä½¿ç”¨-buildmode-flag" class="headerlink" title="ç”¢ç”ŸShared Librariesï¼Œä½¿ç”¨-buildmode flag"></a>ç”¢ç”ŸShared Librariesï¼Œä½¿ç”¨<code>-buildmode</code> flag</h3><p>é€é <code>go build -buildmode</code> æˆ–æ˜¯ <code>go install -buildmode</code><br>å¯ä»¥åƒCæˆ–C++é‚£æ¨£ç”¢ç”ŸShared Librariesï¼Œä¾›å‹•æ…‹è¼‰å…¥</p><p>é€é<code>go help buildmode</code>å¯æŸ¥çœ‹æœ‰æä¾›å“ªäº›æ¨¡å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é è¨­-buildmodeæœƒä½¿ç”¨ archiveï¼šå°‡æª”æ¡ˆç·¨è­¯æˆ .a</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ -buildmode=sharedï¼šå°‡æª”æ¡ˆç·¨è­¯æˆå¯å‹•æ…‹è¼‰å…¥çš„shared libï¼Œæˆ–æ˜¯åœ¨runtimeæ™‚å¯é€£çµ</span><br></pre></td></tr></table></figure><p>å‡å¦‚å†ç”¨å‰›å‰›çš„ç¯„ä¾‹ï¼Œä¸€å€‹<code>cmds/hello.go</code>ä¸­å¼•ç”¨äº† helloServiceé€™å€‹package</p><p><img src="./pics/07.png" alt=""></p><h4 id="ä½¿ç”¨-buildmode-shared-ç”¢ç”Ÿä¾›goå‹•æ…‹é€£çµçš„Shared-Libraries"><a href="#ä½¿ç”¨-buildmode-shared-ç”¢ç”Ÿä¾›goå‹•æ…‹é€£çµçš„Shared-Libraries" class="headerlink" title="ä½¿ç”¨ -buildmode=shared ç”¢ç”Ÿä¾›goå‹•æ…‹é€£çµçš„Shared Libraries"></a>ä½¿ç”¨ <code>-buildmode=shared</code> ç”¢ç”Ÿä¾›goå‹•æ…‹é€£çµçš„Shared Libraries</h4><p>è‹¥è¦å°‡æŸå€‹packageç·¨è­¯æˆshared libraryï¼Œ</p><p>èˆ‰å€‹ä¾‹å­ï¼ŒæŠŠ<code>helloService</code> ç·¨è­¯æˆshared libraryä¸¦å®‰è£åœ¨<code>pkg</code>è³‡æ–™å¤¾ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœ go install -buildmode=shared helloService</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„: Macosä¸æ”¯æ´ -buildmode=shared<br>-buildmode=shared not supported on darwin/amd64</p></blockquote><p>æ¥è‘—ç·¨è­¯ä¸»ç¨‹å¼ï¼Œä¸¦æŒ‡å®šå…¶åŸ·è¡Œæª”å¯ä»¥å‹•æ…‹è¼‰å…¥(-linkshared) shared library</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœ go build -linkshared cmds/hello</span><br></pre></td></tr></table></figure><p>åŸ·è¡Œç·¨è­¯å¾Œçš„åŸ·è¡Œæª” <code>./hello</code> ï¼Œå¯çœ‹åˆ°å…¶çµæœ</p><p>ä¸éè‹¥å°‡<code>pkg</code>ä¸­ï¼Œå‰›å‰›go installçš„<code>helloService</code>çš„shared libraryçµ¦åˆªé™¤çš„è©±ï¼Œå†æ¬¡åŸ·è¡Œ <code>/.hello</code> é‚£å°±æœƒç™¼ç”Ÿç„¡æ³•åŸ·è¡Œç‹€æ³ã€‚</p><h4 id="ä½¿ç”¨-buildmode-c-archive-ç”¢ç”Ÿä¾›C-language-â€œéœæ…‹â€é€£çµçš„Shared-Libraries"><a href="#ä½¿ç”¨-buildmode-c-archive-ç”¢ç”Ÿä¾›C-language-â€œéœæ…‹â€é€£çµçš„Shared-Libraries" class="headerlink" title="ä½¿ç”¨ -buildmode=c-archive ç”¢ç”Ÿä¾›C language â€œéœæ…‹â€é€£çµçš„Shared Libraries"></a>ä½¿ç”¨ <code>-buildmode=c-archive</code> ç”¢ç”Ÿä¾›C language â€œéœæ…‹â€é€£çµçš„Shared Libraries</h4><p>å¦‚æœæƒ³è¦å°‡pakcageç·¨è­¯æˆCå¯ä»¥è¼‰å…¥çš„shared libraryçš„è©±ï¼Œéœ€è¦å°pakcageçš„methodï¼ŒåŠ ä¸Š <code>//export functionName</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> helloService</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"C"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//export SayHello</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Hello gofer! I came from `cmds/hello` package."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥ä½¿ç”¨ <code>-buildmode=c-archive</code>çš„è©±ï¼Œå‰‡æœƒç”¢ç”Ÿå‡º <code>.h</code>èˆ‡<code>.a</code>çš„shared library</p><blockquote><p>æ³¨æ„: Macosé‹è¡Œ<code>-buildmode=c-archive</code> æœƒç„¡æ³•ç”¢ç”Ÿ <code>.h</code>æª”æ¡ˆ goç‰ˆæœ¬: go1.15 darwin/amd64</p></blockquote><p>æ¥è‘—å°±å¯ä»¥åœ¨Cèªè¨€å…§å¼•å…¥ç”¨Go buildå¥½çš„share library</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"hello.a"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  SayHello();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸ·è¡Œä¹‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc hello.c ./hello</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨-buildmode-c-shared-ç”¢ç”Ÿä¾›C-language-â€œå‹•æ…‹â€é€£çµçš„Shared-Libraries"><a href="#ä½¿ç”¨-buildmode-c-shared-ç”¢ç”Ÿä¾›C-language-â€œå‹•æ…‹â€é€£çµçš„Shared-Libraries" class="headerlink" title="ä½¿ç”¨ -buildmode=c-shared ç”¢ç”Ÿä¾›C language â€œå‹•æ…‹â€é€£çµçš„Shared Libraries"></a>ä½¿ç”¨ <code>-buildmode=c-shared</code> ç”¢ç”Ÿä¾›C language â€œå‹•æ…‹â€é€£çµçš„Shared Libraries</h4><p>åŒç”¨goç”¢ç”Ÿå‡ºshared library</p><h4 id="ä½¿ç”¨-buildmode-plugin-å°‡æ‰€æœ‰importçš„packagesï¼Œæ‰“åŒ…æˆgo-plugin"><a href="#ä½¿ç”¨-buildmode-plugin-å°‡æ‰€æœ‰importçš„packagesï¼Œæ‰“åŒ…æˆgo-plugin" class="headerlink" title="ä½¿ç”¨ -buildmode=plugin å°‡æ‰€æœ‰importçš„packagesï¼Œæ‰“åŒ…æˆgo plugin"></a>ä½¿ç”¨ <code>-buildmode=plugin</code> å°‡æ‰€æœ‰importçš„packagesï¼Œæ‰“åŒ…æˆgo plugin</h4><p>å¯ä»¥æŠŠå°ˆæ¡ˆéœ€è¦importçš„packageï¼Œæ‰“åŒ…æˆplugin</p><p>èˆ‰å€‹ä¾‹å­ï¼Œè‹¥ç¾åœ¨æˆ‘å€‘è¦å°‡pluginé€™ä¸€å€‹pakcageæ‰“åŒ…æˆplugin</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ThingToDo</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"Executing action"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€éä»¥ä¸‹æŒ‡ä»¤ï¼Œåšå‡ºä¸€å€‹pluginï¼Œæª”åå«åš plugin å‰¯æª”åç‚º<code>.so</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœ go build -buildmode=plugin -o=plugin.so plugin/plugin.go</span><br></pre></td></tr></table></figure></p><p>æ¥è‘—æˆ‘å€‘å®šç¾©äº†ä¸€å€‹å°å°ˆæ¡ˆï¼Œä¾†ä½¿ç”¨plugin</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"flag"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"plugin"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">path := flag.String(<span class="string">"plugin"</span>, <span class="string">""</span>, <span class="string">"Plugin to execute"</span>)</span><br><span class="line"></span><br><span class="line">flag.Parse()</span><br><span class="line">    <span class="comment">// å¦‚æœåŸ·è¡Œgoæ™‚æ²’æœ‰å¸¶ -pluginæŒ‡ä»¤</span></span><br><span class="line"><span class="keyword">if</span> *path == <span class="string">""</span> &#123;</span><br><span class="line">log.Fatal(<span class="string">"Path to plugin must be provided"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®€å–plugin</span></span><br><span class="line">p, err := plugin.Open(*path)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°‹æ‰¾pluginæ˜¯å¦æœ‰ThingToDoé€™å€‹æ–¹æ³•</span></span><br><span class="line">f, err := p.Lookup(<span class="string">"ThingToDo"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">thingToDo, ok := f.(<span class="function"><span class="keyword">func</span><span class="params">()</span>)</span></span><br><span class="line"><span class="function"><span class="title">if</span> !<span class="title">ok</span></span> &#123;</span><br><span class="line">log.Fatal(<span class="string">"Could not find function 'ThingToDo' in plugin"</span>)</span><br><span class="line">&#125;</span><br><span class="line">thingToDo()</span><br><span class="line">log.Println(<span class="string">"Did the thing"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—é‹è¡Œä¸‹é¢æŒ‡ä»¤ä½¿ç”¨plugin</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœ go run action/action.go -plugin=./plugin.so</span><br></pre></td></tr></table></figure><p>å¦‚æœpluginå­˜åœ¨çš„è©±ï¼Œå°±å¯ä»¥åŸ·è¡Œ <code>plugin.so</code>å…§çš„<code>ThingToDo</code>æ–¹æ³•</p><p>åŸ·è¡Œçµæœ<br><img src="./pics/08.png" alt=""></p><h4 id="åƒè€ƒ-1"><a href="#åƒè€ƒ-1" class="headerlink" title="åƒè€ƒ"></a>åƒè€ƒ</h4><p>Golangçš„æ„å»ºæ¨¡å¼ - Chen Jiehua<br><a href="https://chenjiehua.me/golang/golang-buildmode.html" target="_blank" rel="noopener">https://chenjiehua.me/golang/golang-buildmode.html</a></p><h2 id="go-test-æ’°å¯«å–®å…ƒæ¸¬è©¦Unit-Testing-Programs"><a href="#go-test-æ’°å¯«å–®å…ƒæ¸¬è©¦Unit-Testing-Programs" class="headerlink" title="go test æ’°å¯«å–®å…ƒæ¸¬è©¦Unit Testing Programs"></a><code>go test</code> æ’°å¯«å–®å…ƒæ¸¬è©¦Unit Testing Programs</h2><p>é€é <code>go test</code> å¯æ¸¬è©¦golangæ’°å¯«çš„ç¨‹å¼çš„Inputèˆ‡Outputæ˜¯å¦æ­£ç¢º</p><h3 id="æ¸¬è©¦éœ€æ³¨æ„çš„è¦å‰‡"><a href="#æ¸¬è©¦éœ€æ³¨æ„çš„è¦å‰‡" class="headerlink" title="æ¸¬è©¦éœ€æ³¨æ„çš„è¦å‰‡"></a>æ¸¬è©¦éœ€æ³¨æ„çš„è¦å‰‡</h3><p>ç”±æ–¼goæœ¬èº«å°æ¸¬è©¦æœ‰è‘—åš´è¬¹çš„è¦å‰‡ï¼Œæ•…å¯ä»¥é¿å…åƒå…¶ä»–èªè¨€é‚£æ¨£æœ‰å„ç¨®ä¸åŒæ¸¬è©¦çš„æ¡†æ¶ï¼Œä»¥çµ±ä¸€æ¸¬è©¦çš„æ¨£å¼</p><p>å…¶è¦å‰‡å¦‚ä¸‹ï¼š</p><ul><li>è‹¥æœ‰å®šç¾©æ¸¬è©¦çš„æª”æ¡ˆåç¨±ï¼Œéœ€è¦ä»¥ <code>_test.go</code>æœ€çµå°¾å‘½å</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mylib_test.go</span><br></pre></td></tr></table></figure><ul><li>è‹¥éœ€è¦è¢«æ¸¬è©¦çš„æ–¹æ³•ï¼Œè«‹ä»¥ <code>Test_</code> ç‚ºé–‹é ­</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func Test_MyFunction() &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸ·è¡Œæ¸¬è©¦"><a href="#åŸ·è¡Œæ¸¬è©¦" class="headerlink" title="åŸ·è¡Œæ¸¬è©¦"></a>åŸ·è¡Œæ¸¬è©¦</h3><p>è‹¥æœ‰å€‹å°ˆæ¡ˆå«åš <code>testing_example</code>ï¼Œå…¶ç›®éŒ„æ¶æ§‹å¦‚ä¸‹</p><p><img src="./pics/09.png" alt=""></p><p><code>testing_example/mylib_test.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test_BasicChecks</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">t.Run(<span class="string">"Go can add"</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span>+<span class="number">1</span> != <span class="number">2</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">t.Run(<span class="string">"Go can concatenate strings"</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="string">"Hello, "</span>+<span class="string">"Go"</span> != <span class="string">"Hello, Go"</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶å­packageä¹Ÿæœ‰å®šç¾©testing file <code></code>testing_example/childlib/childlib_test.go`<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> childlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test_MoreBasics</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="number">10</span><span class="number">-5</span> != <span class="number">5</span> &#123;</span><br><span class="line">t.Error(<span class="string">"Failed to subtract correctly"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åŸ·è¡Œæ¸¬è©¦çš„ç¯„ç–‡"><a href="#åŸ·è¡Œæ¸¬è©¦çš„ç¯„ç–‡" class="headerlink" title="åŸ·è¡Œæ¸¬è©¦çš„ç¯„ç–‡"></a>åŸ·è¡Œæ¸¬è©¦çš„ç¯„ç–‡</h3><p>è‹¥è¦å°å°ˆæ¡ˆåŸ·è¡ŒUnit Testï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test testing_example </span><br><span class="line">ok      testing_example 0.014s</span><br></pre></td></tr></table></figure><p>ä½†æœƒç™¼ç¾child packageçš„æ¸¬è©¦æ²’æœ‰åŸ·è¡Œåˆ°ï¼Œæ‰€ä»¥è‹¥è¦å°packageå…§æ‰€æœ‰å­<br>packageéƒ½é€²è¡Œæ¸¬è©¦ï¼Œé‚£éœ€è¦åŠ ä¸Š <code>/...</code> åšéè¿´å°‹æ‰¾çš„å‹•ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via ğŸ¹ v1.15 </span><br><span class="line">âœ go test testing_example/...</span><br><span class="line">ok      testing_example (cached)</span><br><span class="line">ok      testing_example/childlib        0.015s</span><br></pre></td></tr></table></figure><h3 id="æ¸¬è©¦å¯ä»¥å¤¾å¸¶çš„åƒæ•¸-flags"><a href="#æ¸¬è©¦å¯ä»¥å¤¾å¸¶çš„åƒæ•¸-flags" class="headerlink" title="æ¸¬è©¦å¯ä»¥å¤¾å¸¶çš„åƒæ•¸ flags"></a>æ¸¬è©¦å¯ä»¥å¤¾å¸¶çš„åƒæ•¸ flags</h3><p>é€é <code>go help testflag</code> å¯ä»¥æŸ¥çœ‹åŸ·è¡Œæ¸¬è©¦æ™‚å¯ä»¥å®¢è£½åŒ–çš„é¸æ“‡</p><p>åˆ—èˆ‰ä¸€äº›å¸¸ä½¿ç”¨çš„ï¼š</p><ul><li><code>-cpu</code>: æŒ‡å®šæ¸¬è©¦æ™‚ä½¿ç”¨çš„CPUæ•¸é‡ï¼Œé è¨­æ˜¯æœƒä½¿ç”¨ <code>GOMAXPROCS</code>åƒæ•¸çš„å€¼</li><li><code>-parallel</code>: æ¸¬è©¦æ™‚å¯ä»¥ä¸¦è¡Œè™•ç†ï¼Œä½†åªæœ‰æŒ‡å®šFunctionæ‰æœƒè¢«ä¸¦è¡Œè™•ç†</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test_BasicChecks</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">t.Parallel()  <span class="comment">// é€²è¡Œä¸¦è¡Œæ¸¬è©¦</span></span><br><span class="line">t.Run(<span class="string">"Go can add"</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span>+<span class="number">1</span> != <span class="number">2</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>-list</code>: å¯é€éæ­£å‰‡è¡¨é”å¼éæ¿¾å‡ºæ¸¬è©¦æ–¹æ³•åç¨±ï¼Œå†æ¸¬è©¦æ™‚æœƒåˆ—å‡ºç¬¦åˆçš„æ¸¬è©¦æ–¹æ³•çµ¦</li></ul><p>å‡å¦‚è¦åˆ—å‡ºæœ‰åŒ…å« <code>Basics</code>çš„æ¸¬è©¦æ–¹æ³•åç¨±ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -list Basics testing_example/...</span><br><span class="line">ok      testing_example 0.022s</span><br><span class="line">Test_MoreBasics   // åˆ—å‡º</span><br><span class="line">ok      testing_example/childlib        0.023s</span><br></pre></td></tr></table></figure></p><ul><li><code>-run</code>: è·ŸListå¾ˆåƒï¼Œä½†åªæœƒåŸ·è¡Œç¬¦åˆæ­£å‰‡è¡¨é”å¼çš„æ¸¬è©¦æ–¹æ³•<ul><li>ä½¿ç”¨æ™‚æ©Ÿï¼šè‹¥é–‹ç™¼å‡ºå­å°ˆæ¡ˆçš„æ¸¬è©¦æ–¹æ³•ï¼Œé€é<code>-run</code>æŒ‡å®šè©²å­å°ˆæ¡ˆçš„scopeåŸ·è¡Œæ¸¬è©¦å°±å¥½ï¼Œå°±å¯ä»¥çœå»ä¸å°‘æ™‚é–“</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -run Basics testing_example/...</span><br><span class="line">ok      testing_example 0.024s [no tests to run]</span><br><span class="line">ok      testing_example/childlib        0.022s</span><br></pre></td></tr></table></figure><ul><li><code>-timeout d</code>: è¶…éå¤šä¹…å°±åœæ­¢æ¸¬è©¦ï¼Œé è¨­ç‚º10åˆ†é˜</li><li><code>-v</code>: æ¸¬è©¦æ™‚å°‡è©³ç´°çµæœåˆ—å‡ºä¾†</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -v testing_example/...</span><br><span class="line">=== RUN   Test_BasicChecks</span><br><span class="line">=== PAUSE Test_BasicChecks</span><br><span class="line">=== CONT  Test_BasicChecks</span><br><span class="line">=== RUN   Test_BasicChecks/Go_can_add</span><br><span class="line">=== RUN   Test_BasicChecks/Go_can_concatenate_strings</span><br><span class="line">--- PASS: Test_BasicChecks (0.00s)</span><br><span class="line">    --- PASS: Test_BasicChecks/Go_can_add (0.00s)</span><br><span class="line">    --- PASS: Test_BasicChecks/Go_can_concatenate_strings (0.00s)</span><br><span class="line">PASS</span><br><span class="line">ok      testing_example 0.017s</span><br><span class="line">=== RUN   Test_MoreBasics</span><br><span class="line">=== PAUSE Test_MoreBasics</span><br><span class="line">=== CONT  Test_MoreBasics</span><br><span class="line">--- PASS: Test_MoreBasics (0.00s)</span><br><span class="line">PASS</span><br><span class="line">ok      testing_example/childlib        0.025s</span><br></pre></td></tr></table></figure><ul><li><code>-count</code>: æŒ‡å®šåŸ·è¡Œæ¸¬è©¦çš„æ¬¡æ•¸</li><li><code>-cover</code>: é¡¯ç¤ºæ¸¬è©¦çš„æ¶µè“‹ç¯„åœè³‡è¨Š</li></ul><h3 id="æ¸¬è©¦çš„æ¶µè“‹-Code-Coverage"><a href="#æ¸¬è©¦çš„æ¶µè“‹-Code-Coverage" class="headerlink" title="æ¸¬è©¦çš„æ¶µè“‹ Code Coverage"></a>æ¸¬è©¦çš„æ¶µè“‹ Code Coverage</h3><p>å¯ä»¥é€é <code>go test -cover</code> ä¾†æŸ¥çœ‹ç›®å‰æ¸¬è©¦é …ç›®æ¶µè“‹äº†å¤šå°‘é–‹ç™¼çš„å…§å®¹</p><p>ä»¥ä¸‹ç‚ºæ¸¬è©¦çš„é …ç›®å…§å®¹ï¼š</p><p><img src="./pics/10.png" alt=""></p><p><code>mylib.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">(l, r <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> l + r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">subractor</span><span class="params">(l, r <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> l - r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>mylib_test.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨é€™é‚Šåªæœ‰æ¸¬è©¦adderæ–¹æ³•ï¼Œæ²’æœ‰subractoræ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdder</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> adder(<span class="number">2</span>, <span class="number">5</span>) != <span class="number">7</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ä¸Šè¿°çš„ç¯„ä¾‹åªæ¸¬è©¦ä¸€å€‹æ–¹æ³•<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/<span class="keyword">go</span>/src via v1<span class="number">.15</span> </span><br><span class="line">âœ <span class="keyword">go</span> test -cover testing_example_1 </span><br><span class="line">ok      testing_example_1       <span class="number">0.013s</span>  coverage: <span class="number">50.0</span>% of statements</span><br></pre></td></tr></table></figure></p><h4 id="é€égo-test-coverpkg-æŒ‡å®šæ¸¬è©¦ç¨‹å¼å¼•ç”¨çš„package"><a href="#é€égo-test-coverpkg-æŒ‡å®šæ¸¬è©¦ç¨‹å¼å¼•ç”¨çš„package" class="headerlink" title="é€égo test -coverpkg æŒ‡å®šæ¸¬è©¦ç¨‹å¼å¼•ç”¨çš„package"></a>é€é<code>go test -coverpkg</code> æŒ‡å®šæ¸¬è©¦ç¨‹å¼å¼•ç”¨çš„package</h4><p>å†ç”¨ä¸Šè¿°çš„ç¯„ä¾‹ï¼Œæˆ‘å€‘æ‰“ç®—æ¸¬è©¦å°ˆæ¡ˆ <code>testing_example_1</code>ä¸­çš„ <code>fmt</code> èˆ‡ <code>testing_example_1</code>æœ¬èº«è‡ªå·±é€™å…©å€‹pacakgeï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -coverpkg testing_example_1, fmt testing_example_1 </span><br><span class="line">warning: no packages being tested depend on matches for pattern </span><br><span class="line">ok      fmt     0.089s  coverage: 0.0% of statements in testing_example_1, </span><br><span class="line">ok      testing_example_1       0.019s  coverage: 50.0% of statements in testing_example_1,</span><br></pre></td></tr></table></figure><h4 id="é€égo-test-coverprofile-ç”¢å‡ºæ¸¬è©¦çš„å ±å‘Š"><a href="#é€égo-test-coverprofile-ç”¢å‡ºæ¸¬è©¦çš„å ±å‘Š" class="headerlink" title="é€égo test -coverprofile ç”¢å‡ºæ¸¬è©¦çš„å ±å‘Š"></a>é€é<code>go test -coverprofile</code> ç”¢å‡ºæ¸¬è©¦çš„å ±å‘Š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -coverprofile cover.out testing_example_1 </span><br><span class="line">ok      testing_example_1       0.012s  coverage: 50.0% of statements</span><br></pre></td></tr></table></figure><p>åŒæ™‚æœƒç”¢ç”Ÿ <code>cover.out</code>é€™å€‹æ¸¬è©¦å ±å‘Šæª”æ¡ˆï¼Œå…§å®¹å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mode: set</span><br><span class="line">testing_example_1/mylib.go:3.26,5.2 1 1</span><br><span class="line">testing_example_1/mylib.go:7.30,9.2 1 0</span><br></pre></td></tr></table></figure></p><h4 id="é€é-go-tool-æŸ¥çœ‹æ¸¬è©¦å ±å‘Š"><a href="#é€é-go-tool-æŸ¥çœ‹æ¸¬è©¦å ±å‘Š" class="headerlink" title="é€é go tool æŸ¥çœ‹æ¸¬è©¦å ±å‘Š"></a>é€é go tool æŸ¥çœ‹æ¸¬è©¦å ±å‘Š</h4><p>å¯ä»¥é€é <code>go tool cover -html= æ¸¬è©¦å ±å‘Šæª”æ¡ˆåç¨±</code> ä¾†ç”¢ç”Ÿå‡ºä»¥ç¶²é æ–¹å¼ç€è¦½çš„å ±å‘Š</p><p>è‹¥è¦è§£æç”¢ç”Ÿå‡ºä¾†çš„å ±å‘Š <code>cover.out</code></p><p><code>go tool cover -html=cover.out</code></p><p>å¯ä»¥ç”¢å‡ºWebå‘ˆç¾ï¼Œæ¸¬è©¦çš„å ±å‘Š</p><p><img src="pics/11.png" alt=""><br><img src="https://i.imgur.com/SgATMg2.png" alt=""></p><p>å¦‚æœè¦çœ‹å‡ºæ›´è©³ç´°çš„æ¸¬è©¦å ±å‘Šçš„è©±ï¼Œä¾‹å¦‚æƒ³çœ‹åˆ°æ¸¬è©¦æ–¹æ³•è¢«åŸ·è¡Œå¹¾æ¬¡</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/<span class="keyword">go</span>/src via v1<span class="number">.15</span></span><br><span class="line">âœ <span class="keyword">go</span> test -covermode count -coverprofile cover.out testing_example_1 </span><br><span class="line">ok      testing_example_1       <span class="number">0.018s</span>  coverage: <span class="number">50.0</span>% of statements</span><br></pre></td></tr></table></figure><p>ä¸€æ¨£æœƒç”¢ç”Ÿå‡º <code>cover.out</code>æª”æ¡ˆï¼Œé€™æ™‚å†é€é <code>go tool cover -html</code></p><p><img src="pics/12.png" alt=""><br><img src="https://i.imgur.com/mncGfk7.png" alt=""></p><h3 id="é€²è¡Œå£“åŠ›æ¸¬è©¦-Benchmark-Testing"><a href="#é€²è¡Œå£“åŠ›æ¸¬è©¦-Benchmark-Testing" class="headerlink" title="é€²è¡Œå£“åŠ›æ¸¬è©¦ Benchmark Testing"></a>é€²è¡Œå£“åŠ›æ¸¬è©¦ Benchmark Testing</h3><p>golangçš„testå·¥å…·äº¦æä¾›benchmarkçš„æ¸¬è©¦ï¼Œå¯ä»¥çœ‹å‡ºè©²æ–¹æ³•éœ€è¦è€—è²»å¤šå°‘CPUè³‡æº</p><h4 id="è¦å‰‡"><a href="#è¦å‰‡" class="headerlink" title="è¦å‰‡"></a>è¦å‰‡</h4><p>éœ€è¦å®šç¾©æ–¹æ³•åç¨±å‰ç¶´ç‚º <code>Benchmark</code> ä¾‹å¦‚:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkAdder</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">adder(<span class="number">5</span>, <span class="number">7</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŒ‡ä»¤-go-test-bench"><a href="#æŒ‡ä»¤-go-test-bench" class="headerlink" title="æŒ‡ä»¤: go test -bench"></a>æŒ‡ä»¤: <code>go test -bench</code></h4><p>è‹¥è¦å°testing_example_2é€™å€‹å°ˆæ¡ˆä¸‹çš„æª”æ¡ˆï¼š<br><img src="pics/13.png" alt=""><br><img src="https://i.imgur.com/FPmr2HU.png" alt=""></p><p><code>mylib.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">(l, r <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> l + r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>mylib_test.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdder</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> adder(<span class="number">2</span>, <span class="number">5</span>) != <span class="number">7</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkAdder</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">adder(<span class="number">5</span>, <span class="number">7</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€™æ™‚é€é <code>go test -bench Adder testing_example_2</code>ï¼Œå°<code>testing_example_2</code>é€™å°ˆæ¡ˆå…§æœ‰åŒ…å« <code>Adder</code>çš„å£“æ¸¬æ–¹æ³•é€²è¡Œå£“åŠ›æ¸¬è©¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15</span><br><span class="line">âœ go test -bench Adder testing_example_2</span><br><span class="line">goos: darwin</span><br><span class="line">goarch: amd64</span><br><span class="line">pkg: testing_example_2</span><br><span class="line">BenchmarkAdder-4        1000000000               0.374 ns/op</span><br><span class="line">PASS</span><br><span class="line">ok      testing_example_2       0.433s</span><br></pre></td></tr></table></figure><p>BenchmarkAdder é€™éš»æ–¹æ³•åŸ·è¡Œäº†1000000000æ¬¡, æ¯æ¬¡èŠ±äº† 0.374 ns</p><p>æˆ–æ˜¯ä¹Ÿå¯ä»¥ä¸æŒ‡å®šæ–¹æ³•Benchmarkåç¨± <code>go test -bench . testing_example_2</code></p><h4 id="æŒ‡å®šè¦èŠ±å¤šå°‘æ™‚é–“åšbenchmarkæ¸¬è©¦ï¼š-go-test-benchtime"><a href="#æŒ‡å®šè¦èŠ±å¤šå°‘æ™‚é–“åšbenchmarkæ¸¬è©¦ï¼š-go-test-benchtime" class="headerlink" title="æŒ‡å®šè¦èŠ±å¤šå°‘æ™‚é–“åšbenchmarkæ¸¬è©¦ï¼š go test -benchtime"></a>æŒ‡å®šè¦èŠ±å¤šå°‘æ™‚é–“åšbenchmarkæ¸¬è©¦ï¼š <code>go test -benchtime</code></h4><p>å¯æŒ‡å®šå£“æ¸¬æ¸¬å¤šå°‘æ™‚é–“ï¼Œå¯ä»¥æ“´å±•å£“æ¸¬çš„æ¬¡æ•¸</p><p>èˆ‰ä¾‹ï¼Œåªå£“æ¸¬0.001ç§’ï¼Œé‚£å¯çœ‹åˆ°åªæœƒæ¸¬å‡º 2864049æ¬¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -benchtime 0.001s -bench . testing_example_2</span><br><span class="line">goos: darwin</span><br><span class="line">goarch: amd64</span><br><span class="line">pkg: testing_example_2</span><br><span class="line">BenchmarkAdder-4         2864049                 0.485 ns/op</span><br><span class="line">PASS</span><br><span class="line">ok      testing_example_2       0.024s</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### æª¢è¦–å£“åŠ›æ¸¬è©¦èŠ±å¤šå°‘è¨˜æ†¶é«”ï¼š `go test -bench . -benchmem`</span><br><span class="line"></span><br><span class="line">é€é `-bemchmem`é€™å€‹flagï¼Œå£“æ¸¬è³‡è¨Šæœƒå¤šäº† `B/op` èˆ‡ `allocs/op` ä¾†æª¢è¦–è©²æ–¹æ³•å£“æ¸¬æ™‚èŠ±äº†å¤šå°‘è¨˜æ†¶é«”è³‡æº</span><br></pre></td></tr></table></figure><p>~/go/src via v1.15<br>âœ go test -bench . -benchmem testing_example_2<br>goos: darwin<br>goarch: amd64<br>pkg: testing_example_2<br>BenchmarkAdder-4        1000000000               0.501 ns/op           0 B/op          0 allocs/op<br>PASS<br>ok      testing_example_2       0.586s<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">### ä½¿ç”¨go tool pprof  (performance profiling tool) ç”¢ç”Ÿæ¸¬è©¦å ±å‘Š</span><br><span class="line"></span><br><span class="line">ç”¢å‡ºå ±å‘Šä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£ `graphviz`é€™å€‹å¥—ä»¶ï¼Œé€™æ¨£go toolæ‰èƒ½å¤ ç¹ªè£½æµç¨‹åœ–ä¾›æˆ‘å€‘æŸ¥çœ‹</span><br><span class="line"></span><br><span class="line">Linux/Macos</span><br></pre></td></tr></table></figure></p><p>sudo apt-get install graphyiz<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; æ›´å¤šæœ‰é—œgraphyizè³‡è¨Šè«‹åˆ°ï¼š http://graphviz.org</span><br><span class="line">&gt; </span><br><span class="line"></span><br><span class="line">#### ç”¢ç”Ÿç¨‹å¼è¨˜æ†¶é«”èŠ±è²»å ±å‘Š `go test -memprofile`</span><br><span class="line"></span><br><span class="line">ä¸€æ¨£ç”¨testing_example_2é€™å€‹å°ˆæ¡ˆä¸‹çš„æª”æ¡ˆåšæ¸¬è©¦</span><br><span class="line"></span><br><span class="line">![](pics/14.png)</span><br><span class="line">![](https://i.imgur.com/FPmr2HU.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">`mylib.go`</span><br><span class="line">```go=</span><br><span class="line">package mylib</span><br><span class="line"></span><br><span class="line">func adder(l, r int) int &#123;</span><br><span class="line">return l + r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>mylib_test.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> mylib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdder</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> adder(<span class="number">2</span>, <span class="number">5</span>) != <span class="number">7</span> &#123;</span><br><span class="line">t.Fail()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BenchmarkAdder</span><span class="params">(b *testing.B)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; b.N; i++ &#123;</span><br><span class="line">adder(<span class="number">5</span>, <span class="number">7</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€é <code>go test -memprofile mem.out testing_example_2</code> ä¾†ç”¢å‡ºå«åš <code>mem.out</code>çš„æ¸¬è©¦å ±å‘Š</p><p>æ¸¬è©¦çµæœ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -memprofile mem.out testing_example_2</span><br><span class="line">ok      testing_example_2       0.018s</span><br></pre></td></tr></table></figure></p><p>ä»¥åŠæœƒç”¢ç”Ÿå…©å€‹æª”æ¡ˆ <code>mem.out</code> èˆ‡ <code>testing_example_2.test</code>ï¼Œå¾Œè€…ä¸»è¦æä¾›çµ¦ go tool pprofæª¢è¦–</p><p><img src="pics/15.png" alt=""><br><img src="https://i.imgur.com/KsJqL24.png" alt=""></p><p>æ¥è‘—é€é <code>go tool pprof</code>æª¢è¦–å…¶å ±å‘Š <code>testing_example_2.test</code>ï¼Œä¸¦æŒ‡å®šç”¨<code>-web</code> ç¶²é çš„æ–¹å¼ç€è¦½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo go tool pprof -web testing_example_2.test mem.out</span><br></pre></td></tr></table></figure><p>ä¸éç”±æ–¼ç¯„ä¾‹æª”æ¡ˆè¦æ¨¡å¤ªå°ï¼Œgo toolç„¡æ³•æ•æ‰åˆ°æœ‰ç”¨çš„è³‡è¨Šï¼Œæ‰€ä»¥æŠ“ä¸åˆ°</p><p><img src="pics/16.png" alt=""></p><p>é€™æ™‚å¯ä»¥é€é <code>go test -mmprofilerate n</code>ä¾†æ”¹è®Šè®€å–å ±å‘Šçš„é »ç‡ï¼Œç•¶åŸ·è¡Œnå€‹æŒ‡ä»¤æ™‚ï¼Œå°±ç”¢å‡ºå ±å‘Š</p><p>æ¥è‘—å†æŸ¥çœ‹ä¸€æ¬¡ç”¢å‡ºçš„å ±å‘Š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo go tool pprof -web testing_example_2.test mem.out</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æ¯å€‹æ–¹æ³•è©³ç´°çš„è¨˜æ†¶é«”æ¶ˆè€—è³‡è¨Šåœ–</p><p><img src="pics/17.png" alt=""></p><h4 id="ç”¢ç”ŸCPUæ¶ˆè²»å ±å‘Š-go-test-cpuprofile"><a href="#ç”¢ç”ŸCPUæ¶ˆè²»å ±å‘Š-go-test-cpuprofile" class="headerlink" title="ç”¢ç”ŸCPUæ¶ˆè²»å ±å‘Š go test -cpuprofile"></a>ç”¢ç”ŸCPUæ¶ˆè²»å ±å‘Š <code>go test -cpuprofile</code></h4><p>ä¸€æ¨£å¯ä»¥ç”¢ç”Ÿæ¯å€‹æ–¹æ³•æˆ–packageä½¿ç”¨å¤šå°‘çš„CPUé—œè¯åœ–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/go/src via v1.15 </span><br><span class="line">âœ go test -cpuprofile cpu.out testing_example_2 </span><br><span class="line">ok      testing_example_2       0.224s</span><br></pre></td></tr></table></figure></p><p>ç”¢ç”Ÿå‡º<code>cpu.out</code>èˆ‡<code>testing_example_2.test</code>ï¼Œç„¶å¾Œå¾Œè€…ä¹Ÿæ˜¯é€é <code>pprof</code>æª¢è¦–</p><p><img src="pics/18.png" alt=""></p><p>ä¸éä¹Ÿæ˜¯ä¸€æ¨£æ²’çœ‹åˆ°è±å¯Œçš„æ¸¬è©¦è³‡è¨Šï¼Œå› ç‚ºæ•´å€‹æ¸¬è©¦åªæœ‰åŸ·è¡Œä¸€éï¼Œå°è‡´pprofç„¡æ³•æŠ“åˆ°æœ‰ç”¨çš„è³‡è¨Š</p><p><img src="pics/19.png" alt=""></p><p>é€™æ™‚å¯ä»¥é€é <code>-count</code> å¯ä»¥æ¸¬è©¦å¤šæ¬¡ä»¥å–å¾—è¶³å¤ çš„CPUä½¿ç”¨é‡å ±å‘Š</p><p><code>go test -cpuprofile cpu.out -count 1000000 testing_example_2</code></p><p>åœ¨æŸ¥çœ‹ä¸€éå°±æœƒæœ‰æ–¹æ³•å‘¼å«çš„CPUæ¶ˆè€—æµç¨‹åœ–å¯ä»¥æª¢è¦–äº†</p><p><img src="pics/20.png" alt=""></p><h4 id="ç”¢ç”Ÿç¨‹å¼è¶³è·¡å ±å‘Š-go-test-trace"><a href="#ç”¢ç”Ÿç¨‹å¼è¶³è·¡å ±å‘Š-go-test-trace" class="headerlink" title="ç”¢ç”Ÿç¨‹å¼è¶³è·¡å ±å‘Š go test -trace"></a>ç”¢ç”Ÿç¨‹å¼è¶³è·¡å ±å‘Š <code>go test -trace</code></h4><p>é€é<code>-trace</code>é€™å€‹flag, å¯ä»¥ç”¢å‡ºè¨±å¤šæª¢è¦–ç¨‹å¼çš„åŸ·è¡Œå ±å‘Š</p><p>ä¸€æ¨£é€é <code>go test -trace trace.out testing_example_2</code>ä¾†ç”¢ç”Ÿå«åš <code>trace.out</code>çš„å ±å‘Š</p><p>ä»¥ <code>go tool trace trace.out</code> æª¢è¦–å…§å®¹</p><p><img src="pics/21.png" alt=""></p><p>é»é–‹View traceå¯çœ‹åˆ°å¦‚ä¸‹</p><p><img src="pics/22.png" alt=""></p><h2 id="åƒè€ƒè³‡æº"><a href="#åƒè€ƒè³‡æº" class="headerlink" title="åƒè€ƒè³‡æº"></a>åƒè€ƒè³‡æº</h2><ul><li><p><a href="https://golang.org/cmd/trace/" target="_blank" rel="noopener">Go-Command trace</a></p></li><li><p><a href="https://medium.com/@cep21/using-go-1-10-new-trace-features-to-debug-an-integration-test-1dc39e4e812d" target="_blank" rel="noopener">Using Go 1.10 new trace features to debug an integration test</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»¥ä¸‹ç‚ºå­¸ç¿’æœ¬èª²ç¨‹ &lt;a href=&quot;https://app.pluralsight.com/library/courses/go-cli-playbook/table-of-contents&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pluralshi
      
    
    </summary>
    
    
      <category term="Golang" scheme="http://a10000005588.github.io/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨Golangæ’°å¯«Packageçš„Best Practice</title>
    <link href="http://a10000005588.github.io/2021/02/15/go-package-best-practice/"/>
    <id>http://a10000005588.github.io/2021/02/15/go-package-best-practice/</id>
    <published>2021-02-15T08:33:51.000Z</published>
    <updated>2021-02-15T08:51:31.740Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹æ”¶éŒ„æ’°å¯«golang packageå¯ä»¥éµå¾ªçš„å…§å®¹</p><h2 id="Package-æ¦‚è¦½"><a href="#Package-æ¦‚è¦½" class="headerlink" title="Package æ¦‚è¦½"></a>Package æ¦‚è¦½</h2><p>ä¸€å€‹Go Pakcageçš„åŸºæœ¬å…ƒç´ åŒ…å«äº†å¦‚ä¸‹ï¼š</p><ul><li>Package declaration: åŸºæœ¬å®šç¾©ï¼Œå‘Šè¨´developer packageçš„åŠŸèƒ½æ˜¯ä»€éº¼</li><li>Documentation: æä¾›Packageå…§æ‰€åŒ…å«çš„functionæ˜¯ä»€éº¼ï¼Œè¦å¦‚ä½•ä½¿ç”¨</li><li>Imports: å¦‚ä½•å¼•å…¥pakcageå…§çš„function</li><li>var &amp; const blocks: ä½¿ç”¨çš„è®Šæ•¸å®£å‘Š</li><li>Types &amp; interfaces: å®šç¾©packageå…§æœƒä½¿ç”¨çš„å‹æ…‹ä»¥åŠä»‹é¢</li><li>Functions: functionsçš„å¯¦ä½œ<h3 id="Packageçš„ç¯„åœï¼šä¸€å€‹è³‡æ–™å¤¾å…§çš„æ‰€æœ‰-goæª”æ¡ˆï¼Œå…¶ä»–é™¤å¤–"><a href="#Packageçš„ç¯„åœï¼šä¸€å€‹è³‡æ–™å¤¾å…§çš„æ‰€æœ‰-goæª”æ¡ˆï¼Œå…¶ä»–é™¤å¤–" class="headerlink" title="Packageçš„ç¯„åœï¼šä¸€å€‹è³‡æ–™å¤¾å…§çš„æ‰€æœ‰.goæª”æ¡ˆï¼Œå…¶ä»–é™¤å¤–"></a>Packageçš„ç¯„åœï¼šä¸€å€‹è³‡æ–™å¤¾å…§çš„æ‰€æœ‰<code>.go</code>æª”æ¡ˆï¼Œå…¶ä»–é™¤å¤–</h3>åŸºæœ¬ä¸Šä¸€å€‹Go PackageåªæœƒåŒ…å«å–®ä¸€ç›®éŒ„å…§æ‰€æœ‰çš„Go Source.</li></ul><p>èˆ‰å€‹ä¾‹å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---services</span><br><span class="line"> |--- events (Package)</span><br><span class="line">   |-- data (è³‡æ–™å¤¾)</span><br><span class="line">   |-- handlers.go</span><br><span class="line">   |-- serve.go</span><br></pre></td></tr></table></figure><p>ä¸Šé¢<code>events</code>é€™å€‹packageï¼ŒåªæœƒåŒ…å« <code>handlers.go</code> ä»¥åŠ <code>serve.go</code> é€™å…©éš»æª”æ¡ˆçš„å…§å®¹ï¼Œ<code>data</code>è³‡æ–™å¤¾æœƒè¢«æ’é™¤</p><h2 id="Packageç¨®é¡"><a href="#Packageç¨®é¡" class="headerlink" title="Packageç¨®é¡"></a>Packageç¨®é¡</h2><h3 id="Library-Packages"><a href="#Library-Packages" class="headerlink" title="Library Packages"></a>Library Packages</h3><p>å®šç¾©Golang Packageçš„å…§å®¹ï¼Œæä¾›ç›¸åŒåŠŸèƒ½æ€§çš„functionã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .../services</span></span><br><span class="line"><span class="keyword">package</span> services</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><ul><li>Library Pakcageé€šå¸¸è¢«å…¶ä»–çš„packageæ‰€å¼•å…¥é€²ä¾†</li><li>Library Packageçš„åç¨±å¿…é ˆè¦è·Ÿè‡ªå·±çš„è³‡æ–™å¤¾åç¨±ä¸€æ¨£</li><li>pakcageå…§çš„æœ€å¥½æ˜¯æä¾›ç›¸ä¼¼çš„åŠŸèƒ½<h3 id="Main-Package"><a href="#Main-Package" class="headerlink" title="Main Package"></a>Main Package</h3></li></ul><p>å®šç¾©äº†Applicationçš„é€²å…¥é»ï¼Œç¨‹å¼è¦å•Ÿå‹•å°±æœƒæ˜¯å¾main packageé–‹å§‹ï¼Œæ³¨é‡åœ¨appçš„è¨­ç½®ä»¥åŠåˆå§‹åŒ–çš„é‚è¼¯ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure><ul><li>åŒ…å« main() function</li><li>å¯ä»¥åœ¨ä»»ä½•çš„è³‡æ–™å¤¾</li></ul><h3 id="ç¯„ä¾‹"><a href="#ç¯„ä¾‹" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><p><code>http</code> package: <a href="https://golang.org/pkg/net/http/" target="_blank" rel="noopener">https://golang.org/pkg/net/http/</a></p><ul><li>Constants: å®šç¾©å¸¸æ•¸å…§å®¹</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    StatusContinue           = <span class="number">100</span> <span class="comment">// RFC 7231, 6.2.1</span></span><br><span class="line">    StatusSwitchingProtocols = <span class="number">101</span> <span class="comment">// RFC 7231, 6.2.2</span></span><br><span class="line">    StatusProcessing         = <span class="number">102</span> <span class="comment">// RFC 2518, 10.1</span></span><br><span class="line">    StatusEarlyHints         = <span class="number">103</span> <span class="comment">// RFC 8297</span></span><br><span class="line"></span><br><span class="line">    StatusOK                   = <span class="number">200</span> <span class="comment">// RFC 7231, 6.3.1</span></span><br><span class="line">    StatusCreated              = <span class="number">201</span> <span class="comment">// RFC 7231, 6.3.2</span></span><br><span class="line">    StatusAccepted             = <span class="number">202</span> <span class="comment">// RFC 7231, 6.3.3</span></span><br><span class="line">    StatusNonAuthoritativeInfo = <span class="number">203</span> <span class="comment">// RFC 7231, 6.3.4</span></span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li><p>Variables: å®šç¾©è®Šæ•¸å…§å®¹ï¼Œä¸”çµ¦äºˆèªªæ˜</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    <span class="comment">// ErrNotSupported is returned by the Push method of Pusher</span></span><br><span class="line">    <span class="comment">// implementations to indicate that HTTP/2 Push support is not</span></span><br><span class="line">    <span class="comment">// available.</span></span><br><span class="line">    ErrNotSupported = &amp;ProtocolError&#123;<span class="string">"feature not supported"</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Deprecated: ErrUnexpectedTrailer is no longer returned by</span></span><br><span class="line">    <span class="comment">// anything in the net/http package. Callers should not</span></span><br><span class="line">    <span class="comment">// compare errors against this variable.</span></span><br><span class="line">    ErrUnexpectedTrailer = &amp;ProtocolError&#123;<span class="string">"trailer header without chunked transfer encoding"</span>&#125;</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>Types: å®šç¾©å®¢è£½åŒ–å‹æ…‹ï¼Œä¸¦çµ¦äºˆèªªæ˜</p></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A Client is an HTTP client. Its zero value (DefaultClient) is a usable client that uses DefaultTransport. ...</span></span><br><span class="line"><span class="keyword">type</span> Client <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// Transport specifies the mechanism by which individual</span></span><br><span class="line">    <span class="comment">// HTTP requests are made.</span></span><br><span class="line">    <span class="comment">// If nil, DefaultTransport is used.</span></span><br><span class="line">    Transport RoundTripper</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>ä¹Ÿæä¾›äº†Clinetå½¢æ…‹çš„åˆå§‹åŒ–è®Šæ•¸è¨­ç½®ï¼Œä¸ç”¨ä¸€ç›´è‡ªè¡Œåˆå§‹åŒ–<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DefaultClient is the default Client and is used by Get, Head, and Post.</span></span><br><span class="line"><span class="keyword">var</span> DefaultClient = &amp;Client&#123;&#125;</span><br></pre></td></tr></table></figure></p><ul><li>Function: å®šç¾©functionå…§å®¹ï¼Œä¸¦æ·»åŠ èªªæ˜</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CanonicalHeaderKey returns the canonical format of the header key s. The canonicalization converts the first letter and any letter following a hyphen to upper case; the rest are converted to lowercase. For example, the canonical key for "accept-encoding" is "Accept-Encoding". If s contains a space or invalid header field bytes, it is returned without modifications.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CanonicalHeaderKey</span></span> &#123;...&#125;</span><br></pre></td></tr></table></figure><h2 id="Pakcage-çš„ç”Ÿå‘½é€±æœŸ"><a href="#Pakcage-çš„ç”Ÿå‘½é€±æœŸ" class="headerlink" title="Pakcage çš„ç”Ÿå‘½é€±æœŸ"></a>Pakcage çš„ç”Ÿå‘½é€±æœŸ</h2><ol><li>Import æ‰€éœ€è¦çš„package</li><li>å°‡initial valueè¨­ç½®åœ¨variables</li><li>å‘¼å« <code>init()</code> æ–¹æ³•ï¼ŒåŸ·è¡Œåˆå§‹åŒ–è©²packageçš„å‹•ä½œ</li></ol><blockquote><p>æ³¨æ„ï¼Œç„¡æ³•ç›´æ¥å‘¼å« <code>init()</code> ï¼Œè©²æ–¹æ³•åªèƒ½åœ¨golangçš„compileræ™‚æœŸè¢«golangå‘¼å«åŸ·è¡Œã€‚</p></blockquote><h3 id="ç¯„ä¾‹-1"><a href="#ç¯„ä¾‹-1" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><p>å‡å¦‚æœ‰å€‹ç›®éŒ„å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--- cmd</span><br><span class="line"> |--- startAll</span><br><span class="line"> |   |- main.go</span><br><span class="line"> |--- services</span><br><span class="line">     |- handlers.go</span><br><span class="line">     |- serve.go</span><br><span class="line"> |--- internal</span><br><span class="line">     |--- ports</span><br><span class="line">        |--- ports.go</span><br></pre></td></tr></table></figure></p><p>è‹¥ <code>main.go</code> import <code>services</code> é€™å€‹package</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Package events provides a webservice that manages the libary's special events.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">package</span> events</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line"><span class="string">"strconv"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/pluralsight/libmanager/services/internal/ports"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> port = <span class="number">42</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// StartServer registers the handlers and initiates the web service.</span></span><br><span class="line"><span class="comment">// The service is started on the local machine with the port specified by</span></span><br><span class="line"><span class="comment">// .../lm/services/internal/ports#EventService</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StartServer</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">sm := http.NewServeMux()</span><br><span class="line">sm.Handle(<span class="string">"/"</span>, <span class="built_in">new</span>(eventHandler))</span><br><span class="line"><span class="keyword">return</span> http.ListenAndServe(<span class="string">":"</span>+strconv.Itoa(port), sm)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"serve.go 1"</span>, port)</span><br><span class="line">port = ports.EventService</span><br><span class="line">fmt.Println(<span class="string">"serve.go 2"</span>, port)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"second init in serve.go"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥çœ‹åˆ°init() å¯ä»¥å¤šæ¬¡å®£å‘Š</p></blockquote><p>æ­¤æ™‚<code>main.go</code>å‘¼å«<code>services</code> pakcageå…§çš„<code>startServer</code> function</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package main is typically used to define a single, executable command and its associated logic.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Functions in the main package should normally avoid containing business logic; they</span></span><br><span class="line"><span class="comment">// should focus on initializing the application and handling any errors that are returned by</span></span><br><span class="line"><span class="comment">// any library calls.</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/pluralsight/libmanager/services/events"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"init in main.go"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The main function, when defined in a main package, defines</span></span><br><span class="line"><span class="comment">// the entry and exit point for an executable command.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">log.Println(<span class="string">"Starting all services"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// start the services</span></span><br><span class="line">wg := <span class="built_in">new</span>(sync.WaitGroup)</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// åŸ·è¡Œ events packageå…§çš„StartServeræ–¹æ³•</span></span><br><span class="line"><span class="keyword">go</span> startServer(wg, events.StartServer)</span><br><span class="line">wg.Wait()</span><br><span class="line">log.Println(<span class="string">"All services stopped"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// startServer is a function in the main package that supports the command.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">startServer</span><span class="params">(wg *sync.WaitGroup, startFunc <span class="keyword">func</span>()</span> <span class="title">error</span>)</span> &#123;</span><br><span class="line">err := startFunc()</span><br><span class="line">wg.Done()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ³¨æ„ï¼Œservices importäº†internalå…§<code>ports</code> packageçš„è®Šæ•¸ï¼Œæ•…è‹¥å‘¼å«äº†<code>main.go</code> ä¸­çš„startServerï¼Œæœƒå…ˆå°å‡ºåˆå§‹åŒ–çš„<code>port = 42</code>, å†ä¾†æ˜¯é€é<code>init()</code>æ¥æ”¶åˆ°ports packageçš„ <code>port = 3000</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func init() &#123;</span><br><span class="line">fmt.Println(&quot;serve.go 1&quot;, port)</span><br><span class="line">port = ports.EventService</span><br><span class="line">fmt.Println(&quot;serve.go 2&quot;, port)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°å‡ºå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">serve.go 1 42</span><br><span class="line">serve.go 2 3000</span><br><span class="line">second init in serve.go</span><br></pre></td></tr></table></figure></p><h2 id="Pakcage-å­˜å–ç¯„ç–‡"><a href="#Pakcage-å­˜å–ç¯„ç–‡" class="headerlink" title="Pakcage å­˜å–ç¯„ç–‡"></a>Pakcage å­˜å–ç¯„ç–‡</h2><ul><li>Public Scope<ul><li>ä»¥å¤§å¯«å®£å‘Š</li><li>å¯è¢«å°ˆæ¡ˆå…§æ‰€æœ‰æˆå“¡å­˜å–</li></ul></li><li>Package Scope<ul><li>ä»¥å°å¯«å®£å‘Š</li><li>åªèƒ½è¢«åŒä¸€å€‹packageå…§å­˜å–</li></ul></li><li>Internal Package<ul><li>å¯åŒæ™‚ä½¿ç”¨public-level, package-level çš„æˆå“¡</li><li>åªé™æ–¼çˆ¶å±¤èˆ‡å­å±¤çš„æˆå“¡å­˜å–</li></ul></li></ul><h2 id="Pakcageè¨­è¨ˆçš„Best-Practice"><a href="#Pakcageè¨­è¨ˆçš„Best-Practice" class="headerlink" title="Pakcageè¨­è¨ˆçš„Best Practice"></a>Pakcageè¨­è¨ˆçš„Best Practice</h2><h3 id="Pakcage-åç¨±"><a href="#Pakcage-åç¨±" class="headerlink" title="Pakcage åç¨±"></a>Pakcage åç¨±</h3><ul><li>å„˜é‡ç°¡çŸ­ï¼Œä½¿ç”¨åè©</li><li>å°å¯«é–‹é ­ï¼Œä¸ä½¿ç”¨ <code>_</code>, <code></code>ç­‰ç‰¹æ®Šå­—å…ƒ</li><li>åˆ¥ä½¿ç”¨ä¸€èˆ¬ä½¿ç”¨è€…æœƒç”¨åˆ°çš„è®Šæ•¸åç¨± <code>event</code>, <code>temp</code> ç­‰åè©ä¾†å‘½å.</li></ul><h3 id="Package-èªªæ˜"><a href="#Package-èªªæ˜" class="headerlink" title="Package èªªæ˜"></a>Package èªªæ˜</h3><p>ä¸€å€‹å…¬é–‹çš„pakcageé€šå¸¸æœƒåŒ…å«å…©å€‹ä¸»è¦èªªæ˜å…§å®¹</p><ul><li>licensing: ä½¿ç”¨çš„é–‹æ”¾å”è­°</li><li>package comment: packageçš„åŠŸèƒ½èªªæ˜</li><li>èªªæ˜é–‹é ­æ‡‰åŒ…å« packageåç¨±ï¼Œæ–¹æ³•çš„è©±é–‹é ­æœƒfunctionçš„åç¨±</li></ul><p><code>helloworld/doc.go</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright 2009 The Go Authors. All rights reserved.</span></span><br><span class="line"><span class="comment">// Use of this source code is governed by sa BSD-style</span></span><br><span class="line"><span class="comment">// license that can be found in the LICENSE file</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Package helloworld implements ....</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> helloworld</span><br></pre></td></tr></table></figure></p><p>é€™æ™‚ä½¿ç”¨ <code>go doc helloworld</code>ï¼Œå°±æœƒé¡¯ç¤º <code>helloworld</code> packageå…§<code>doc.go</code>çš„èªªæ˜</p><h4 id="ä½¿ç”¨-doc-go-åšæ›´è¤‡é›œçš„èªªæ˜"><a href="#ä½¿ç”¨-doc-go-åšæ›´è¤‡é›œçš„èªªæ˜" class="headerlink" title="ä½¿ç”¨ doc.go åšæ›´è¤‡é›œçš„èªªæ˜"></a>ä½¿ç”¨ <code>doc.go</code> åšæ›´è¤‡é›œçš„èªªæ˜</h4><p>è‹¥æœ‰å¤ªå¤šçš„packageæ•˜è¿°è¦å‘ˆç¾ï¼Œé€šå¸¸æœƒåœ¨<code>doc.go</code> èªªæ˜</p><p><img src="./pics/pic01.png" alt="pic01"></p><h3 id="Pakcageå…§å®¹çš„æè¿°æ’°å¯«æŒ‡å¼•"><a href="#Pakcageå…§å®¹çš„æè¿°æ’°å¯«æŒ‡å¼•" class="headerlink" title="Pakcageå…§å®¹çš„æè¿°æ’°å¯«æŒ‡å¼•"></a>Pakcageå…§å®¹çš„æè¿°æ’°å¯«æŒ‡å¼•</h3><ul><li>é¿å…å†—ä½™</li></ul><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„packageåç¨±èˆ‡functionåç¨±éƒ½é‡è¤‡äº†ï¼Œæ‰€ä»¥å¯ä»¥å°‡functionåç¨±èˆ‡packageé‡è¤‡çš„éƒ¨åˆ†çµ¦å»æ‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.HTTPServer -&gt; http.server</span><br><span class="line">json.JSONEncoder -&gt; json.encoder</span><br></pre></td></tr></table></figure></p><ul><li>ç›¡é‡ç°¡åŒ–</li></ul><p>ä¾‹å¦‚ï¼Œä¸‹é¢å¯ä»¥ç°¡åŒ–æˆå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">time.NewTime -&gt; time.Time</span><br><span class="line">db.ConnectToDatabase -&gt; db.Connect</span><br></pre></td></tr></table></figure></p><h3 id="Packageå…§å®¹æº–å‰‡"><a href="#Packageå…§å®¹æº–å‰‡" class="headerlink" title="Packageå…§å®¹æº–å‰‡"></a>Packageå…§å®¹æº–å‰‡</h3><ul><li>æä¾›ç›´è¦ºçš„åŠŸèƒ½<ul><li>single reponsibility: å–®ä¸€åŠŸèƒ½</li><li>cohesive API: åŠŸèƒ½ç›¸ä¾çš„Application Programming Interface</li></ul></li><li>æä¾›å‹å–„çš„ä½¿ç”¨æ–¹æ³•<ul><li>simple to use</li><li>minimize API: å°‡åŠŸèƒ½é‡é»åŒ–</li><li>encapsulate changes: å°‡è®Šå‹•å°è£èµ·ä¾†ï¼Œä¸å½±éŸ¿åŸæœ¬ä½¿ç”¨è€…çš„input, outputçš„ä½¿ç”¨æ–¹å¼</li></ul></li><li>æœ€å¤§åŒ–å¯é‡è¤‡åˆ©ç”¨æ€§<ul><li>reduce dependencies: æ¸›å°‘ä¾è³´å…¶ä»–dependenciesçš„ç‹€æ³</li><li>minimize scope: ç¸®å°ç¯„ç–‡ï¼Œé¿å…åˆ°è™•éƒ½æ˜¯publicï¼Œé€ æˆpackageå…§éƒ¨çš„è®Šæ•¸è¢«å…¶ä»–åœ°æ–¹æ‰€å½±éŸ¿ã€‚</li></ul></li></ul><h3 id="çµæ§‹è¨­è¨ˆ"><a href="#çµæ§‹è¨­è¨ˆ" class="headerlink" title="çµæ§‹è¨­è¨ˆ"></a>çµæ§‹è¨­è¨ˆ</h3><table><thead><tr><th>Package Input</th><th>Package Output</th></tr></thead><tbody><tr><td>å°æ–¼configurationä½¿ç”¨ concrete types</td><td>å°æ–¼configuration &amp; behavior éƒ½ä½¿ç”¨concrete types</td></tr><tr><td>å°æ–¼behavior ä½¿ç”¨ interface</td><td>å°æ–¼errors è«‹é¿å…ä¸ç™¼ç”Ÿ panics: å› ç‚ºéŒ¯èª¤å³ä½¿ç™¼ç”Ÿäº†ï¼Œä½¿ç”¨è€…ä¹Ÿç„¡æ³•å°å…¶åšè™•ç†</td></tr></tbody></table><p>é€é <code>http</code> packageä¾†çœ‹çœ‹å…¶çµæ§‹è¨­è¨ˆ</p><table><thead><tr><th>Package Input</th><th>Package Output</th></tr></thead><tbody><tr><td><code>net/http.Request</code> å°æ–¼http.Reqeustæ‰€è¦ä½¿ç”¨çš„configurationï¼Œä¾‹å¦‚http bodyè¦ç”¨çš„åƒæ•¸æ ¼å¼æ˜¯ä»€éº¼ï¼Œä½¿ç”¨ concrete typesï¼Œæ˜ç¢ºè¦ç¯„ä½¿ç”¨è€…è¦æ”¾ç½®ä»€éº¼çµ¦package</td><td><code>net/http.Response</code> å°æ–¼å…¶å›å‚³çµæœï¼Œå°‡configuration &amp; behavior éƒ½ä½¿ç”¨concrete typeså®šç¾©å¥½ï¼Œé¿å…ä½¿ç”¨è€…æ··æ·†</td></tr><tr><td><code>net/http.Handler</code> å°æ–¼http.Handler, é€™å€‹è™•ç†httpçš„behavior ä½¿ç”¨ interfaceï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¯ä»¥é‡å°ä»–å€‘è‡ªå·±çš„http Requesté€²ä¾†çš„è¡Œç‚ºå®šç¾©è‡ªå·±çš„å‹æ…‹</td><td><code>net/http.Get</code> æ­£å¸¸ç‹€æ³ä¸‹ (ç”¨æˆ¶æ­£ç¢ºä½¿ç”¨ä¸‹)ï¼Œç”¨æˆ¶ä½¿ç”¨å…¶æ–¹æ³•æ˜¯ä¸æœƒç™¼ç”Ÿpanicçš„</td></tr></tbody></table><h2 id="Import-Packageæ–¹æ³•"><a href="#Import-Packageæ–¹æ³•" class="headerlink" title="Import Packageæ–¹æ³•"></a>Import Packageæ–¹æ³•</h2><h3 id="1-Typical-Imports"><a href="#1-Typical-Imports" class="headerlink" title="1. Typical Imports"></a>1. Typical Imports</h3><p>ä½¿ç”¨<code>fmt</code> pakcageçš„ <code>Println</code> function<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">"hello, gophers!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="2-Alternative-Imports"><a href="#2-Alternative-Imports" class="headerlink" title="2. Alternative Imports"></a>2. Alternative Imports</h3><ul><li>Aliases å°‡pakcege åˆ¥å</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€™æ™‚æœƒå¼•å…¥äº†å…©å€‹å«åšjsonçš„pakcage, compileræœƒå‡ºç¾æ··æ·†</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"encoding/json"</span></span><br><span class="line">   <span class="string">"pluralsight.com/libmanager/json"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  data, err := json.Marshal(...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯é€é alias ï¼Œå°‡å…¶ä¸­ä¸€å€‹packageåç¨±é€²è¡Œåˆ¥å</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"encode/json"</span></span><br><span class="line">  lmjson <span class="string">"pluralsight.com/libmanager/json"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="3-Import-for-side-effect-ç‚ºå¼•å…¥çš„packageï¼Œåœ¨å¼•å…¥å…¶ä»–çš„packageä½¿å…¶ä½œç”¨"><a href="#3-Import-for-side-effect-ç‚ºå¼•å…¥çš„packageï¼Œåœ¨å¼•å…¥å…¶ä»–çš„packageä½¿å…¶ä½œç”¨" class="headerlink" title="3. Import for side effect: ç‚ºå¼•å…¥çš„packageï¼Œåœ¨å¼•å…¥å…¶ä»–çš„packageä½¿å…¶ä½œç”¨"></a>3. Import for side effect: ç‚ºå¼•å…¥çš„packageï¼Œåœ¨å¼•å…¥å…¶ä»–çš„packageä½¿å…¶ä½œç”¨</h3><p>é€™æœ‰é»é›£ç†è§£ï¼Œç›´æ¥çœ‹ç¯„ä¾‹</p><p>ä¾‹å¦‚ä»¥ä¸‹æœ‰å¼•å…¥å…©å€‹packages, ä¸€å€‹æ˜¯<code>sql</code> package, å¦å¤–ä¸€å€‹æ˜¯ <code>pq</code> postgresé€™å€‹è³‡æ–™åº«çš„package.</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"database/sql"</span></span><br><span class="line">  _ <span class="string">"github.com/lib/pq"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>pq</code> æ˜¯ç”¨ <code>_</code> ä»£è¡¨ä»–æ˜¯ä¸€å€‹write onlyçš„package, æœ¬èº«ä½¿ç”¨è€…ä¸æœƒå»ä½¿ç”¨åˆ°å®ƒï¼Œè€Œæ˜¯æä¾›çµ¦ <code>sql</code> åšåˆå§‹åŒ–sqlå…§è¦æ¡ç”¨å“ªå€‹databaseåšä½¿ç”¨</p><p>å¯ä»¥çœ‹åˆ° <a href="https://github.com/lib/pq/blob/master/conn.go" target="_blank" rel="noopener">pg</a> packageå…§ æœ‰é€™ä¸€æ®µç¨‹å¼ç¢¼ï¼Œæä¾›<code>init()</code>çµ¦sqlåšæ³¨å…¥ä½¿ç”¨å…¶postgres dirveråšä½¿ç”¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">sql.Register(<span class="string">"postgres"</span>, &amp;Driver&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-Internal-packages"><a href="#4-Internal-packages" class="headerlink" title="4. Internal packages"></a>4. Internal packages</h3><p>ä¸»è¦æä¾›çˆ¶å±¤èˆ‡å­å±¤çš„pakcageåšå­˜å–ï¼Œç›®çš„æ˜¯è¦æä¾›è·³è„«è‡ªå·±ä¹‹å¤–çš„å­˜å–é™åˆ¶ï¼Œåˆä¸æœƒæ´©æ¼è‡ªå·±å…§éƒ¨è¨Šæ¯çµ¦å¤–éƒ¨ä½¿ç”¨è€…ã€‚</p><p>åªè¦æ˜¯å®£å‘Šç‚º <code>internal</code> çš„packageï¼Œå°±å¯ä»¥è¢«çˆ¶å±¤æˆ–å­å±¤å­˜å–</p><p>ä»¥ä¸‹ç¯„ä¾‹ç‚ºï¼Œ<code>services</code> ä¸‹æœ‰å®£å‘Š <code>internal</code> package, å¯æä¾›å…¶ä»–package <code>services/events/serve.go</code> åšå­˜å–ä½¿ç”¨</p><p><img src="pics/pic04.png" alt="pic04"></p><p>è‹¥åœ¨è¶…å‡ºinternalå®šç¾©çš„ç¯„ç–‡ (ä¸Šä¸€å€‹å±¤ç´šèˆ‡ä¸‹ä¸€å€‹å±¤ç´š)ï¼Œå‰‡æœƒcompilerç·¨è­¯æ™‚æœƒç™¼ç”ŸéŒ¯èª¤è¨Šæ¯</p><p><img src="pics/pic02.png" alt="pic02"></p><p><img src="pics/pic03.png" alt="pic03"></p><h3 id="4-Relative-Import"><a href="#4-Relative-Import" class="headerlink" title="4. Relative Import"></a>4. Relative Import</h3><p>é€é <code>../../package</code> çš„æ–¹å¼importï¼Œä¸éåœ¨Productionç’°å¢ƒä¸‹ä¸å»ºè­°ä½¿ç”¨; æˆ–è€…å¾—é€égolangæœ€æ–°çš„ <code>go mod</code> ç®¡ç†æ–¹å¼ã€‚</p><h2 id="åƒè€ƒè³‡æº"><a href="#åƒè€ƒè³‡æº" class="headerlink" title="åƒè€ƒè³‡æº"></a>åƒè€ƒè³‡æº</h2><ul><li><p><a href="https://app.pluralsight.com/library/courses/go-packages-deep-dive/description" target="_blank" rel="noopener">Pluralsight: Deep Dive into Go Packages by Mike Van Sickle </a></p></li><li><p><a href="https://github.com/lib/pq/blob/master/conn.go" target="_blank" rel="noopener">lib/pq/conn.go</a></p></li><li><p><a href="https://stackoverflow.com/questions/38517593/relative-imports-in-go" target="_blank" rel="noopener">Stackoverflow: Relative imports in Go</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»¥ä¸‹æ”¶éŒ„æ’°å¯«golang packageå¯ä»¥éµå¾ªçš„å…§å®¹&lt;/p&gt;
&lt;h2 id=&quot;Package-æ¦‚è¦½&quot;&gt;&lt;a href=&quot;#Package-æ¦‚è¦½&quot; class=&quot;headerlink&quot; title=&quot;Package æ¦‚è¦½&quot;&gt;&lt;/a&gt;Package æ¦‚è¦½&lt;/h2&gt;&lt;p&gt;ä¸€å€‹G
      
    
    </summary>
    
    
      <category term="Golang" scheme="http://a10000005588.github.io/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>Go newèˆ‡makeçš„ä»‹ç´¹èˆ‡å·®ç•° [Golang]</title>
    <link href="http://a10000005588.github.io/2020/11/08/Go-new%E8%88%87make%E7%9A%84%E4%BB%8B%E7%B4%B9%E8%88%87%E5%B7%AE%E7%95%B0/"/>
    <id>http://a10000005588.github.io/2020/11/08/Go-newèˆ‡makeçš„ä»‹ç´¹èˆ‡å·®ç•°/</id>
    <published>2020-11-08T03:19:59.000Z</published>
    <updated>2020-11-08T05:01:19.326Z</updated>
    
    <content type="html"><![CDATA[<p>Golangä¸­ï¼Œ<code>make</code>èˆ‡<code>new</code>éƒ½æ˜¯å»ºæ§‹è®Šæ•¸ä¾†ä½¿ç”¨</p><a id="more"></a><h2 id="newçš„ä»‹ç´¹"><a href="#newçš„ä»‹ç´¹" class="headerlink" title="newçš„ä»‹ç´¹"></a>newçš„ä»‹ç´¹</h2><p>new(T)æœƒå»ºæ§‹ä¸€å€‹Tå‹åˆ¥çš„ â€œæ²’æœ‰åå­—â€ çš„è®Šæ•¸ï¼Œä»¥Tçš„zeroed valueä¾†åˆå§‹åŒ–Tï¼Œä¸”new(T) å›å‚³ â€œæŒ‡å‘Tçš„æŒ‡æ¨™â€</p><ul><li>è‹¥Tæ˜¯ stringï¼Œé‚£zeroedå€¼ç‚º <code>&quot;&quot;</code></li><li>è‹¥Tæ˜¯ intï¼Œé‚£zeroedå€¼ç‚º <code>0</code></li><li>è‹¥Tæ˜¯ channel, func, map, sliceï¼Œé‚£zeroedå€¼ç‚º <code>nil</code></li></ul><h3 id="ç¯„ä¾‹"><a href="#ç¯„ä¾‹" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p := <span class="built_in">new</span>(<span class="keyword">int</span>) <span class="comment">// å®£å‘Šä¸€å€‹æŒ‡å‘intä¸å…·åè®Šæ•¸çš„`æŒ‡æ¨™p`ï¼Œ`æŒ‡æ¨™p`æŒ‡å‘ä¸€å€‹åˆå§‹åŒ–çš„zeroed valueç‚º0</span></span><br><span class="line"></span><br><span class="line">fmt.Print(*p) <span class="comment">// å°å‡º 0</span></span><br><span class="line"></span><br><span class="line">*p = <span class="number">2</span> <span class="comment">// å°‡ä¸å…·åè®Šæ•¸çš„å€¼è¨­ç½®ç‚º2</span></span><br><span class="line"></span><br><span class="line">fmt.Print(*p) <span class="comment">// å°å‡º 2</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­newç®—æ˜¯golangèªæ³•çš„ç°¡å¯«ï¼Œå…¶ä¸­<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newInt</span><span class="params">()</span> *<span class="title">int</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">new</span>(<span class="keyword">int</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å°±ç­‰æ–¼ä¸‹åˆ—å¯«æ³•<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newInt</span><span class="params">()</span> *<span class="title">int</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> dummy <span class="keyword">int</span></span><br><span class="line">  <span class="keyword">return</span> &amp;dummy   <span class="comment">// å›å‚³dummyçš„æŒ‡æ¨™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ³¨æ„-è¬¹æ…æ“ä½œnewå‡ºä¾†çš„map"><a href="#æ³¨æ„-è¬¹æ…æ“ä½œnewå‡ºä¾†çš„map" class="headerlink" title="æ³¨æ„: è¬¹æ…æ“ä½œnewå‡ºä¾†çš„map"></a>æ³¨æ„: è¬¹æ…æ“ä½œnewå‡ºä¾†çš„map</h3><p>å› ç‚ºç”¨<code>new</code>åˆå§‹åŒ–çš„mapæœƒæ˜¯ nil mapï¼Œæ•…ä»¥ä¸‹æ“ä½œæœƒå‡ºç¾panic</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  book := <span class="built_in">new</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>) </span><br><span class="line">  <span class="comment">// å®£å‘Šä¸€å€‹æŒ‡æ¨™å«åšbook, æŒ‡å‘ä¸€å€‹mapç‚ºindexæ˜¯string</span></span><br><span class="line">  <span class="comment">// æ˜ å°„åˆ°stringå‹æ…‹çš„bookåç¨±</span></span><br><span class="line"></span><br><span class="line">  b := *book  <span class="comment">// å–å¾—bookæŒ‡æ¨™æ‰€æŒ‡å‘çš„map</span></span><br><span class="line">  b[<span class="string">"ISBN-001"</span>] = <span class="string">"go programming language"</span> <span class="comment">// panic: assignment to entry in nil map</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ç¯„ä¾‹æœƒå‡ºéŒ¯çš„åŸå› æ˜¯å› ç‚ºï¼Œ bæ˜¯ä¸€å€‹nil mapï¼Œæ²’æœ‰æŒ‡å‘ä»»ä½•çš„è¨˜æ†¶é«”ä½ç½®ï¼Œæ‰€ä»¥å°ä¸€å€‹nilå€¼æ“ä½œç•¶ç„¶æœƒå†’å‡ºerror</p><p>è§£æ³•å°±å¾—é€é <code>make</code> æ–¹æ³•ç‚ºnil mapåˆ†é…ç¢ºå®šçš„å…§å­˜åœ°å€äº†</p><h3 id="new-ä¸æ˜¯-Keyword"><a href="#new-ä¸æ˜¯-Keyword" class="headerlink" title="new ä¸æ˜¯ Keyword"></a><code>new</code> ä¸æ˜¯ Keyword</h3><p>è¦æ³¨æ„ä¸€é»æ˜¯ <code>new</code> ä¸¦éæ˜¯golangçš„é—œéµå­—ï¼Œæ•…å¯ä»¥åœ¨funcå…§é‡æ–°å®£å‘Š<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">delta</span><span class="params">(old, <span class="built_in">new</span> <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">new</span> - old</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="makeçš„ä»‹ç´¹"><a href="#makeçš„ä»‹ç´¹" class="headerlink" title="makeçš„ä»‹ç´¹"></a>makeçš„ä»‹ç´¹</h2><ul><li><code>make(T, args)</code>ç”¨ä¾†ç‚º <code>slices</code>, <code>maps</code>, ä»¥åŠ <code>channel</code>åˆ†é…å…¶è¨˜æ†¶é«”ä½å€çš„ç©ºé–“èˆ‡åˆå§‹åŒ–å€¼ï¼Œä¸¦å›å‚³ä¸€å€‹å‹æ…‹<code>T</code>çš„åƒè€ƒï¼</li><li>makeä¸æœƒå›å‚³æŒ‡æ¨™ï¼</li></ul><h3 id="ç¯„ä¾‹-1"><a href="#ç¯„ä¾‹-1" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  books := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">100</span>) <span class="comment">// åˆå§‹åŒ–é•·åº¦ç‚º100çš„bookå­—ä¸²é™£åˆ—ï¼Œæ¯å€‹arrayå…§çš„å€¼éƒ½æ˜¯ ""</span></span><br><span class="line">  </span><br><span class="line">  receiver := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>) <span class="comment">// åˆå§‹åŒ–channelï¼Œä½†ä¸æœƒå›å‚³æŒ‡æ¨™</span></span><br><span class="line">  booksMapper := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ–¼<code>make</code>å›å‚³çš„æ˜¯åƒè€ƒï¼Œæ‰€ä»¥è‹¥å°‡makeå®£å‘Šçš„<code>s2</code> å‚³çµ¦func <code>modifySlice</code>å°<code>s2</code>åšä¿®æ”¹æ™‚ï¼Œä¹Ÿæœƒå½±éŸ¿<code>s2</code>çš„å…§å®¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">modifySlice</span><span class="params">(s []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    s[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s2 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%#v"</span>, s2) <span class="comment">// s2ç‚º []int&#123;0, 0, 0&#125;</span></span><br><span class="line">modifySlice(s2)</span><br><span class="line">fmt.Printf(<span class="string">"%#v"</span>, s2) <span class="comment">// s2è¢«modifySlice()æ–¹æ³•çµ¦è®Šæˆ []int&#123;1, 0, 0&#125;</span></span><br></pre></td></tr></table></figure><h2 id="newèˆ‡makeçš„å·®ç•°"><a href="#newèˆ‡makeçš„å·®ç•°" class="headerlink" title="newèˆ‡makeçš„å·®ç•°"></a>newèˆ‡makeçš„å·®ç•°</h2><ul><li>newæœƒå›å‚³æŒ‡æ¨™ï¼Œä½†æ˜¯åˆå§‹åŒ–çš„å€¼ç‚ºzeroed valueï¼Œç‰¹åˆ¥æ˜¯åœ¨å°mapåšåˆå§‹åŒ–æ™‚ï¼Œå…¶zeroed valuedç‚º <code>nil</code>ï¼Œæ„æ€å°±æ˜¯ä¸æœƒåˆ†é…å…¶è¨˜æ†¶é«”ä½ç½®</li><li>makeåªèƒ½ç”¨ä¾†å°ç‰¹åˆ¥å‹æ…‹(å¦‚map, slice, func, channle)åˆ†é…å…¶è¨˜æ†¶é«”å…§å­˜åœ°å€ï¼Œä»¥åŠç‚ºé€™äº›ç‰¹æ®Šå‹æ…‹è¨­å®šè©²åˆå§‹å€¼ (stringå°±æ˜¯â€â€, intç‚º0)</li></ul><p>æ‰€ä»¥è‹¥è¦å‚³æŒ‡æ¨™æ™‚ï¼Œå°±éœ€è¦è€ƒæ…®ç”¨<code>new</code>ï¼Œè€Œéæ˜¯<code>make</code>äº†</p><h2 id="åƒè€ƒ"><a href="#åƒè€ƒ" class="headerlink" title="åƒè€ƒ"></a>åƒè€ƒ</h2><ul><li>golang ç­†è¨˜ï¼šmake èˆ‡ new çš„å·®åˆ¥ by æ„·é–‹<ul><li><a href="https://medium.com/d-d-mag/golang-%E7%AD%86%E8%A8%98-make-%E8%88%87-new-%E7%9A%84%E5%B7%AE%E5%88%A5-68b05c7ce016" target="_blank" rel="noopener">https://medium.com/d-d-mag/golang-%E7%AD%86%E8%A8%98-make-%E8%88%87-new-%E7%9A%84%E5%B7%AE%E5%88%A5-68b05c7ce016</a></li></ul></li><li>Allocation with make<ul><li><a href="https://golang.org/doc/effective_go.html#allocation_make" target="_blank" rel="noopener">https://golang.org/doc/effective_go.html#allocation_make</a></li></ul></li><li>Allocation with new<ul><li><a href="https://golang.org/doc/effective_go.html#allocation_new" target="_blank" rel="noopener">https://golang.org/doc/effective_go.html#allocation_new</a></li></ul></li><li>The Go Programming Language, Author: Alan A. A. Donovan, Brian W. Kernighan</li><li>ä¸è¦å‘nil mapå†™å…¥(panic: assignment to entry in nil map) #7<ul><li><a href="https://github.com/kevinyan815/gocookbook/issues/7" target="_blank" rel="noopener">https://github.com/kevinyan815/gocookbook/issues/7</a></li></ul></li><li>ç†è§£ Go make å’Œ new çš„åŒºåˆ« by ä¸‰æœˆæ²™<ul><li><a href="https://sanyuesha.com/2017/07/26/go-make-and-new/" target="_blank" rel="noopener">https://sanyuesha.com/2017/07/26/go-make-and-new/</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Golangä¸­ï¼Œ&lt;code&gt;make&lt;/code&gt;èˆ‡&lt;code&gt;new&lt;/code&gt;éƒ½æ˜¯å»ºæ§‹è®Šæ•¸ä¾†ä½¿ç”¨&lt;/p&gt;
    
    </summary>
    
    
      <category term="Golang" scheme="http://a10000005588.github.io/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>Go Module å…¥é–€èˆ‡ä½¿ç”¨ä»‹ç´¹</title>
    <link href="http://a10000005588.github.io/2020/11/07/Go-Module-%E5%85%A5%E9%96%80%E8%88%87%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%B4%B9%E4%BB%8B%E7%B4%B9/"/>
    <id>http://a10000005588.github.io/2020/11/07/Go-Module-å…¥é–€èˆ‡ä½¿ç”¨ä»‹ç´¹ä»‹ç´¹/</id>
    <published>2020-11-07T14:46:02.000Z</published>
    <updated>2021-01-28T12:18:22.322Z</updated>
    
    <content type="html"><![CDATA[<p>Go Module ç‚ºç›®å‰æœ€ä¸»æµçš„ä¾è³´è§£æ±ºçš„æ–¹æ¡ˆ</p><p>ç™¼ä½ˆæ–¼ Go 11.1ç‰ˆï¼Œæ–¼Go 1.14æ¨è–¦åœ¨Productionç’°å¢ƒä¸Šä½¿ç”¨</p><a id="more"></a><p>Go Modulesçš„å‡ºç¾è§£æ±ºäº†ä»¥ä¸‹å¹¾é»çˆ­è­°ï¼š</p><ul><li>ä¾è³´å•é¡Œ</li><li>æ·˜æ±°GOPATHçš„æ©Ÿåˆ¶</li><li>çµ±ä¸€ç¤¾ç¾¤ä¸­å…¶ä»–ä¾è³´ç®¡ç†å·¥å…·</li></ul><h2 id="ç‚ºä½•-GOPATH-ä¸åœ¨è¢«æ¨è–¦ä½¿ç”¨"><a href="#ç‚ºä½•-GOPATH-ä¸åœ¨è¢«æ¨è–¦ä½¿ç”¨" class="headerlink" title="ç‚ºä½• GOPATH ä¸åœ¨è¢«æ¨è–¦ä½¿ç”¨"></a>ç‚ºä½• GOPATH ä¸åœ¨è¢«æ¨è–¦ä½¿ç”¨</h2><h3 id="ç°¡å–®ä»‹ç´¹"><a href="#ç°¡å–®ä»‹ç´¹" class="headerlink" title="ç°¡å–®ä»‹ç´¹"></a>ç°¡å–®ä»‹ç´¹</h3><p>GOPATHåŸå…ˆæ˜¯é€éå®šç¾©å¥½çš„ç›®éŒ„çµæ§‹å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">go</span><br><span class="line">|--bin</span><br><span class="line">|--pkg</span><br><span class="line">|--src</span><br><span class="line">    |--github.com</span><br><span class="line">    |--golang.org</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>å„ç›®éŒ„åˆ†åˆ¥ç‚ºï¼š</p><ul><li>bin: å„²å­˜æ‰€ç·¨è­¯ç”¢ç”Ÿçš„äºŒé€²ä½æª”æ¡ˆ</li><li>pkg: å„²å­˜é å…ˆç·¨è­¯çš„ç›®çš„æª”æ¡ˆï¼Œä»¥åŠ å¿«ç¨‹å¼çš„å¾ŒçºŒç·¨è­¯é€Ÿåº¦</li><li>src: å„²å­˜æ‰€æœ‰ .go æª”æ¡ˆæˆ–åŸå§‹ç¨‹å¼ç¢¼<ul><li>ä¸€èˆ¬æœƒä»¥ <code>$GOPATH/src/github.com/</code> å„²å­˜ Goçš„æ‡‰ç”¨ç¨‹å¼å’Œå‡½å¼åº«</li></ul></li></ul><h3 id="æ£„ç”¨åŸå› -ç„¡æ³•æ˜ç¢ºå®šç¾©èˆ‡åƒç…§ä¾è³´-Dependency-çš„ç‰ˆæœ¬"><a href="#æ£„ç”¨åŸå› -ç„¡æ³•æ˜ç¢ºå®šç¾©èˆ‡åƒç…§ä¾è³´-Dependency-çš„ç‰ˆæœ¬" class="headerlink" title="æ£„ç”¨åŸå› : ç„¡æ³•æ˜ç¢ºå®šç¾©èˆ‡åƒç…§ä¾è³´(Dependency)çš„ç‰ˆæœ¬"></a>æ£„ç”¨åŸå› : ç„¡æ³•æ˜ç¢ºå®šç¾©èˆ‡åƒç…§ä¾è³´(Dependency)çš„ç‰ˆæœ¬</h3><p>å› ç‚º<code>.go</code> å°ˆæ¡ˆéƒ½å¿…é ˆè¦å„²å­˜åœ¨ <code>$GOPATH/src</code> åº•ä¸‹ï¼Œä½†è©²ä¾è³´ç®¡ç†æ–¹å¼ä¸¦æ²’æœ‰æä¾›ç‰ˆæœ¬æ§åˆ¶çš„æ¦‚å¿µï¼Œæœƒé€ æˆä»¥ä¸‹å•é¡Œï¼š</p><ol><li>åŸ·è¡Œ<code>go get</code> å–å¾—é ç«¯çš„ä¾è³´åŒ…æ™‚ï¼Œæœƒç„¡æ³•å¾—çŸ¥ç›®å‰æ‰€è¼‰çš„ç‰ˆæœ¬</li><li>ç„¡æ³•è™•ç† v1,v2,v3ç­‰ä¸åŒç‰ˆæœ¬çš„åƒè€ƒå•é¡Œï¼Œå‡è¨­æœ‰çš„Libraryå«åš <code>/foo/bar</code> ä½†ä¸ç®¡å¹¾ç‰ˆï¼Œéƒ½æœƒåœ¨GOPATHåº•ä¸‹ï¼Œå…¶è·¯å¾‘éƒ½æœƒæ˜¯ä¸€æ¨£çš„ (éƒ½åœ¨github.com/foo/bar)</li></ol><h2 id="Go-modulesçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼"><a href="#Go-modulesçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼" class="headerlink" title="Go modulesçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼"></a>Go modulesçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼</h2><h3 id="æŒ‡ä»¤"><a href="#æŒ‡ä»¤" class="headerlink" title="æŒ‡ä»¤"></a>æŒ‡ä»¤</h3><ul><li><code>go mod init</code>: ç”¢ç”Ÿ go.mod æª”æ¡ˆ</li><li><code>go mod download</code>: ä¸‹è¼‰go.modæª”æ¡ˆä¸­æŒ‡æ˜çš„æ‰€æœ‰ä¾è³´</li><li><code>go mod tidy</code>: æ•´ç†æ‰€æœ‰ä¾è³´</li><li><code>go mod graph</code>: æª¢è¦–ç¾æœ‰çš„ä¾è³´çµæ§‹</li><li><code>go mod edit</code>: ç·¨è¼¯ go.mod æª”æ¡ˆ</li><li><code>go mod vendor</code>: æœƒå‡ºå°ˆæ¡ˆæ‰€æœ‰çš„ä¾è³´åˆ°vendorç›®éŒ„</li><li><code>go mod verify</code>: é©—è­‰ä¸€å€‹æ¨¡çµ„æ˜¯å¦è¢«ç«„æ”¹é</li><li><code>go mod why</code>: æª¢è¦–ç‚ºä½•éœ€è¦ä¾è³´è©²æ¨¡çµ„</li></ul><h3 id="ç’°å¢ƒè®Šæ•¸"><a href="#ç’°å¢ƒè®Šæ•¸" class="headerlink" title="ç’°å¢ƒè®Šæ•¸"></a>ç’°å¢ƒè®Šæ•¸</h3><p>å¯é€é <code>go env</code> ä¾†æª¢è¦–å¸¸ç”¨çš„ç’°å¢ƒè®Šæ•¸ï¼Œä»¥ä¸‹ç‚ºèˆ‡Go Moduleç›¸é—œçš„ç’°å¢ƒè®Šæ•¸</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> GOMODULESæ–°å¢çš„ç’°å¢ƒè®Šæ•¸</span><br><span class="line">GO111MODULE="on"</span><br><span class="line">GOPROXY="https://proxy.golang.org,direct"</span><br><span class="line">GONOPROXY=""</span><br><span class="line">GOSUMDB="sum.golang.org"</span><br><span class="line">GONOSUMDB=""</span><br><span class="line">GOPRIVATE=""</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ä»¥ä¸‹ç‚ºåŸæœ¬GOPATHå°±æœ‰çš„ç’°å¢ƒè®Šæ•¸</span><br><span class="line">GOARCH="amd64"</span><br><span class="line">GOBIN="/Users/user/go/bin"</span><br><span class="line">GOCACHE="/Users/user/Library/Caches/go-build"</span><br><span class="line">GOENV="/Users/user/Library/Application Support/go/env"</span><br><span class="line">GOEXE=""</span><br><span class="line">GOFLAGS=""</span><br><span class="line">GOHOSTARCH="amd64"</span><br><span class="line">GOHOSTOS="darwin"</span><br><span class="line">GOINSECURE=""</span><br><span class="line">GOMODCACHE="/Users/user/go/pkg/mod"</span><br><span class="line">GOOS="darwin"</span><br><span class="line">GOPATH="/Users/user/go"</span><br><span class="line">GOROOT="/usr/local/Cellar/go/1.15/libexec"</span><br><span class="line">GOTMPDIR=""</span><br><span class="line">GOTOOLDIR="/usr/local/Cellar/go/1.15/libexec/pkg/tool/darwin_amd64"</span><br><span class="line">GCCGO="gccgo"</span><br><span class="line">AR="ar"</span><br><span class="line">CC="clang"</span><br><span class="line">CXX="clang++"</span><br><span class="line">CGO_ENABLED="1"</span><br><span class="line">GOMOD="/dev/null"</span><br><span class="line">CGO_CFLAGS="-g -O2"</span><br><span class="line">CGO_CPPFLAGS=""</span><br><span class="line">CGO_CXXFLAGS="-g -O2"</span><br><span class="line">CGO_FFLAGS="-g -O2"</span><br><span class="line">CGO_LDFLAGS="-g -O2"</span><br><span class="line">PKG_CONFIG="pkg-config"</span><br><span class="line">GOGCCFLAGS="-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/3t/8jsg2cz52yn2glq8rk_9y7x40000gn/T/go-build233814295=/tmp/go-build -gno-record-gcc-switches -fno-common"</span><br></pre></td></tr></table></figure><h4 id="GO111MODULE"><a href="#GO111MODULE" class="headerlink" title="GO111MODULE"></a>GO111MODULE</h4><p>é€éGO111MODULEä½œç‚ºè©²å°ˆæ¡ˆæ˜¯å¦ä½¿ç”¨ Go modulesçš„é–‹é—œï¼Œå¯è¨­å®šä»¥ä¸‹å…§å®¹</p><ul><li>auto: åªè¦å°ˆæ¡ˆåŒ…å« <code>go.mod</code> æª”æ¡ˆï¼Œå°±ä½¿ç”¨Go modules (åœ¨Go 1.11~1.14ï¼Œç‚ºé è¨­)</li><li>on: å•Ÿç”¨Go modules (æ¨è–¦ä½¿ç”¨)</li><li>off: ç¦ç”¨Go modules</li></ul><div style="border-radius: 10px;padding: 20px;background-color: #C8FAFF;color: black;margin-bottom: 15px;"><br>ç‚ºä½•å«åš GO111MODULE?<br><br>å› ç‚ºgo modulesæ˜¯åœ¨ go1.11ç‰ˆæœ¬æ‰€æå‡ºçš„<br></div><h4 id="GOPROXY"><a href="#GOPROXY" class="headerlink" title="GOPROXY"></a>GOPROXY</h4><p>è¨­å®šGOæ¨¡çµ„çš„proxy, ä½¿Goåœ¨å¾ŒçºŒæ‹‰å–æ¨¡çµ„çš„ç‰ˆæœ¬æ™‚ï¼Œç›´æ¥é€éæ˜ åƒæª”ç¶²ç«™å¿«é€Ÿæ‹‰å–ï¼Œè€Œéåˆ°Githubé€™ç¨®Version control serviceå¹³å°</p><p>GOPROXYé è¨­å€¼ç‚º <code>https://proxy.golang.org,direct</code>ï¼Œé€éé€—è™Ÿå°‡ä»£ç†çš„åœ°æ–¹çµ¦éš”é–‹</p><p>è‹¥ä¸æƒ³ä½¿ç”¨GOPROXY, å¯è¨­ç½®ç‚º GOPROXY=â€offâ€</p><p>å…¶ä¸­æœ€å¾Œæœ‰ <code>direct</code> ä¸€è©çš„ç”¨æ„æ˜¯ï¼Œè‹¥å‰é¢çš„proxyå€¼éƒ½æ²’è¾¦æ³•è¼‰åˆ°<br>æ¨¡çµ„ï¼Œä¾‹å¦‚åœ¨ <code>https://proxy.golang.org</code>æŠ“ä¸åˆ°ï¼Œé‚£éº¼å°±æœƒå›åˆ°åŸä½ç½®(ä¾‹å¦‚Github)å»ä¸‹è¼‰</p><h4 id="GOSUMDB"><a href="#GOSUMDB" class="headerlink" title="GOSUMDB"></a>GOSUMDB</h4><p>GOSUMDBç‚ºGo checksum databaseï¼Œé©—è­‰æ‹‰å–çš„æ¨¡çµ„ç‰ˆæœ¬è³‡æ–™æœªç¶“éç«„æ”¹</p><p>é è¨­å€¼ç‚º <code>sum.golang.org</code>ï¼Œä¹Ÿå¯è¨­ç½®æˆ <code>off</code>ï¼Œç¦æ­¢Goåœ¨å¾ŒçºŒæ“ä½œä¸­åšé©—è­‰ç‰ˆæœ¬çš„å‹•ä½œ</p><h4 id="GONOPROXY-GONOSUMDB-GOPRIVATE"><a href="#GONOPROXY-GONOSUMDB-GOPRIVATE" class="headerlink" title="GONOPROXY/GONOSUMDB/GOPRIVATE"></a>GONOPROXY/GONOSUMDB/GOPRIVATE</h4><p>è¨­å®šç§æœ‰æ¨¡çµ„çš„ç’°å¢ƒè®Šæ•¸ï¼Œä¸€èˆ¬ä¾†èªªå»ºè­°ç›´æ¥è¨­å®š GONOPROXYï¼Œæœƒä½œç‚º GONOPROXYèˆ‡GONOSUMDBçš„é è¨­å€¼</p><p>å€¼å¯è¨­å®šå¤šçµ„ï¼Œä¾‹å¦‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GOPRIVATE="git.xxx.com,github.com/eddycjy/mquote"</span><br></pre></td></tr></table></figure></p><p>è¨­å®šä¹‹å¾Œå­—é¦–ç‚º <code>git.xxx.com</code> ä»¥åŠ <code>github.com/eddycjy/mquote</code> çš„æ¨¡çµ„æœƒè¢«èªç‚ºæ˜¯ç§æœ‰æ¨¡çµ„</p><p>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨è¨­å®š <code>*</code>ï¼Œä»¥ä¸‹è¡¨ç¤ºä¾†è‡ª<code>.example.com</code> çš„å­åŸŸåçš„éƒ½è¡¨ç¤ºä¾†è‡ªç§æœ‰å€‰åº«</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GOPRIVATE="*.example.com"</span><br></pre></td></tr></table></figure><h3 id="å•Ÿç”¨æ–¹å¼"><a href="#å•Ÿç”¨æ–¹å¼" class="headerlink" title="å•Ÿç”¨æ–¹å¼"></a>å•Ÿç”¨æ–¹å¼</h3><p>Go modulesé è¨­ä¸æ˜¯é–‹å•Ÿçš„ï¼Œé€é<code>GO111MODULE</code>ä¾†åšè¨­å®šï¼Œå¯ç”¨<code>auto</code>, <code>on</code>, <code>off</code>åšè¨­å®š</p><p>é€éenvé€²è¡Œè¨­å®š <code>go env -w</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GO111MODULE=on</span><br></pre></td></tr></table></figure></p><h3 id="åˆå§‹åŒ–ä¸€å€‹å°ˆæ¡ˆ"><a href="#åˆå§‹åŒ–ä¸€å€‹å°ˆæ¡ˆ" class="headerlink" title="åˆå§‹åŒ–ä¸€å€‹å°ˆæ¡ˆ"></a>åˆå§‹åŒ–ä¸€å€‹å°ˆæ¡ˆ</h3><p>åœ¨ä¸€å€‹è³‡æ–™å¤¾å…§ï¼Œé€é <code>go mod init</code> åˆå§‹åŒ–ä¸€å€‹å°ˆæ¡ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go mod init github.com/jellyhola/module-repo</span><br><span class="line">go: creating new go.mod: module github.com/jellyhola/module-repo</span><br></pre></td></tr></table></figure><p>é€™æ™‚æœƒç”¢ç”Ÿä¸€å€‹ <code>go.mod</code> æª”æ¡ˆï¼Œæœƒç´€éŒ„ç›®å‰å°ˆæ¡ˆæ¨¡çµ„ç‚º <code>github.com/jellyhola/module-repo</code>ï¼Œgoç‰ˆæœ¬ç‚º<code>1.15</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line">go 1.15</span><br></pre></td></tr></table></figure></p><p>é€™æ™‚å®šç¾©ä¸€ä»½ <code>main.go</code> æª”æ¡ˆï¼Œimport <code>github.com/example/hello</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"rsc.io/quote"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">Hello()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Hello :print quote.Hello()</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hello</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> quote.Hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€™æ™‚å°ˆæ¡ˆç›®éŒ„æœƒè‡ªå‹•ç”¢ç”Ÿ <code>go.sum</code>æª”æ¡ˆ, ä»¥åŠ<code>go.mod</code>æœƒå¤šç´€éŒ„ä½¿ç”¨äº† <code>rsc.io/quote</code>æ¨¡çµ„ä»¥åŠä½¿ç”¨çš„ç‰ˆæœ¬ç‚º <code>1.5.2</code></p><p>go.sum<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c h1:qgOY6WgZOaTkIIMiVjBQcw93ERBE4m30iBm00nkL0i8=</span><br><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=</span><br><span class="line">rsc.io/quote v1.5.2 h1:w5fcysjrx7yqtD/aO+QwRjYZOKnaM9Uh2b40tElTs3Y=</span><br><span class="line">rsc.io/quote v1.5.2/go.mod h1:LzX7hefJvL54yjefDEDHNONDjII0t9xZLPXsUe+TKr0=</span><br><span class="line">rsc.io/sampler v1.3.0 h1:7uVkIFmeBqHfdjD+gZwtXXI+RODJ2Wc4O7MPEh/QiW4=</span><br><span class="line">rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA=</span><br></pre></td></tr></table></figure></p><p>go.mod<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line">go 1.15</span><br><span class="line"></span><br><span class="line">require rsc.io/quote v1.5.2</span><br></pre></td></tr></table></figure></p><div style="border-radius: 10px;padding: 20px;background-color: #C8FAFF;color: black;margin-bottom: 15px;"><br><br>å»ºè­°å°‡ go.sumèˆ‡go.modé€™å…©å€‹æª”æ¡ˆæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶<br><br></div><p>ç”±æ–¼æœ¬èº«<code>rsc.io/quote</code>é€™å€‹æ¨¡çµ„ï¼Œä¸‹è¼‰goæ™‚å°±å·²ç¶“å®‰è£å®Œç•¢ï¼Œæ•…ä¸ç”¨é€é <code>go get</code>ä¾†é¡å¤–ä¸‹è¼‰</p><p>æ¥è‘—å¯ç”¨<code>go list -m all</code> æª¢è¦–ç›®å‰å°ˆæ¡ˆæ‰€ä½¿ç”¨çš„ä¾è³´</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go list -m all</span><br><span class="line">github.com/jellyhola/module-repo</span><br><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c</span><br><span class="line">rsc.io/quote v1.5.2</span><br><span class="line">rsc.io/sampler v1.3.0</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ°ç›®å‰ <code>golang.org/x/text</code>é€™é …æ¨¡çµ„ï¼Œç‚ºuntaggedçš„ç‹€æ³ï¼Œæ¥è‘—å¯ä»¥é€é <code>go get</code>ä¾†æ›´æ–°æ­¤æ¨¡çµ„åˆ°æœ€æ–°çš„tag</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go get golang.org/x/text</span><br><span class="line">go: golang.org/x/text upgrade =&gt; v0.3.4</span><br><span class="line">go: downloading golang.org/x/text v0.3.4</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ° go.modå…§å®¹æ”¹è®Šäº†<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.15</span></span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">golang.org/x/text v0<span class="number">.3</span><span class="number">.4</span> <span class="comment">// indirect</span></span><br><span class="line">rsc.io/quote v1<span class="number">.5</span><span class="number">.2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ <code>// indirect</code> è¡¨ç¤ºè©²æ¨¡çµ„ç‚ºé–“æ¥ä¾è³´ï¼Œè¡¨ç¤ºç›®å‰æ‡‰ç”¨ç¨‹å¼çš„importæ•˜è¿°ä¸­ï¼Œä¸¦æ²’æœ‰ç™¼ç¾é€™æ¨¡çµ„çš„æ˜ç¢ºåƒè€ƒï¼Œæœ‰å¯èƒ½æ˜¯</p><ul><li>äº‹å…ˆæ‰‹å‹•go getæ‹‰å–ä¸‹ä¾†çš„æ¨¡çµ„</li><li>è©²å°ˆæ¡ˆæ‰€ä¾è³´æ¨¡çµ„ä¹‹æ‰€ä¾è³´çš„</li></ul><p>è©¦è‘—è·‘ä¸€ä¸‹å°ˆæ¡ˆï¼Œé©—è­‰æ¨¡çµ„æ˜¯å¦èƒ½æ­£å¸¸é‹ä½œ</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go run main.go</span><br><span class="line">ä½ å¥½ï¼Œä¸–ç•Œã€‚%</span><br></pre></td></tr></table></figure><h3 id="æ‹‰å–çš„æ¨¡çµ„æœƒå­˜åœ¨å“ªï¼Ÿ"><a href="#æ‹‰å–çš„æ¨¡çµ„æœƒå­˜åœ¨å“ªï¼Ÿ" class="headerlink" title="æ‹‰å–çš„æ¨¡çµ„æœƒå­˜åœ¨å“ªï¼Ÿ"></a>æ‹‰å–çš„æ¨¡çµ„æœƒå­˜åœ¨å“ªï¼Ÿ</h3><p>go modæœƒå°‡æ‹‰å–çš„æ¨¡çµ„æ”¾ç½®åœ¨ <code>$GOPATH/pkg/mod</code> èˆ‡ <code>$GOPATH/pkg/sumdb</code> ç›®éŒ„ä¸‹ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ls $GOPATH/pkg</span><br><span class="line">cache      github.com golang.org  rsc.io</span><br></pre></td></tr></table></figure><p>è‹¥æƒ³è¦æ¸…é™¤å·²ç¶“å¿«å–çš„æ¨¡çµ„ç‰ˆæœ¬ï¼Œä½¿ç”¨ <code>go clean -modcache</code> æŒ‡ä»¤</p><h2 id="Go-module-é€²éšæ¢è¨"><a href="#Go-module-é€²éšæ¢è¨" class="headerlink" title="Go module é€²éšæ¢è¨"></a>Go module é€²éšæ¢è¨</h2><h3 id="Go-modulesçš„go-getæ¢è¨"><a href="#Go-modulesçš„go-getæ¢è¨" class="headerlink" title="Go modulesçš„go getæ¢è¨"></a>Go modulesçš„go getæ¢è¨</h3><p>ä½¿ç”¨go getå–å¾—æ¨¡çµ„æ™‚ï¼Œæœƒåˆ†åˆ¥é€²è¡Œ3å€‹æ­¥é©Ÿ</p><ol><li>finding: æŸ¥æ‰¾æ¨¡çµ„æ˜¯å¦å­˜åœ¨</li><li>downloading: é€²è¡Œä¸‹è¼‰</li><li>extracting: åˆ†æä¸‹è¼‰çš„æ¨¡çµ„çš„é›œæ¹Šå€¼æ˜¯å¦æ­£ç¢º</li></ol><p>åƒä¸Šä¸€ç¯€æ‰€æ‹‰å–çš„æ¨¡çµ„ <code>golang.org/x/text</code> å…¶æ‹‰å–çš„è³‡è¨Šå¦‚ä¸‹</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç‰ˆæœ¬è³‡è¨Š-commitçš„æ™‚é–“-é›œæ¹Šå€¼</span><br><span class="line">v0.0.0-20170915032832-14c0d48ead0c</span><br></pre></td></tr></table></figure><ul><li>commitçš„æ™‚é–“æœƒæ˜¯ä»¥UTCæ™‚å€ç‚ºæº–</li><li>go getæ‹‰å–çš„æŒ‡ä»¤è‹¥æ²’æœ‰æŒ‡å®šç‰ˆæœ¬ï¼Œæœƒç›´æ¥æ‹‰å–åˆ° v0.0.0ç‰ˆ</li></ul><h3 id="go-getè¡Œç‚º"><a href="#go-getè¡Œç‚º" class="headerlink" title="go getè¡Œç‚º"></a>go getè¡Œç‚º</h3><ul><li>go get: ç›´æ¥æ‹‰å–dependencyï¼Œåªæœƒæ›´æ–°æŒ‡å®šçš„ä»–è‡ªå·±</li><li>go get -u: æ›´æ–°ç¾æœ‰çš„dependencyï¼Œæœƒå¼·åˆ¶æ›´æ–°è©²denpendencyæ‰€ä¾è³´çš„å…¶ä»–æ¨¡çµ„</li><li>go get -u -t: æ›´æ–°æ‰€æœ‰denpendencyï¼Œä»¥åŠåŒ…å«å–®å…ƒæ¸¬è©¦ä½¿ç”¨åˆ°çš„</li></ul><h3 id="go-getç‰ˆæœ¬æŒ‡å®š"><a href="#go-getç‰ˆæœ¬æŒ‡å®š" class="headerlink" title="go getç‰ˆæœ¬æŒ‡å®š"></a>go getç‰ˆæœ¬æŒ‡å®š</h3><ul><li>go get golang.org/x/text@latest : æ‹‰å–æœ€æ–°çš„ç‰ˆæœ¬ï¼Œè‹¥å­˜åœ¨tagï¼Œå„ªå…ˆä½¿ç”¨ä¹‹</li><li>go get golang.org/x/text@master : æ‹‰å–masteråˆ†æ”¯çš„æœ€æ–°commit</li><li>go get <a href="mailto:golang.org/x/text@v0.3.2" target="_blank" rel="noopener">golang.org/x/text@v0.3.2</a> : æ‹‰å–tagç‚ºv0.3.2çš„commit</li><li>go get golang.org/x/text@342b2e : æ‹‰å–hashç‚º342b2eçš„commitï¼Œæœ€å¾Œè½‰ç‚º v0.3.2</li></ul><h2 id="Go-modulesçš„go-runèˆ‡go-build"><a href="#Go-modulesçš„go-runèˆ‡go-build" class="headerlink" title="Go modulesçš„go runèˆ‡go build"></a>Go modulesçš„go runèˆ‡go build</h2><p>åŸ·è¡Œgo buildæ™‚ï¼Œæœƒæ ¹æ“šgo.modè‡ªå‹•ä¸‹è¼‰è©²å°ˆæ¡ˆæ‰€éœ€çš„æ¨¡çµ„ï¼Œæ‰é€²è¡Œç·¨è­¯</p><div style="border-radius: 10px;padding: 20px;background-color: #FFF6C8;color: black;margin-bottom: 15px;"><br><br>è‹¥æ˜¯è¦ä½¿ç”¨ vendorç›®éŒ„ä½œç‚ºdenpendency, åœ¨åŸ·è¡Œ go mod vendorç”¢ç”Ÿvendorç›®éŒ„å¾Œï¼Œéœ€è¦åŸ·è¡Œ go build -mod=vendor<br>æ‰å¯ä½¿ç”¨ go build -mod=vendor ä½¿ç”¨vendorç›®éŒ„ä½œç‚ºdenpendencyä¾†ç·¨è­¯<br><br></div><h2 id="Go-modulesåŒ¯å…¥è·¯å¾‘èªªæ˜"><a href="#Go-modulesåŒ¯å…¥è·¯å¾‘èªªæ˜" class="headerlink" title="Go modulesåŒ¯å…¥è·¯å¾‘èªªæ˜"></a>Go modulesåŒ¯å…¥è·¯å¾‘èªªæ˜</h2><p>Go modulesåœ¨ä¸»ç‰ˆæœ¬ç·¨è™Ÿç‚º v0èˆ‡v1çš„æƒ…æ³æœƒçœç•¥å…¶ç·¨è™Ÿï¼Œåœ¨v2ä»¥ä¸Šå‰‡éœ€è¦æ˜ç¢ºæŒ‡å®šï¼</p><p>å‡å¦‚è¦åŒ¯å…¥ v2ä»¥ä¸Šçš„<a href="mailto:golang.org/example@v2.0.0" target="_blank" rel="noopener">golang.org/example@v2.0.0</a>ï¼Œå‰‡å¿…é ˆè¦åœ¨importåº•ä¸‹æ˜ç¢ºæŒ‡å®šv2</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"github.com/example/v2"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="ç‚ºä½•çœç•¥v0èˆ‡v1"><a href="#ç‚ºä½•çœç•¥v0èˆ‡v1" class="headerlink" title="ç‚ºä½•çœç•¥v0èˆ‡v1??"></a>ç‚ºä½•çœç•¥v0èˆ‡v1??</h3><p>å› ç‚ºå®˜æ–¹é¼“å‹µé–‹ç™¼äººå“¡å°‡æ¨¡çµ„å»ºç«‹åˆ°v1ç‰ˆæœ¬å°±ä¸åœ¨è®Šå‹•ã€‚</p><p>æ‰€ä»¥è‹¥é–‹ç™¼äººå“¡åœ¨ç™¼ä½ˆv2ç‰ˆæœ¬æ™‚ï¼Œæœƒè¢«æ“æœ‰æ˜ç¢ºçš„v1ç‰ˆæœ¬å°¾ç¶´ï¼Œè¿‘ä¸€æ­¥å°è‡´v1ç‰ˆæœ¬è®Šæˆé›œè¨Šä¸”æ²’æœ‰ä»€éº¼æ„ç¾©</p><p>åœ¨åŒ¯å…¥è·¯å¾‘å¿½ç•¥v0ç‰ˆæœ¬ï¼Œå› ç‚ºæ ¹æ“šèªæ„åŒ–ç‰ˆæœ¬æ¨™æº–ï¼Œv0çš„é€™äº›ç‰ˆæœ¬å¤§å¤šæ²’æœ‰ç›¸å®¹æ€§ä¿è­‰</p><h2 id="Go-modules-èªæ„åŒ–ç‰ˆæœ¬æ§åˆ¶"><a href="#Go-modules-èªæ„åŒ–ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="Go modules èªæ„åŒ–ç‰ˆæœ¬æ§åˆ¶"></a>Go modules èªæ„åŒ–ç‰ˆæœ¬æ§åˆ¶</h2><p>ä¸€å€‹go modulesçš„ç‰ˆæœ¬è³‡è¨Šå¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//ä¸»ç‰ˆæœ¬è™Ÿ.æ¬¡ç‰ˆæœ¬è™Ÿ.ä¿®è¨‚è™Ÿ</span><br><span class="line">v1.2.3</span><br></pre></td></tr></table></figure></p><ul><li>ä¸»ç‰ˆæœ¬ç·¨è™Ÿï¼šåšäº†ä¸ç›¸å®¹çš„APIä¿®æ”¹ä¹‹é¡çš„</li><li>æ¬¡ç‰ˆæœ¬ç·¨è™Ÿ: åšäº†å‘ä¸‹ç›¸å®¹çš„åŠŸèƒ½æ€§æ–°å¢</li><li>ä¿®è¨‚å¥½: å‘ä¸‹ç›¸å®¹çš„åŠŸèƒ½é™¤éŒ¯</li></ul><p>è‹¥æ˜¯å…ˆè¡Œç‰ˆæœ¬çš„è©±ï¼Œé‚£åŠ ä¸Š <code>pre</code> å¾Œç¶´<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1.2.3-pre</span><br></pre></td></tr></table></figure></p><div style="border-radius: 10px;padding: 20px;background-color: #FFF6C8;color: black;margin-bottom: 15px;"><br><br>ç™¼ä½ˆæ–°ç‰ˆæœ¬æ™‚æ‡‰éµå¾ªèªæ„åŒ–ç‰ˆæœ¬è¦å‰‡ï¼Œå¦å‰‡ç„¡æ³•è¢«go getæ‰€æ‹‰å–<br><br></div><h2 id="go-listçš„åŠŸèƒ½"><a href="#go-listçš„åŠŸèƒ½" class="headerlink" title="go listçš„åŠŸèƒ½"></a>go listçš„åŠŸèƒ½</h2><p>æä¾›è©²å°ˆæ¡ˆæ‰€æœ‰denpendencyçš„è³‡è¨Š</p><p>é€é <code>go list -m -u all</code> å¯ä»¥æª¢è¦–æ‰€æœ‰çš„dependencyè³‡è¨Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ go list -m -u all</span><br><span class="line">github.com/jellyhola/module-repo</span><br><span class="line">golang.org/x/text v0.3.4</span><br><span class="line">golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e</span><br><span class="line">rsc.io/quote v1.5.2</span><br><span class="line">rsc.io/sampler v1.3.0</span><br></pre></td></tr></table></figure><ul><li>-m: é¡¯ç¤ºæ‰€æœ‰ä¾è³´çš„æ¨¡çµ„</li><li>-u: é¡¯ç¤ºèƒ½å¤ å‡ç´šçš„ç‰ˆæœ¬</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Go Module ç‚ºç›®å‰æœ€ä¸»æµçš„ä¾è³´è§£æ±ºçš„æ–¹æ¡ˆ&lt;/p&gt;
&lt;p&gt;ç™¼ä½ˆæ–¼ Go 11.1ç‰ˆï¼Œæ–¼Go 1.14æ¨è–¦åœ¨Productionç’°å¢ƒä¸Šä½¿ç”¨&lt;/p&gt;
    
    </summary>
    
      <category term="Golang" scheme="http://a10000005588.github.io/categories/Golang/"/>
    
    
      <category term="Golang" scheme="http://a10000005588.github.io/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>Gitbookçš„ä½¿ç”¨ç´€éŒ„</title>
    <link href="http://a10000005588.github.io/2020/10/04/gitbook-tutorial/"/>
    <id>http://a10000005588.github.io/2020/10/04/gitbook-tutorial/</id>
    <published>2020-10-03T22:47:21.000Z</published>
    <updated>2021-01-28T12:12:54.817Z</updated>
    
    <content type="html"><![CDATA[<p>Gitbookæä¾›äº†èƒ½å¤ å°‡markdownæ ¼å¼è½‰å¯«æˆä¸€æœ¬é›»å­æ›¸çš„æ¨£å­</p><a id="more"></a><h2 id="æœ¬åœ°ç«¯åŸ·è¡Œ"><a href="#æœ¬åœ°ç«¯åŸ·è¡Œ" class="headerlink" title="æœ¬åœ°ç«¯åŸ·è¡Œ"></a>æœ¬åœ°ç«¯åŸ·è¡Œ</h2><p>å®‰è£æ–¹å¼ï¼Œç”¨ <a href="https://www.npmjs.com/package/gitbook" target="_blank" rel="noopener">npm</a> å®‰è£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g gitbook-cli</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><p>æ‰¾ä¸€å€‹è³‡æ–™å¤¾ï¼ŒåŸ·è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitbook init</span><br></pre></td></tr></table></figure></p><p>æœƒç”¢ç”Ÿ </p><ul><li>reamdme.md<ul><li>ä»‹ç´¹æœ¬æ›¸å…§å®¹</li></ul></li><li>summary.md<ul><li>ç”¨ä¾†å®šç¾©gitbookç›®éŒ„</li></ul></li></ul><h4 id="summary-md-çµæ§‹"><a href="#summary-md-çµæ§‹" class="headerlink" title="summary.md çµæ§‹"></a>summary.md çµæ§‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* ch1</span><br><span class="line">  * ch1-1</span><br><span class="line">  * ch1-2</span><br></pre></td></tr></table></figure><p>æª”æ¡ˆçµæ§‹çš„è©±å°±é•·é€™æ¨£<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- ch1</span><br><span class="line">|- ch1-1</span><br><span class="line">|- ch1-2</span><br><span class="line">-readme.md</span><br><span class="line">-summary.md</span><br></pre></td></tr></table></figure></p><h2 id="é‹è¡Œgitbook"><a href="#é‹è¡Œgitbook" class="headerlink" title="é‹è¡Œgitbook"></a>é‹è¡Œgitbook</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitbook serve</span><br></pre></td></tr></table></figure><p>é è¨­æœƒé‹è¡Œåœ¨ <a href="http://localhost:4000" target="_blank" rel="noopener">localhost:4000</a></p><h3 id="å®‰è£Plugin"><a href="#å®‰è£Plugin" class="headerlink" title="å®‰è£Plugin"></a>å®‰è£Plugin</h3><p>äº‹å…ˆå®‰è£gitbook-pluginå¥—ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gitbook-plugin</span><br></pre></td></tr></table></figure></p><p>è‹¥è¦å®‰è£ç•™è¨€æ¿ç­‰å¥—ä»¶ï¼Œéœ€è¦å…ˆå®šç¾© book.json ï¼Œå¯ä»¥å®šç¾©ä½¿ç”¨çš„plugin</p><p>book.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;plugins&quot;: [&quot;disqus&quot;],</span><br><span class="line">  &quot;pluginsConfig&quot;: &#123;</span><br><span class="line">    &quot;disqus&quot;: &#123;</span><br><span class="line">      &quot;shortName&quot;: &quot;ä½ çš„ç•™è¨€æ¿åç¨±&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¾‹å¦‚å¯ä½¿ç”¨ Google Analytics ( Google åˆ†æ )ã€Disqus ( ç¤¾ç¾¤&amp;ç•™è¨€æ¿ ) å’Œ youtube â€¦ç­‰å¤–æ›ï¼Œä¹Ÿå¯ä»¥åœ¨Gitbook npmç¶²ç«™ä¸­æ‰¾åˆ°è‡ªå·±è¦çš„plugin</p><p>å®šç¾©ç©ä½¿ç”¨çš„plunginå¤–æ›ï¼Œè«‹åŸ·è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitbook install</span><br></pre></td></tr></table></figure></p><h3 id="Disqusç•™è¨€æ¿"><a href="#Disqusç•™è¨€æ¿" class="headerlink" title="Disqusç•™è¨€æ¿"></a>Disqusç•™è¨€æ¿</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i gitbook-plugin-disqus</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;plugins&quot;: [&quot;disqus&quot;],</span><br><span class="line">  &quot;pluginsConfig&quot;: &#123;</span><br><span class="line">    &quot;disqus&quot;: &#123;</span><br><span class="line">      &quot;shortName&quot;: &quot;ä½ çš„ç•™è¨€æ¿åç¨±&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…§å®¹ç¶±è¦-InTopic-TOC"><a href="#å…§å®¹ç¶±è¦-InTopic-TOC" class="headerlink" title="å…§å®¹ç¶±è¦ InTopic TOC"></a>å…§å®¹ç¶±è¦ InTopic TOC</h3><p>å¦‚æœè¦å¯¦ç¾å³é‚Šå´é‚Šæ¬„æœ¬é mdæª”æ¡ˆçš„éšå±¤å¼ï¼Œå¯å®‰è£ InTopic TOC</p><p><a href="https://github.com/fzankl/gitbook-plugin-intopic-toc" target="_blank" rel="noopener">GitBook plugin: InTopic TOC</a></p><p>æ–¼book.jsonä¸­å®šç¾©<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    &quot;intopic-toc&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;pluginsConfig&quot;: &#123;</span><br><span class="line">    &quot;intopic-toc&quot;: &#123;</span><br><span class="line">      &quot;label&quot;: &quot;In this article&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥è‘—åŸ·è¡Œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitbook install</span><br></pre></td></tr></table></figure></p><h2 id="åƒè€ƒ"><a href="#åƒè€ƒ" class="headerlink" title="åƒè€ƒ"></a>åƒè€ƒ</h2><p><a href="https://github.com/GitbookIO/gitbook" target="_blank" rel="noopener">Gitbook Github Docs</a></p><p><a href="https://docs.gitbook.com/getting-started/quick-start" target="_blank" rel="noopener">Gitbook Online Platform Docs</a></p><p><a href="https://www.oxxostudio.tw/articles/201502/gitbook.html" target="_blank" rel="noopener">ç”¨ GitBook ä¾†å¯«æœ¬æ›¸å§</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Gitbookæä¾›äº†èƒ½å¤ å°‡markdownæ ¼å¼è½‰å¯«æˆä¸€æœ¬é›»å­æ›¸çš„æ¨£å­&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://a10000005588.github.io/categories/Tools/"/>
    
    
      <category term="Note" scheme="http://a10000005588.github.io/tags/Note/"/>
    
  </entry>
  
  <entry>
    <title>éœæ…‹èˆ‡å‹•æ…‹å‡½å¼åº«çš„ä»‹ç´¹èˆ‡å·®ç•°(Static èˆ‡ Shared Libraries)</title>
    <link href="http://a10000005588.github.io/2020/08/17/Static_vs_Shared_Lib/"/>
    <id>http://a10000005588.github.io/2020/08/17/Static_vs_Shared_Lib/</id>
    <published>2020-08-17T13:38:37.000Z</published>
    <updated>2021-01-28T12:10:16.323Z</updated>
    
    <content type="html"><![CDATA[<p>å‰›å¥½åœ¨è¤‡ç¿’Golangçš„æ™‚å€™çœ‹åˆ°Goæœ‰æ”¯æ´è¼‰å…¥C Languageçš„Static Libraryèˆ‡Shared Librariesï¼Œæ–¼æ˜¯ä¾†è¤‡ç¿’ä¸€ä¸‹ä»–å€‘ä¹‹é–“çš„å·®ç•°</p><a id="more"></a><h2 id="ä»‹ç´¹"><a href="#ä»‹ç´¹" class="headerlink" title="ä»‹ç´¹"></a>ä»‹ç´¹</h2><p>é¦–å…ˆè¦å…ˆäº†è§£ï¼ŒLibraryçš„æ„ç¾©ï¼Œå°±å–®ç´”ç‚ºä¸€å€‹æª”æ¡ˆ<br>å°‡æœƒå…±ç”¨çš„ç¨‹å¼ç¢¼æ‰“åŒ…å†ä¸€èµ·çš„æª”æ¡ˆå°±ç¨±ç‚ºLibrary</p><p>å‡è¨­ç¾åœ¨è‹¥è¦ä½¿ç”¨printé€™å€‹æ–¹æ³•ä¾†å°å‡ºæ±è¥¿åœ¨è¢å¹•ï¼Œ<br>æ•…å¯ä»¥å°‡printç·¨è­¯æˆLibraryï¼Œä¾›å„å€‹é–‹ç™¼è€…ç›´æ¥ä½¿ç”¨ï¼Œä¸ç”¨è®“é–‹ç™¼è€…è‡ªå·±å®šç¾©printæ–¹æ³•ï¼Œè¦ç…©æƒ±å¦‚ä½•èˆ‡OSæºé€šä¸¦å°å‡ºç•«é¢çš„é‚è¼¯ç¨‹å¼ç¢¼</p><h3 id="Static-Library"><a href="#Static-Library" class="headerlink" title="Static Library"></a>Static Library</h3><p>Static Libararyé€šå¸¸ç‚ºæˆ‘å€‘è‡ªå·±å¯«å¥½çš„ç¨‹å¼ç¢¼ï¼Œç¶“éCompileä¹‹å¾Œï¼Œæ‰€å¾—åˆ°çš„å°±æ˜¯ Static Library</p><p>Sharedå‰‡æ˜¯æˆ‘å€‘ä¹Ÿæ˜¯å°‡ç¨‹å¼ç¢¼ç¶“éCompileï¼Œä¹Ÿæ˜¯å¾—åˆ° Shared Library</p><p>è½èµ·ä¾†éç¨‹éƒ½å¾ˆåƒï¼Œé‚£åˆ°åº•å·®ç•°åœ¨å“ªï¼Ÿ</p><p>å…¶å¯¦å¾å­—é¢ä¸Šæ›‰å¾—ï¼Œå¾ä½¿ç”¨å…¶æ„ç¾©ä¾†è§£é‡‹</p><p>åœ¨å°ˆæ¡ˆç¨‹å¼ä½¿ç”¨å…¶Static Libraryæ™‚ï¼Œè©²å°ˆæ¡ˆé€²è¡ŒCompileï¼ŒCompileræœƒåœ¨Compile Timeæ™‚å°‡Static Libraryçš„ç¨‹å¼ç¢¼çµ¦â€è¤‡è£½â€åˆ°å°ˆæ¡ˆç¨‹å¼ç¢¼ä¸­ã€‚</p><p>å‡å¦‚æˆ‘å€‘Static Libä¸­æœ‰å€‹<code>print()</code>æ–¹æ³•ï¼Œé‚£å°ˆæ¡ˆCompileæ™‚å°±æœƒæŠŠ<code>print()</code>æ–¹æ³•copyåˆ°APPä¸­ï¼ŒAPPå•Ÿå‹•æ™‚å°±æœƒæœ‰<code>print()</code>æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE (import static lib) -&gt; Compiled STATIC Lib</span><br><span class="line">APP å•Ÿå‹• -&gt; PRINT()</span><br></pre></td></tr></table></figure><h3 id="Shared-Library"><a href="#Shared-Library" class="headerlink" title="Shared Library"></a>Shared Library</h3><p>é¡§åæ€ç¾©å°±æ˜¯ç›´æ¥å…±äº«Libraryå…§çš„ç¨‹å¼ç¢¼</p><p>ç•¶å°ˆæ¡ˆä½¿ç”¨çš„æ˜¯Shared Libraryï¼Œé‚£å°ˆæ¡ˆé€²è¡ŒCompileæ™‚ï¼ŒCompileræœƒå»<code>Link</code> Shared Libarayçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç”¨è¤‡è£½çš„ã€‚</p><p>å‡å¦‚Shared Library Libä¸­åŒæ¨£æœ‰å€‹<code>print()</code>æ–¹æ³•ï¼Œé‚£å°ˆæ¡ˆCompileå°±æœƒé€£çµè©²Shared Libä¸­çš„<code>print()</code>æ–¹æ³•ï¼Œæ–¼æ˜¯APPå•Ÿå‹•ä¹ŸåŒæ¨£æœƒæœ‰<code>print()</code>æ–¹æ³•å¯ä½¿ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE (import shared lib) -&gt; Compiled</span><br><span class="line">APP å•Ÿå‹• -&gt; é€£çµä½¿ç”¨ Shared Libå…§çš„ print()</span><br></pre></td></tr></table></figure><blockquote><p>Shared Libraryæ”¯æ´å‹•æ…‹é€£çµè¼‰å…¥</p></blockquote><h2 id="ä½¿ç”¨æƒ…å¢ƒ"><a href="#ä½¿ç”¨æƒ…å¢ƒ" class="headerlink" title="ä½¿ç”¨æƒ…å¢ƒ"></a>ä½¿ç”¨æƒ…å¢ƒ</h2><p>è‹¥è¦çµ¦å®¢æˆ¶æä¾›ä¸€å€‹æœ‰100å€‹åŠŸèƒ½çš„APP</p><p>äº¤ä»˜çµ¦å®¢æˆ¶çš„è‹¥æ˜¯ Static Libraryå»ºç¯‰å‡ºçš„APP:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ¶è½è‘—ï¼Œä½ åªè¦æœ‰é€™ä¸€å€‹æª”æ¡ˆï¼Œå°±åŒ…å«äº†ä½ éœ€è¦çš„100å€‹åŠŸèƒ½</span><br></pre></td></tr></table></figure><p>è‹¥äº¤ä»˜çµ¦å®¢æˆ¶çš„åŠŸèƒ½ï¼Œæ¯ä¸€éš»åŠŸèƒ½éƒ½ç”¨Shared Libraryå¯¦ä½œï¼Œé‚£éº¼ã€‚ã€‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ¶è½è‘—ï¼Œæˆ‘é€™å€‹æª”æ¡ˆå¾ˆå°ï¼Œä½†åŒæ™‚è¦é€£çµ100çš„æª”æ¡ˆ (Shared Library)ï¼Œä¸€å€‹éƒ½ä¸èƒ½å°‘ï¼Œæ‰èƒ½å•Ÿå‹•</span><br></pre></td></tr></table></figure><h2 id="å„ªç¼ºé»"><a href="#å„ªç¼ºé»" class="headerlink" title="å„ªç¼ºé»"></a>å„ªç¼ºé»</h2><table><thead><tr><th></th><th>Static</th><th>Shared</th></tr></thead><tbody><tr><td>å°ˆæ¡ˆå¤§å°</td><td>å°ˆæ¡ˆsizeæ¯”è¼ƒè‚¥å¤§</td><td>å°ˆæ¡ˆçš„sizeè¼ƒå°</td></tr><tr><td>å•Ÿå‹•ç‹€æ³</td><td>ç¨‹å¼ç¢¼åœ¨Compileæ™‚éƒ½æ”¾åœ¨ä¸€èµ·äº†ï¼Œç›´æ¥é‹è¡Œè©²å°ˆæ¡ˆå°±å¥½</td><td>è‹¥æŸå€‹Shared Libä¸è¦‹ï¼Œå°ˆæ¡ˆæœƒç„¡æ³•å•Ÿå‹•</td></tr><tr><td>æ˜¯å¦æ”¯æ´å‹•æ…‹é€£çµ</td><td>ç„¡ï¼Œå°ˆæ¡ˆé‹ä½œæ™‚è¼ƒè€—è²»è¨˜æ†¶é«”</td><td>æœ‰æ”¯æ´ï¼Œç•¶åŸ·è¡Œåˆ°æœ‰ä½¿ç”¨Shared Libraryçš„classæ™‚ï¼Œæ‰æœƒè¼‰å…¥ä¹‹åˆ°è¨˜æ†¶é«”ï¼Œé¿å…è¨˜æ†¶é«”ç©ºé–“æµªè²»</td></tr></tbody></table><h2 id="Libraryç·¨è­¯çš„æª”æ¡ˆæ ¼å¼"><a href="#Libraryç·¨è­¯çš„æª”æ¡ˆæ ¼å¼" class="headerlink" title="Libraryç·¨è­¯çš„æª”æ¡ˆæ ¼å¼"></a>Libraryç·¨è­¯çš„æª”æ¡ˆæ ¼å¼</h2><ul><li><p>Shared Libraries</p><ul><li>.so (Linus)</li><li>.dll (Win)</li><li>.dylib (Mac)</li></ul></li><li><p>Static Libraries</p><ul><li>.a</li><li>.lib</li></ul></li></ul><h2 id="åƒè€ƒ"><a href="#åƒè€ƒ" class="headerlink" title="åƒè€ƒ"></a>åƒè€ƒ</h2><p>Static vs. Shared Libraries<br><a href="https://www.youtube.com/watch?v=-vp9cFQCQCo" target="_blank" rel="noopener">https://www.youtube.com/watch?v=-vp9cFQCQCo</a></p><p>Static èˆ‡ Shared çš„å‡½å¼åº«æ’°å¯«<br><a href="https://fred-zone.blogspot.com/2006/03/static-shared.html" target="_blank" rel="noopener">https://fred-zone.blogspot.com/2006/03/static-shared.html</a></p><p>å‹•æ…‹é€£çµå‡½å¼åº«<br><a href="https://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰›å¥½åœ¨è¤‡ç¿’Golangçš„æ™‚å€™çœ‹åˆ°Goæœ‰æ”¯æ´è¼‰å…¥C Languageçš„Static Libraryèˆ‡Shared Librariesï¼Œæ–¼æ˜¯ä¾†è¤‡ç¿’ä¸€ä¸‹ä»–å€‘ä¹‹é–“çš„å·®ç•°&lt;/p&gt;
    
    </summary>
    
      <category term="Computer Science" scheme="http://a10000005588.github.io/categories/Computer-Science/"/>
    
    
      <category term="Computer Science" scheme="http://a10000005588.github.io/tags/Computer-Science/"/>
    
  </entry>
  
  <entry>
    <title>State Pattern ç‹€æ…‹æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/08/08/Design-Pattern-Java-State-Pattern-%E7%8B%80%E6%85%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/08/08/Design-Pattern-Java-State-Pattern-ç‹€æ…‹æ¨¡å¼/</id>
    <published>2020-08-08T14:10:35.000Z</published>
    <updated>2021-01-28T12:17:50.577Z</updated>
    
    <content type="html"><![CDATA[<p>é€éçµ±ä¸€çš„â€ç‹€æ…‹é¡åˆ¥â€ï¼Œä¾†å®šç¾©ç‰©ä»¶çš„å…§éƒ¨ç‹€æ…‹æ˜¯å¦‚ä½•</p><a id="more"></a><h2 id="ä»¥ç³–æœæ©Ÿç‚ºä¾‹å­ï¼Œæ²’æœ‰ä½¿ç”¨State-Patternçš„ç‹€æ³"><a href="#ä»¥ç³–æœæ©Ÿç‚ºä¾‹å­ï¼Œæ²’æœ‰ä½¿ç”¨State-Patternçš„ç‹€æ³" class="headerlink" title="ä»¥ç³–æœæ©Ÿç‚ºä¾‹å­ï¼Œæ²’æœ‰ä½¿ç”¨State Patternçš„ç‹€æ³"></a>ä»¥ç³–æœæ©Ÿç‚ºä¾‹å­ï¼Œæ²’æœ‰ä½¿ç”¨State Patternçš„ç‹€æ³</h2><p>æˆ‘å€‘ç¾åœ¨æœ‰å€‹ç³–æœæ©Ÿï¼Œé€šå¸¸ä¸€å°ç³–æœæ©Ÿå¯ä»¥é€²è¡ŒæŠ•å¹£ï¼Œè½‰å‹•æ‰‹æŠŠï¼Œä¸¦åå‡ºä¸€é¡†ç³–æœ</p><p>æ‰€ä»¥è©²ç³–æœæ©Ÿå…±æœ‰å››ç¨®ç‹€æ…‹ (NoCoinStateç›®å‰æ²’æœ‰éŒ¢å¹£, HasCoinStateç›®å‰æœ‰éŒ¢å¹£, SoldCandyStateå”®å‡ºç³–æœä¸­, NoCandyStateæ²’æœ‰ç³–æœä¸­)ï¼Œå¦‚é™„åœ–æ‰€ç¤ºï¼š</p><p><img src="https://i.imgur.com/ulduLlN.png" alt=""></p><p>æˆ‘å€‘æœƒå¾ˆç›´è¦ºçš„å®šç¾©ç³–æœæ©Ÿé¡åˆ¥èˆ‡é€™å››å€‹ç‹€æ…‹ç‚ºå…¨åŸŸè®Šæ•¸ï¼Œä¸¦ä¸”å¯¦ä½œä¸€ä¸‹ç³–æœæ©Ÿå…·å‚™çš„å‹•ä½œæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandyMachine</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> NoCandyState = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> NoCoinState = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> HasCoinState = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> SoldCandyState = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> state = NoCandyState; <span class="comment">// ä¸€é–‹å§‹ç³–æœæ©Ÿæ˜¯æ²’æœ‰ç³–æœçš„</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>; <span class="comment">// ç³–æœæ•¸ç›®</span></span><br><span class="line"></span><br><span class="line">    CandyMachine(<span class="keyword">int</span> count) &#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">        <span class="keyword">this</span>.state = NoCoinState; <span class="comment">// æœ‰äº†ç³–æœï¼Œç­‰å¾…è¢«æŠ•éŒ¢</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æŠ•å…¥éŒ¢å¹£"</span>);</span><br><span class="line">        <span class="keyword">this</span>.state = HasCoinState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è½‰å‹•æŠŠæ‰‹ä¸­......"</span>);</span><br><span class="line">        <span class="comment">// åˆ¤æ–·ç›®å‰æ˜¯å¦æœ‰éŒ¢</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.state == HasCoinState) &#123;</span><br><span class="line">            <span class="keyword">this</span>.state = SoldCandyState;</span><br><span class="line">           <span class="keyword">this</span>.dispense();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"ç›®å‰æ²’æœ‰éŒ¢å¹£"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// æœ‰éŒ¢çš„è©±å°±åä¸€é¡†ç³–æœå‡ºä¾†</span></span><br><span class="line">        System.out.println(<span class="string">"ç³–æœæ©Ÿåäº†ä¸€é¡†ç³–æœ"</span>);</span><br><span class="line">        <span class="keyword">this</span>.count--;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.count == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ²’æœ‰ç³–æœäº†ï¼Œå›æ­¸åˆ°æ²’ç³–æœç‹€æ…‹</span></span><br><span class="line">            <span class="keyword">this</span>.state = NoCandyState;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// é‚„æœ‰ç³–æœçš„è©±ï¼Œé¡¯ç¤ºç›®å‰æ²’æœ‰éŒ¢å¹£</span></span><br><span class="line">            <span class="keyword">this</span>.state = NoCoinState;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£æˆ‘å€‘ç¾åœ¨å¯ä»¥ä¾†è·Ÿç³–æœæ©Ÿäº’å‹•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CandyMachine candyMachine = <span class="keyword">new</span> CandyMachine(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•</span></span><br><span class="line">        System.out.println(<span class="string">"====å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•===="</span>);</span><br><span class="line">        candyMachine.insertCoin();</span><br><span class="line">        candyMachine.turnCrank();</span><br><span class="line">        <span class="comment">// ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•</span></span><br><span class="line">        System.out.println(<span class="string">"====ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•===="</span>);</span><br><span class="line">        candyMachine.turnCrank();</span><br><span class="line">        <span class="comment">// æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿç›®å‰æ²’ç³–æœäº†</span></span><br><span class="line">        System.out.println(<span class="string">"=====æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿç›®å‰æ²’ç³–æœäº†===="</span>);</span><br><span class="line">        candyMachine.insertCoin();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">====å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•====</span><br><span class="line">æŠ•å…¥éŒ¢å¹£</span><br><span class="line">è½‰å‹•æŠŠæ‰‹ä¸­......</span><br><span class="line">ç³–æœæ©Ÿåäº†ä¸€é¡†ç³–æœ</span><br><span class="line">====ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•====</span><br><span class="line">è½‰å‹•æŠŠæ‰‹ä¸­......</span><br><span class="line">ç›®å‰æ²’æœ‰éŒ¢å¹£</span><br><span class="line">=====æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿç›®å‰æ²’ç³–æœäº†====</span><br><span class="line">æŠ•å…¥éŒ¢å¹£</span><br><span class="line">ç›®å‰æ²’æœ‰ç³–æœï¼ŒéŒ¢é€€é‚„çµ¦æ‚¨</span><br></pre></td></tr></table></figure><p>ç›®å‰çœ‹èµ·ä¾†é‹ä½œçš„å¾ˆæ­£å¸¸</p><h3 id="å‡å¦‚æœ‰æ–°éœ€æ±‚ï¼šè½‰å‹•æ™‚æœƒæœ‰æ©Ÿç‡å¯ä»¥å†å¤šé€ä¸€é¡†ï¼"><a href="#å‡å¦‚æœ‰æ–°éœ€æ±‚ï¼šè½‰å‹•æ™‚æœƒæœ‰æ©Ÿç‡å¯ä»¥å†å¤šé€ä¸€é¡†ï¼" class="headerlink" title="å‡å¦‚æœ‰æ–°éœ€æ±‚ï¼šè½‰å‹•æ™‚æœƒæœ‰æ©Ÿç‡å¯ä»¥å†å¤šé€ä¸€é¡†ï¼"></a>å‡å¦‚æœ‰æ–°éœ€æ±‚ï¼šè½‰å‹•æ™‚æœƒæœ‰æ©Ÿç‡å¯ä»¥å†å¤šé€ä¸€é¡†ï¼</h3><p>é‚£é€™æ™‚å€™â€¦æˆ‘å€‘å¾—å°CandyMachineçš„<code>dispense()</code>åšå€‹èª¿æ•´ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å®šç¾©æ©Ÿç‡ï¼Œå¦‚æœæ©Ÿç‡å°æ–¼10%å°±åå‡ºå…©é¡†ç³–æœ</span></span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">if</span> (rand.nextInt(<span class="number">10</span>) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ­å–œä¸­çï¼Œç³–æœæ©Ÿåäº†äºŒé¡†ç³–æœ"</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.count &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="comment">// åå‡ºå…©é¡†ç³–æœ</span></span><br><span class="line">                <span class="keyword">this</span>.count--;</span><br><span class="line">                <span class="keyword">this</span>.count--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ²’ä¸­çï¼Œåªåä¸€é¡†</span></span><br><span class="line">            <span class="keyword">this</span>.count--;</span><br><span class="line">            <span class="comment">// æœ‰éŒ¢çš„è©±å°±åä¸€é¡†ç³–æœå‡ºä¾†</span></span><br><span class="line">            System.out.println(<span class="string">"ç³–æœæ©Ÿåäº†ä¸€é¡†ç³–æœ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.count == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ²’æœ‰ç³–æœäº†ï¼Œå›æ­¸åˆ°æ²’ç³–æœç‹€æ…‹</span></span><br><span class="line">            <span class="keyword">this</span>.state = NoCandyState;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// é‚„æœ‰ç³–æœçš„è©±ï¼Œé¡¯ç¤ºç›®å‰æ²’æœ‰éŒ¢å¹£</span></span><br><span class="line">            <span class="keyword">this</span>.state = NoCoinState;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™æ™‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡è‹¥æœ‰æ–°éœ€æ±‚ï¼Œå°±éœ€è¦ä¸€ç›´å°CandyMachineé¡åˆ¥ä¸€ç›´åšä¿®æ­£ï¼Œå…¶æœªä¾†è‹¥æœ‰æ›´å¤šç‹€æ…‹æ™‚ï¼Œç¨‹å¼ç¢¼æœƒè®Šå¾—ä¸å¥½ç¶­è­·</p><h2 id="ä½¿ç”¨ç‹€æ…‹æ¨¡å¼æ”¹å–„ç›®å‰ç³–æœæ©Ÿçš„è¨­è¨ˆ"><a href="#ä½¿ç”¨ç‹€æ…‹æ¨¡å¼æ”¹å–„ç›®å‰ç³–æœæ©Ÿçš„è¨­è¨ˆ" class="headerlink" title="ä½¿ç”¨ç‹€æ…‹æ¨¡å¼æ”¹å–„ç›®å‰ç³–æœæ©Ÿçš„è¨­è¨ˆ"></a>ä½¿ç”¨ç‹€æ…‹æ¨¡å¼æ”¹å–„ç›®å‰ç³–æœæ©Ÿçš„è¨­è¨ˆ</h2><p>å…ˆä¾†çœ‹çœ‹è©²è¨­è¨ˆæ¨¡å¼çš„åœ–è¡¨æ˜¯é•·æ€æ¨£</p><h3 id="ç‹€æ…‹æ¨¡å¼çš„é¡åˆ¥åœ–"><a href="#ç‹€æ…‹æ¨¡å¼çš„é¡åˆ¥åœ–" class="headerlink" title="ç‹€æ…‹æ¨¡å¼çš„é¡åˆ¥åœ–"></a>ç‹€æ…‹æ¨¡å¼çš„é¡åˆ¥åœ–</h3><p><img src="https://i.imgur.com/umZlxP3.png" alt=""></p><p>é€™æ™‚æˆ‘å€‘å¯ä»¥çœ‹åˆ°ï¼Œå°‡åŸæœ¬ç³–æœæ©Ÿå…§çš„staticå…¨åŸŸè®Šæ•¸ç‹€æ…‹ï¼Œéƒ½çµ±ä¸€è®Šæˆä¸€å€‹stateè®Šæ•¸ (ç‚ºStateComponentä»‹é¢å‹æ…‹)ã€‚</p><p>é€™æ™‚æˆ‘å€‘å°±æƒ³æŠŠæ¯å€‹ç‹€æ…‹ (NoCoinStateç›®å‰æ²’æœ‰éŒ¢å¹£, HasCoinStateç›®å‰æœ‰éŒ¢å¹£, SoldCandyStateå”®å‡ºç³–æœä¸­, NoCandyStateæ²’æœ‰ç³–æœä¸­) éƒ½çµ±ä¸€è®Šæˆ <code>ConcreteState</code>é¡åˆ¥ï¼Œä¾†å¯¦ä½œ<code>StateæŠ½è±¡ä»‹é¢</code>ï¼Œä»¥åˆ©<code>Clienté¡åˆ¥</code>å¯ä»¥æŠ½æ›ç‹€æ…‹</p><p>æ¥è‘—ç›´æ¥ä¾†æ”¹é€ ç³–æœæ©Ÿï¼Œå…ˆå®šç¾©æ¯å€‹ç‹€æ…‹éƒ½æœƒæœ‰å°æ‡‰çš„æ–¹æ³•</p><p>å› ç‚ºç•¶ç³–æœæ©Ÿç‚ºæŸç¨®ç‹€æ…‹æ™‚ï¼Œè‹¥å‘¼å«å…¶å‹•ä½œï¼Œå°±æœƒå°å‡ºå°æ‡‰çš„è³‡è¨Š</p><p>é€™è£¡æˆ‘å€‘å…ˆç‚ºæ¯å€‹å‹•ä½œéƒ½å…ˆæ‹‹å‡ºä¾‹å¤–ï¼Œå› ç‚ºæœ‰äº›æ–¹æ³•æœ‰çš„ç‹€æ…‹å¯èƒ½ä¸éœ€è¦ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®šç¾©ç³–æœæ©Ÿçš„é››å½¢"><a href="#å®šç¾©ç³–æœæ©Ÿçš„é››å½¢" class="headerlink" title="å®šç¾©ç³–æœæ©Ÿçš„é››å½¢"></a>å®šç¾©ç³–æœæ©Ÿçš„é››å½¢</h3><p>ç³–æœæ©Ÿæ“æœ‰äº†å„å€‹ç‹€æ…‹çš„é¡åˆ¥ï¼Œä¸¦ä¸”æä¾›<code>getXXX()</code>æ–¹æ³•ï¼Œä¾›å…¶ä»–ç‹€æ…‹å¯ä»¥æŠ½æ›è‡ªå·±çš„ç‹€æ…‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandyMachine</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> State state;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    State noCoinState;</span><br><span class="line">    State hasCoinState;</span><br><span class="line">    State soldCandyState;</span><br><span class="line">    State noCandyState;</span><br><span class="line"></span><br><span class="line">    CandyMachine(<span class="keyword">int</span> count) &#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">        noCoinState = <span class="keyword">new</span> NoCoinState(<span class="keyword">this</span>);</span><br><span class="line">        hasCoinState = <span class="keyword">new</span> HasCoinState(<span class="keyword">this</span>);</span><br><span class="line">        soldCandyState = <span class="keyword">new</span> SoldCandyState(<span class="keyword">this</span>);</span><br><span class="line">        noCandyState = <span class="keyword">new</span> NoCandyState(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(State state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getNoCoinState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.noCoinState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getHasCoinState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.hasCoinState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getSoldCandyState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.soldCandyState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getNoCandyState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.noCandyState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯¦ä½œå„å€‹ç‹€æ…‹"><a href="#å¯¦ä½œå„å€‹ç‹€æ…‹" class="headerlink" title="å¯¦ä½œå„å€‹ç‹€æ…‹"></a>å¯¦ä½œå„å€‹ç‹€æ…‹</h3><p>æ¯å€‹ç‹€æ…‹éƒ½æœƒå¼•å…¥<code>CandyMachin</code>é¡åˆ¥ï¼Œä»¥ä¾¿èƒ½å¤ å¹«åŠ©ç³–æœæ©Ÿé€²è¡Œç‹€æ…‹è®ŠåŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoCoinState</span> <span class="keyword">extends</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    CandyMachine candyMachine;</span><br><span class="line">    NoCoinState(CandyMachine candyMachine) &#123;</span><br><span class="line">        <span class="keyword">this</span>.candyMachine = candyMachine;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æŠ•å…¥éŒ¢å¹£"</span>);</span><br><span class="line">        <span class="keyword">this</span>.candyMachine.setState(<span class="keyword">this</span>.candyMachine.getHasCoinState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ²’æœ‰éŒ¢å¹£"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HasCoinState</span> <span class="keyword">extends</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    CandyMachine candyMachine;</span><br><span class="line">    HasCoinState(CandyMachine candyMachine) &#123;</span><br><span class="line">        <span class="keyword">this</span>.candyMachine = candyMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰å·²ç¶“æœ‰éŒ¢å¹£äº†ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è½‰å‹•æ‰‹æŠŠä¸­"</span>);</span><br><span class="line">        <span class="comment">// åˆ‡æ›åˆ°ä¸‹ä¸€å€‹ç‹€æ…‹</span></span><br><span class="line">        candyMachine.setState(<span class="keyword">this</span>.candyMachine.getSoldCandyState());</span><br><span class="line">        <span class="keyword">this</span>.candyMachine.state.dispense();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ²’æœ‰éŒ¢å¹£"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoldCandyState</span> <span class="keyword">extends</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    CandyMachine candyMachine;</span><br><span class="line">    SoldCandyState(CandyMachine candyMachine) &#123;</span><br><span class="line">        <span class="keyword">this</span>.candyMachine = candyMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ­£åœ¨åç³–æœä¸­ï¼Œè«‹å‹¿æŠ•å¹£ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ­£åœ¨åç³–æœä¸­ï¼Œè«‹å‹¿è½‰å‹•ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dispense</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é–‹å§‹åç³–æœ"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šç¾©æ©Ÿç‡ï¼Œå¦‚æœæ©Ÿç‡å°æ–¼10%å°±åå‡ºå…©é¡†ç³–æœ</span></span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">if</span> (rand.nextInt(<span class="number">10</span>) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ­å–œä¸­çï¼Œç³–æœæ©Ÿåäº†äºŒé¡†ç³–æœ"</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.candyMachine.count &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="comment">// åå‡ºå…©é¡†ç³–æœ</span></span><br><span class="line">                <span class="keyword">this</span>.candyMachine.count--;</span><br><span class="line">                <span class="keyword">this</span>.candyMachine.count--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ²’ä¸­çï¼Œåªåä¸€é¡†</span></span><br><span class="line">            <span class="keyword">this</span>.candyMachine.count--;</span><br><span class="line">            <span class="comment">// æœ‰éŒ¢çš„è©±å°±åä¸€é¡†ç³–æœå‡ºä¾†</span></span><br><span class="line">            System.out.println(<span class="string">"ç³–æœæ©Ÿåäº†ä¸€é¡†ç³–æœ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.candyMachine.count == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.candyMachine.setState(<span class="keyword">this</span>.candyMachine.getNoCandyState());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.candyMachine.setState(<span class="keyword">this</span>.candyMachine.getNoCoinState());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoCandyState</span> <span class="keyword">extends</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    CandyMachine candyMachine;</span><br><span class="line">    NoCandyState(CandyMachine candyMachine) &#123;</span><br><span class="line">        <span class="keyword">this</span>.candyMachine = candyMachine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertCoin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ²’æœ‰ç³–æœï¼Œè«‹å‹¿æŠ•å¹£ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnCrank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç›®å‰æ²’æœ‰ç³–æœï¼Œè«‹å‹¿æŠ•å¹£"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ“ä½œç³–æœæ©Ÿ"><a href="#æ“ä½œç³–æœæ©Ÿ" class="headerlink" title="æ“ä½œç³–æœæ©Ÿ"></a>æ“ä½œç³–æœæ©Ÿ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CandyMachine candyMachine = <span class="keyword">new</span> CandyMachine(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•</span></span><br><span class="line">        System.out.println(<span class="string">"====å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•===="</span>);</span><br><span class="line">        candyMachine.state.insertCoin();</span><br><span class="line">        candyMachine.state.turnCrank();</span><br><span class="line">        <span class="comment">// ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•</span></span><br><span class="line">        System.out.println(<span class="string">"====ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•===="</span>);</span><br><span class="line">        candyMachine.state.turnCrank();</span><br><span class="line">        <span class="comment">// æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿç›®å‰æ²’ç³–æœäº†</span></span><br><span class="line">        System.out.println(<span class="string">"=====æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿå¯èƒ½ç›®å‰æ²’ç³–æœäº†===="</span>);</span><br><span class="line">        candyMachine.state.insertCoin();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">====å…ˆæŠ•éŒ¢ï¼Œåœ¨è½‰å‹•====</span><br><span class="line">æŠ•å…¥éŒ¢å¹£</span><br><span class="line">è½‰å‹•æ‰‹æŠŠä¸­</span><br><span class="line">é–‹å§‹åç³–æœ</span><br><span class="line">æ­å–œä¸­çï¼Œç³–æœæ©Ÿåäº†äºŒé¡†ç³–æœ</span><br><span class="line">====ä¸æŠ•éŒ¢ï¼Œç›´æ¥è½‰å‹•====</span><br><span class="line">ç›®å‰æ²’æœ‰ç³–æœï¼Œè«‹å‹¿æŠ•å¹£</span><br><span class="line">=====æŠ•éŒ¢ï¼Œä½†ç³–æœæ©Ÿç›®å‰æ²’ç³–æœäº†====</span><br><span class="line">ç›®å‰æ²’æœ‰ç³–æœï¼Œè«‹å‹¿æŠ•å¹£ï¼</span><br></pre></td></tr></table></figure><p>ç”¨é€™å¼µåœ–å¯ä»¥æ›´äº†è§£ç³–æœæ©Ÿæ˜¯å¦‚ä½•èˆ‡ç‹€æ…‹å€‘åšäº’å‹•</p><p><img src="https://i.imgur.com/MjhyGVD.png" alt=""></p><h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°å¥—ç”¨ç‹€æ…‹æ¨¡å¼å¾Œï¼Œè‹¥æœªä¾†è¦æ–°å¢ç‹€æ…‹æ™‚ï¼Œç›´æ¥å¯¦ä½œ<code>State</code>æŠ½è±¡é¡åˆ¥ï¼Œä¸¦ä¸”åªæœƒéœ€è¦æ›´å‹•åˆ°è·Ÿæ–°å¢ç‹€æ…‹é¡åˆ¥çš„ç›¸é—œé€£ç‹€æ…‹ï¼Œä½¿å¾—æˆ‘å€‘ç¨‹å¼æ›´å¥½ç¶­è­·</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€éçµ±ä¸€çš„â€ç‹€æ…‹é¡åˆ¥â€ï¼Œä¾†å®šç¾©ç‰©ä»¶çš„å…§éƒ¨ç‹€æ…‹æ˜¯å¦‚ä½•&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Composite Pattern åˆæˆæ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/08/06/Design-Pattern-Java-Composite-Pattern-%E5%90%88%E6%88%90%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/08/06/Design-Pattern-Java-Composite-Pattern-åˆæˆæ¨¡å¼/</id>
    <published>2020-08-06T13:34:16.000Z</published>
    <updated>2021-01-28T12:17:21.724Z</updated>
    
    <content type="html"><![CDATA[<p>å°‡æœ‰éšå±¤é—œä¿‚çš„é¡åˆ¥ç‹€æ…‹çµ¦æ‰å¹³åŒ–ï¼Œçµ¦ä½¿ç”¨è€…çœ‹åˆ°çš„æ˜¯ä¸€è‡´æ€§çš„é—œä¿‚</p><a id="more"></a><h2 id="è‹¥æ²’æœ‰åˆæˆæ¨¡å¼æœƒæ€æ¨£ï¼Ÿ"><a href="#è‹¥æ²’æœ‰åˆæˆæ¨¡å¼æœƒæ€æ¨£ï¼Ÿ" class="headerlink" title="è‹¥æ²’æœ‰åˆæˆæ¨¡å¼æœƒæ€æ¨£ï¼Ÿ"></a>è‹¥æ²’æœ‰åˆæˆæ¨¡å¼æœƒæ€æ¨£ï¼Ÿ</h2><p>å‡å¦‚ç¾åœ¨æˆ‘å€‘ä¾†åˆ°ä¸€é–“è‡ªåŠ©å§ï¼Œæœ‰ä¸€å€‹èœå–®é¡åˆ¥ï¼Œä½†é€™å€‹èœå–®é¡åˆ¥è£¡é¢é‚„æœƒæœ‰ç”œé»é€™å€‹å­èœå–®</p><p>å¤§æ¦‚é•·ä¸‹é¢é€™æ¨£</p><p><img src="https://i.imgur.com/iLWjwr3.png" alt=""></p><p>æ–¼æ˜¯æˆ‘å€‘å¤§æ¦‚æœƒé€™æ¨£å¯¦ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuffetMenu</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    ArrayList&lt;String&gt; items;</span><br><span class="line">    DessertMenu dessertMenu;</span><br><span class="line"></span><br><span class="line">    BuffetMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"è‡ªåŠ©é¤èœå–®"</span>;</span><br><span class="line">        <span class="keyword">this</span>.items = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.dessertMenu = <span class="keyword">new</span> DessertMenu();</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–é …ç›®</span></span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"ç‰›è‚‰éºµ"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"æµ·é®®é£¯"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"ç‰›æ’"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.items.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(String item: items) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">":"</span> + item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é–‹å§‹ä»‹ç´¹"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">        showMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DessertMenu</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    ArrayList&lt;String&gt; items;</span><br><span class="line">    ChocolateMenu chocolateMenu;</span><br><span class="line"></span><br><span class="line">    DessertMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"ç”œé»èœå–®"</span>;</span><br><span class="line">        <span class="keyword">this</span>.items = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"é›è›‹é¤…ä¹¾"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"å·§å…‹åŠ›"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"æ£‰èŠ±ç³–"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(String item: items) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">":"</span> + item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é–‹å§‹ä»‹ç´¹"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">        showMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°DessertMenué¡åˆ¥åŒ…å«åœ¨BuffetMenué¡åˆ¥äº†</p><p>æˆ‘å€‘ç¾åœ¨æœ‰ä½æœå‹™ç”Ÿæä¾›ä»‹ç´¹èœå–®å…§å®¹ï¼Œå®šç¾©å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waitress</span> </span>&#123;</span><br><span class="line">    BuffetMenu buffetMenu;</span><br><span class="line"></span><br><span class="line">    Waitress(BuffetMenu buffetMenu) &#123;</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu = buffetMenu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">introduceMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä»‹ç´¹èœå–®</span></span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.print();</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.showMenuItem();</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.dessertMenu.print();</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.dessertMenu.showMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶å¾Œæˆ‘å€‘è«‹æœå‹™ç”Ÿé–‹å§‹ä»‹ç´¹èœå–®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuffetMenu buffetMenu = <span class="keyword">new</span> BuffetMenu();</span><br><span class="line">        Waitress waitress = <span class="keyword">new</span> Waitress(buffetMenu);</span><br><span class="line"></span><br><span class="line">        waitress.introduceMenu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é–‹å§‹ä»‹ç´¹è‡ªåŠ©é¤èœå–®</span><br><span class="line">è‡ªåŠ©é¤èœå–®:ç‰›è‚‰éºµ</span><br><span class="line">è‡ªåŠ©é¤èœå–®:æµ·é®®é£¯</span><br><span class="line">è‡ªåŠ©é¤èœå–®:ç‰›æ’</span><br><span class="line">é–‹å§‹ä»‹ç´¹ç”œé»èœå–®</span><br><span class="line">ç”œé»èœå–®:é›è›‹é¤…ä¹¾</span><br><span class="line">ç”œé»èœå–®:æ£‰èŠ±ç³–</span><br><span class="line">ç”œé»èœå–®:å·§å…‹åŠ›</span><br></pre></td></tr></table></figure><p>ä½†å‡å¦‚ç¾åœ¨è®Šæˆé€™æ¨£å‘¢ï¼šç”œé»å…§çš„å·§å…‹åŠ›åˆæœ‰ä¸åŒé¡å‹çš„å·§å…‹åŠ›ï¼Œé‚£æˆ‘å€‘åˆè¦å†ä¿®æ”¹ä¸Šé¢çš„ç¨‹å¼ç¢¼ï¼Œå°‡Chocolateé¡åˆ¥åŠ å…¥åˆ°Desserté¡åˆ¥å…§</p><p><img src="https://i.imgur.com/otznRfN.png" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DessertMenu</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    ArrayList&lt;String&gt; items;</span><br><span class="line">    ChocolateMenu chocolateMenu; <span class="comment">// å¤šäº†å·§å…‹åŠ›èœå–®</span></span><br><span class="line"></span><br><span class="line">    DessertMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.chocolateMenu = <span class="keyword">new</span> ChocolateMenu();</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"ç”œé»èœå–®"</span>;</span><br><span class="line">        <span class="keyword">this</span>.items = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"é›è›‹é¤…ä¹¾"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"æ£‰èŠ±ç³–"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(String item: items) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">":"</span> + item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é–‹å§‹ä»‹ç´¹"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šäº†å·§å…‹åŠ›èœå–®</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChocolateMenu</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    ArrayList&lt;String&gt; items;</span><br><span class="line"></span><br><span class="line">    ChocolateMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"å·§å…‹åŠ›èœå–®"</span>;</span><br><span class="line">        items = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"ç™½å·§å…‹åŠ›"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"é»‘å·§å…‹åŠ›"</span>);</span><br><span class="line">        <span class="keyword">this</span>.items.add(<span class="string">"é…’é‡€å·§å…‹åŠ›"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.items.add(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(String item: items) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.name + <span class="string">":"</span> + item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é–‹å§‹ä»‹ç´¹"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™æ™‚è¦ä¿®æ”¹æœå‹™ç”Ÿçš„è…¦è¢‹ï¼Œä½¿å…¶çŸ¥é“å·§å…‹åŠ›èœå–®çš„å…§å®¹ã€‚ã€‚ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waitress</span> </span>&#123;</span><br><span class="line">    BuffetMenu buffetMenu;</span><br><span class="line"></span><br><span class="line">    Waitress(BuffetMenu buffetMenu) &#123;</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu = buffetMenu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">introduceMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä»‹ç´¹èœå–®</span></span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.print();</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.dessertMenu.print();</span><br><span class="line">        <span class="keyword">this</span>.buffetMenu.dessertMenu.chocolateMenu.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†é€™æ™‚å€™å°±æœƒç™¼ç¾ï¼Œæ¯æ¬¡è‹¥æ–°å¢ä¸€å€‹å­èœå–®æ™‚ï¼Œå‘¼å«è€…å°±éœ€è¦ç›´æ¥å°å…¶æ“ä½œï¼Œæ‰èƒ½å¤ å°å‡ºè©²å­èœå–®çš„é …ç›®åˆ—è¡¨</p><p>ä¸€ä½†å­èœå–®å…§åˆæœ‰å­èœå–®ï¼Œé‚£æ•´å€‹ç¨‹å¼ç¢¼çš„ç¶­è­·çš„ä»£åƒ¹å°±æœƒéå¸¸çš„é«˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥çœ‹åˆ°å­èœå–®å…§è‹¥åˆæœ‰å­èœå–®ï¼Œè¦å°å‡ºè©²åç¨±çš„è©±ï¼Œé‚£é€™è¡Œç¨‹å¼ç¢¼æœƒè¶Šä¾†è¶Šé•·ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">this.buffetMenu.dessertMenu.chocolateMenu.print();</span><br></pre></td></tr></table></figure><h3 id="ç¶­è­·ä¿®æ”¹çš„ä»£åƒ¹"><a href="#ç¶­è­·ä¿®æ”¹çš„ä»£åƒ¹" class="headerlink" title="ç¶­è­·ä¿®æ”¹çš„ä»£åƒ¹"></a>ç¶­è­·ä¿®æ”¹çš„ä»£åƒ¹</h3><p>èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å€‘æƒ³è¦å«æœå‹™ç”Ÿèªªæ˜ï¼Œå“ªäº›èœ/ç”œé»æ˜¯ç´ é£Ÿçš„ï¼Œé€™æ™‚æœƒæ”¹codeæ”¹åˆ°æƒ³å“­</p><h2 id="è§£æ±ºæœå‹™ç”Ÿä¸ç”¨ç¬¨æ‹™åœ°å­˜å–èœå–®èˆ‡å…¶å­èœå–®å€‘ï¼šåˆæˆæ¨¡å¼ç™»å ´"><a href="#è§£æ±ºæœå‹™ç”Ÿä¸ç”¨ç¬¨æ‹™åœ°å­˜å–èœå–®èˆ‡å…¶å­èœå–®å€‘ï¼šåˆæˆæ¨¡å¼ç™»å ´" class="headerlink" title="è§£æ±ºæœå‹™ç”Ÿä¸ç”¨ç¬¨æ‹™åœ°å­˜å–èœå–®èˆ‡å…¶å­èœå–®å€‘ï¼šåˆæˆæ¨¡å¼ç™»å ´"></a>è§£æ±ºæœå‹™ç”Ÿä¸ç”¨ç¬¨æ‹™åœ°å­˜å–èœå–®èˆ‡å…¶å­èœå–®å€‘ï¼šåˆæˆæ¨¡å¼ç™»å ´</h2><p>åˆæˆæ¨¡å¼ä¸»è¦å¹«æˆ‘å€‘å»ºç«‹ä¸€å€‹é¡åˆ¥é—œä¿‚ï¼Œå»ºç«‹èµ·çˆ¶é¡åˆ¥èˆ‡å­é¡åˆ¥çš„éšå±¤é—œä¿‚ï¼Œä¸¦è®“å®¢æˆ¶ç«¯ä»¥ä¸€è‡´çš„æ–¹å¼å­˜å–æ¨¹ç‹€çµæ§‹å…§çš„å„å€‹é¡åˆ¥</p><p>å…ˆè¬›çµè«–ï¼Œä»¥ä¸Šçš„èœå–®å€‘ï¼Œå¥—ç”¨åˆæˆæ¨¡å¼å¾Œï¼Œæœå‹™ç”Ÿä¸ç”¨é€éä»¥ä¸‹æ–¹å¼å­˜å–å­èœå–®ä¸¦ä»‹ç´¹å‡ºä¾†äº†ï¼Œè€Œæ˜¯ç›´æ¥å¯ä»¥ç”¨ä¸€è‡´çš„æ–¹å¼å°‡æ‰€æœ‰èœå–®èˆ‡å­èœå–®éƒ½å‘¼å«å‡ºä¾†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public void introduceMenu() &#123;</span><br><span class="line">       // ä»‹ç´¹èœå–® &lt;-- å¯ä»¥ä¸ç”¨ä¸€ä¸€åœ¨å‘¼å«èœå–®èˆ‡å­èœå–®å’Œå­èœå–®çš„å­èœå–®ã€‚ã€‚ã€‚</span><br><span class="line">       public void introduceMenu() &#123;</span><br><span class="line">       // ä»‹ç´¹èœå–®</span><br><span class="line">       this.buffetMenu.print();</span><br><span class="line">       this.buffetMenu.showMenuItem();</span><br><span class="line">       this.buffetMenu.dessertMenu.print();</span><br><span class="line">       this.buffetMenu.dessertMenu.showMenuItem();</span><br><span class="line">       this.buffetMenu.dessertMenu.chocolateMenu.print();</span><br><span class="line">       this.buffetMenu.dessertMenu.chocolateMenu.showMenuItem();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p><p>é€™æ™‚æˆ‘å€‘å…ˆä¾†çœ‹ åˆæˆæ¨¡å¼ çš„é¡åˆ¥é—œä¿‚åœ–</p><p><img src="https://i.imgur.com/a4ZZBAI.png" alt=""></p><ul><li>Componenté¡åˆ¥ï¼šå®šç¾©äº†å…¶æ‰€æœ‰åº•ä¸‹è‘‰ç¯€é»èˆ‡åˆæˆé¡åˆ¥çš„çµæ§‹<ul><li>æ‰€æœ‰çš„Leafç¯€é»èˆ‡Compositeç¯€é»éƒ½æœƒç¹¼æ‰¿(å¯¦ä½œ)è©²Componenté¡åˆ¥</li><li>Componentæ˜¯è€å¤§å“¥ï¼Œè€å¤§å“¥æœƒçš„ä¸‹é¢çš„ä¹Ÿæœƒå­¸åˆ°</li></ul></li><li>Leafé¡åˆ¥ï¼šæœƒå¯¦ä½œComponenté¡åˆ¥ï¼Œä½†ç”±æ–¼Leafç¯€é»æ²’æœ‰å­é¡åˆ¥ï¼Œæ‰€ä»¥åªæœƒæœ‰operation()çš„æ–¹æ³•ä¾›å‘¼å«</li><li>Compositeé¡åˆ¥ï¼šåˆæˆé¡åˆ¥ï¼Œå°‡ä»¥ä¸‹å…©é»åšåˆæˆ<ul><li>æ‰€è¦åŸ·è¡Œçš„åŠŸèƒ½<code>operation()</code></li><li>ç®¡ç†å­é¡åˆ¥çš„æ–¹æ³• <code>add()</code> <code>remove()</code> <code>getChild()</code></li></ul></li></ul><p>å°æ‡‰Compositeé¡åˆ¥é—œä¿‚åœ–åˆ°æˆ‘å€‘ä¸Šè¿°æ‰€ç•«çš„èœå–®é—œä¿‚åœ–ï¼Œå°±æœƒé•·å¾—å¦‚ä¸‹ï¼š</p><p><img src="https://i.imgur.com/g5tB4GT.png" alt=""></p><p>æŠŠä¸Šé¢æ‰€æåˆ°çš„é€™å¼µåœ–ä½œè½‰æ›</p><p><img src="https://i.imgur.com/otznRfN.png" alt=""></p><p>å°±æœƒè®Šæˆé€™æ¨£å­ (çœç•¥Chocolateé¡åˆ¥çš„èœå–®é …ç›®)</p><p><img src="https://i.imgur.com/Rez9N4I.png" alt=""></p><h3 id="å®šç¾©MenuComponentæŠ½è±¡é¡åˆ¥"><a href="#å®šç¾©MenuComponentæŠ½è±¡é¡åˆ¥" class="headerlink" title="å®šç¾©MenuComponentæŠ½è±¡é¡åˆ¥"></a>å®šç¾©MenuComponentæŠ½è±¡é¡åˆ¥</h3><p>å®šç¾©MenuComponent, æä¾›èœå–®åŸºæœ¬çš„æ–¹æ³•</p><p>é€™é‚Šä¸»è¦ä¸æ˜¯å®šç¾©æˆInterface, è€Œæ˜¯æŠ½è±¡é¡åˆ¥çš„ä¸»è¦åŸå› æ˜¯å› ç‚ºï¼Œæˆ‘å€‘æœƒçµ¦ å­èœå–®å»ç¹¼æ‰¿èœå–®æ‰€å…·æœ‰çš„æ–¹æ³•</p><p>ä½†åˆå› æœƒçµ¦èœå–®é …ç›®(MenuItem)ç¹¼æ‰¿(å¦‚ ç‰›è‚‰éºµ, æµ·é®®é£¯, ç‰›æ’)ï¼Œ<br>ä½†èœå–®é …ç›®ä¸éœ€è¦åƒæ˜¯ <code>add()</code>, <code>remove()</code>ç­‰æ–¹æ³•ï¼Œæ‰€ä»¥æœƒåœ¨è©²æ–¹æ³•å…§å…ˆæ‹‹å‡º <code>UnsupportedOperationException()</code></p><h4 id="Menu-java"><a href="#Menu-java" class="headerlink" title="Menu.java"></a>Menu.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isVegetarian</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘å®šç¾©äº†ä»¥ä¸‹æ–¹æ³•ï¼Œä¸¦ç­‰å¾…çœŸæ­£çš„èœå–®é¡åˆ¥ä¾†å¯¦ä½œå…¶ç´°ç¯€</p><ul><li>add(): å¯æ–°å¢ å¯¦ä½œMenuComponentçš„ç‰©ä»¶</li><li>remove(): ç§»é™¤ å¯¦ä½œMenuComponentçš„ç‰©ä»¶</li><li>getChild(): å–å¾—Menuå…§çš„èœå–®é …ç›®/å­èœå–®</li><li>getName(): å–å¾—èœå–®åç¨±</li><li>getPrice: å–å¾—èœå–®é …ç›®åƒ¹æ ¼</li><li>isVegetarian(): ç¢ºèªæ˜¯å¦ç‚ºç´ é£Ÿ</li><li>print(): å°å‡ºè‡ªå·±çš„æ‰€æœ‰èœå–®é …ç›®/å­èœå–®å…§å®¹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">é‚„è¨˜å¾—æœ€ä¸Šé¢çš„è‹¥è¦è«‹æœå‹™ç”Ÿç¢ºèªèœè‰²æ˜¯å¦æ˜¯ç´ é£Ÿï¼Œä½†è¦åˆ°è™•ä¿®æ”¹çš„æ…˜ç—›çš„ç¶“é©—å—ï¼Ÿ</span><br><span class="line"></span><br><span class="line">é€™æ™‚å€™è‹¥åœ¨å…±é€šçš„ä»‹é¢ï¼Œå®šç¾©å¥½ä¸€å€‹isVegetarian(), è«‹èœè‰²è‡ªè¡Œæä¾›æ˜¯å¦æ˜¯ç´ é£Ÿï¼Œæ˜¯çš„è©±å›å‚³true, ä¸æ˜¯å°±å›å‚³false, å¦‚æ­¤ä¸€ä¾†æœå‹™ç”Ÿå°±å¯ä»¥åœ¨å‘¼å«print()æ™‚ï¼Œå¯ä»¥ç›´æ¥åˆ¤æ–·é€™é“é …ç›®æ˜¯å¦æ˜¯ç´ é£Ÿå›‰</span><br><span class="line"></span><br><span class="line">é—œæ–¼print()çš„å¯¦ç¾ç´°ç¯€å¾Œé¢æœƒä»‹ç´¹</span><br></pre></td></tr></table></figure><h3 id="é–‹å§‹å¯¦ä½œèœå–®å…ƒä»¶ï¼šå®šç¾©è‡ªåŠ©å¼èœå–®"><a href="#é–‹å§‹å¯¦ä½œèœå–®å…ƒä»¶ï¼šå®šç¾©è‡ªåŠ©å¼èœå–®" class="headerlink" title="é–‹å§‹å¯¦ä½œèœå–®å…ƒä»¶ï¼šå®šç¾©è‡ªåŠ©å¼èœå–®"></a>é–‹å§‹å¯¦ä½œèœå–®å…ƒä»¶ï¼šå®šç¾©è‡ªåŠ©å¼èœå–®</h3><p>æ¥è‘—é–‹å§‹å¯¦ä½œè‡ªåŠ©é¤çš„å®Œæ•´èœå–®å§ï¼</p><p>BuffetMenu.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuffetMenu</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®£å‘Šè¦æ”¾ç½®èœå–®é …ç›®èˆ‡å­èœå–®çš„ArrayList</span></span><br><span class="line">    ArrayList&lt;MenuComponent&gt; menuItems = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// èœå–®åç¨±</span></span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    BuffetMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"è‡ªåŠ©å¼èœå–®"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menuItems.add(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menuItems.remove(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.menuItems.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"è‡ªåŠ©å¼èœå–®æä¾›äº†ä¸»èœå€‘(ç‰›è‚‰éºµ, æµ·é®®é£¯, ç‰›æ’), ä»¥åŠç”œé»èœå–®, è«‹ç›¡æƒ…äº«ç”¨ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ç”¨å¯¦ä½œgetPrice å› ç‚ºèœå–®æ²’æœ‰åƒ¹æ ¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ç”¨å¯¦ä½œisVegetarian å› ç‚ºèœå–®æ²’æœ‰åƒ¹æ ¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯èœå–®çš„è©±, printä½¿ç”¨iterator, å°‡ArrayListå‹æ…‹çš„menusä¸­çš„menuComponentä¸€ä¸€å–å‡ºä¾†, ä¸¦å‘¼å«</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getName());</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getDescription());</span><br><span class="line"></span><br><span class="line">        Iterator iterator = menuItems.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(iterator.hasNext()) &#123;</span><br><span class="line">            <span class="comment">// å–å‡ºä¾†çš„å¯èƒ½æ˜¯èœå–®é …ç›®, ä¹Ÿå¯èƒ½æ˜¯å­èœå–®</span></span><br><span class="line">            MenuComponent menuComponent = (MenuComponent)iterator.next();</span><br><span class="line">            menuComponent.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨BuffetMenuä¸­ï¼Œå·²ç¶“é™¤äº† <code>getPrice()</code>å’Œ<code>isVegetarian()</code>é€™å…©é …èœå–®ä¸ç”¨å»å¯¦ä½œï¼Œå…¶ä»–éƒ½æœ‰å®šç¾©é‚è¼¯</p><p>é€™é‚Šè¦æ³¨æ„çš„æ˜¯ <code>print()</code> æˆ‘å€‘ä½¿ç”¨ iterator, å°‡èœå–®å…§çš„<code>MenuComponent</code>ä¸€ä¸€å–å‡ºä¾†ï¼Œä¸¦ä¸”åœ¨å‘¼å«å…¶<code>print()</code>, ä¾åºå°è‡ªåŠ©å¼èœå–®å…§çš„èœå–®é …ç›®åšä»‹ç´¹é€™æ¨£</p><h3 id="å®šç¾©èœå–®é …ç›®"><a href="#å®šç¾©èœå–®é …ç›®" class="headerlink" title="å®šç¾©èœå–®é …ç›®"></a>å®šç¾©èœå–®é …ç›®</h3><p>æ¥è‘—æˆ‘å€‘å®šç¾©ä¸€å€‹ç‰›è‚‰éºµé¡åˆ¥ <code>BeefNoodles</code>, å¯¦ä½œ <code>MenuComponent</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BeefNoodles</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line">    <span class="comment">// èœå–®åç¨±</span></span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"å¥½åƒçš„ç‰›è‚‰éºµ, é“åœ°çš„å››å·å£å‘³ï½ï½"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">120</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isVegetarian</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// ç‰›è‚‰éºµä¸æ˜¯ç´ é£Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸æ˜¯èœå–®, æ‰€ä»¥åªè¦å‘¼å«åç¨±èˆ‡æè¿°å°±å¥½</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getName());</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getDescription());</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getPrice());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ–¼ç‰›è‚‰éºµæ˜¯èœå–®çš„é …ç›®ï¼Œæ‰€ä»¥åªè¦å¯¦ä½œè·Ÿä»–è‡ªå·±æœ‰é—œçš„æ–¹æ³•å°±å¥½ï¼Œåœ¨<code>print()</code>ä¹Ÿåªè¦å°±å°å‡ºè‡ªå·±åç¨±æ˜¯ä»€éº¼ï¼Œä»¥åŠæè¿°, åƒ¹æ ¼ã€‚</p><h3 id="å¯¦ä½œå­èœå–®-ç”œé»èœå–®"><a href="#å¯¦ä½œå­èœå–®-ç”œé»èœå–®" class="headerlink" title="å¯¦ä½œå­èœå–®: ç”œé»èœå–®"></a>å¯¦ä½œå­èœå–®: ç”œé»èœå–®</h3><p>è·Ÿå‰›å‰›å¯¦ä½œè‡ªåŠ©é¤çš„ç´°ç¯€éå¸¸é¡ä¼¼</p><p>DessertMenu.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DessertMenu</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®£å‘Šè¦æ”¾ç½®èœå–®é …ç›®èˆ‡å­èœå–®çš„ArrayList</span></span><br><span class="line">    ArrayList&lt;MenuComponent&gt; menuItems = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// èœå–®åç¨±</span></span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    DessertMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">"ç”œé»èœå–®"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menuItems.add(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menuItems.remove(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.menuItems.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ç”œé»èœå–®æä¾›äº†ä¸€æ˜Ÿç±³å…¶æ—ä¸»å»šæ‰€è£½ä½œçš„ç”œé»å€‘ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ç”¨å¯¦ä½œgetPrice å› ç‚ºèœå–®æ²’æœ‰åƒ¹æ ¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ç”¨å¯¦ä½œisVegetarian å› ç‚ºèœå–®æ²’æœ‰åƒ¹æ ¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯èœå–®çš„è©±, printä½¿ç”¨iterator, å°‡ArrayListå‹æ…‹çš„menusä¸­çš„menuComponentä¸€ä¸€å–å‡ºä¾†, ä¸¦å‘¼å«</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getName());</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.getDescription());</span><br><span class="line"></span><br><span class="line">        Iterator iterator = menuItems.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(iterator.hasNext()) &#123;</span><br><span class="line">            <span class="comment">// å–å‡ºä¾†çš„å¯èƒ½æ˜¯èœå–®é …ç›®, ä¹Ÿå¯èƒ½æ˜¯å­èœå–®</span></span><br><span class="line">            MenuComponent menuComponent = (MenuComponent)iterator.next();</span><br><span class="line">            menuComponent.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€å¾Œä¹Ÿæ˜¯ä¸€æ¨£ï¼Œå°‡ç”œé»é …ç›®éƒ½å¯¦ä½œä¸€è¼ªï¼Œä¸éé€™é‚Šéƒ½å¾ˆé¡ä¼¼å°±ä¸æ•˜è¿°äº†</p><h3 id="é‡æ–°å®šç¾©æœå‹™ç”Ÿ"><a href="#é‡æ–°å®šç¾©æœå‹™ç”Ÿ" class="headerlink" title="é‡æ–°å®šç¾©æœå‹™ç”Ÿ"></a>é‡æ–°å®šç¾©æœå‹™ç”Ÿ</h3><p>å¯ä»¥çœ‹åˆ°æœå‹™ç”Ÿå¾ˆå¿«æ¨‚, åªè¦å‘¼å«MenuComponentçš„<code>print()</code>, å°±æŠŠæ‰€æœ‰èœå–®éƒ½ä»‹ç´¹å‡ºä¾†å›‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waitress</span> </span>&#123;</span><br><span class="line">    MenuComponent menuComponent;</span><br><span class="line"></span><br><span class="line">    Waitress(MenuComponent menuComponent) &#123;</span><br><span class="line">        <span class="keyword">this</span>.menuComponent = menuComponent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">introduceMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// é€™æ™‚åªè¦å‘¼å«print(), å°±å¯ä»¥æŠŠå…¨éƒ¨èœå–®çš„é …ç›®èˆ‡åç¨±éƒ½ä»‹ç´¹å‡ºä¾†äº†ï¼</span></span><br><span class="line">        <span class="keyword">this</span>.menuComponent.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®¢æˆ¶é–‹å§‹é€²ä¾†ï¼Œè«‹æœå‹™ç”Ÿä»‹ç´¹"><a href="#å®¢æˆ¶é–‹å§‹é€²ä¾†ï¼Œè«‹æœå‹™ç”Ÿä»‹ç´¹" class="headerlink" title="å®¢æˆ¶é–‹å§‹é€²ä¾†ï¼Œè«‹æœå‹™ç”Ÿä»‹ç´¹"></a>å®¢æˆ¶é–‹å§‹é€²ä¾†ï¼Œè«‹æœå‹™ç”Ÿä»‹ç´¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MenuComponent buffetMenu = <span class="keyword">new</span> BuffetMenu();</span><br><span class="line">        MenuComponent beefNoodles = <span class="keyword">new</span> BeefNoodles();</span><br><span class="line">        MenuComponent seaRice = <span class="keyword">new</span> SeaRice();</span><br><span class="line">        MenuComponent steak = <span class="keyword">new</span> Steak();</span><br><span class="line">        buffetMenu.add(beefNoodles);</span><br><span class="line">        buffetMenu.add(seaRice);</span><br><span class="line">        buffetMenu.add(steak);</span><br><span class="line">        <span class="comment">// å®šç¾©å­èœå–®</span></span><br><span class="line">        MenuComponent dessertMenu = <span class="keyword">new</span> DessertMenu();</span><br><span class="line">        MenuComponent eggCookie = <span class="keyword">new</span> EggCookie();</span><br><span class="line">        MenuComponent cottonCandy = <span class="keyword">new</span> CottonCandy();</span><br><span class="line">        dessertMenu.add(eggCookie);</span><br><span class="line">        dessertMenu.add(cottonCandy);</span><br><span class="line">        <span class="comment">// å°‡å­èœå–®åŠ å…¥è‡ªåŠ©å¼èœå–®</span></span><br><span class="line">        buffetMenu.add(dessertMenu);</span><br><span class="line"></span><br><span class="line">        Waitress waitress = <span class="keyword">new</span> Waitress(buffetMenu);</span><br><span class="line">        <span class="comment">// è«‹æœå‹™ç”Ÿé–‹å§‹ä»‹ç´¹ï¼</span></span><br><span class="line">        waitress.introduceMenu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">è‡ªåŠ©å¼èœå–®</span><br><span class="line">è‡ªåŠ©å¼èœå–®æä¾›äº†ä¸»èœå€‘(ç‰›è‚‰éºµ, æµ·é®®é£¯, ç‰›æ’), ä»¥åŠç”œé»èœå–®, è«‹ç›¡æƒ…äº«ç”¨ï¼</span><br><span class="line">ç‰›è‚‰éºµ</span><br><span class="line">å¥½åƒçš„ç‰›è‚‰éºµ, é“åœ°çš„å››å·å£å‘³ï½ï½</span><br><span class="line">120.0</span><br><span class="line">æµ·é®®é£¯</span><br><span class="line">å¥½åƒçš„æµ·é®®é£¯ï½ï½</span><br><span class="line">200.0</span><br><span class="line">ç‰›æ’</span><br><span class="line">å¥½åƒçš„ç‰›æ’ï½ï½</span><br><span class="line">400.0</span><br><span class="line">ç”œé»èœå–®</span><br><span class="line">ç”œé»èœå–®æä¾›äº†ä¸€æ˜Ÿç±³å…¶æ—ä¸»å»šæ‰€è£½ä½œçš„ç”œé»å€‘ï¼</span><br><span class="line">é›è›‹é¤…ä¹¾</span><br><span class="line">é›è›‹å£å‘³çš„é¤…å–®, å¤§äººå°å­©éƒ½æ„›ï½ï½</span><br><span class="line">60.0</span><br><span class="line">æ£‰èŠ±ç³–</span><br><span class="line">æ£‰èŠ±ç³–å¥½æ»‹å‘³ï½ï½</span><br><span class="line">30.0</span><br></pre></td></tr></table></figure><h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>é€éåˆæˆæ¨¡å¼, å°‡å–å¾—èœå–®èˆ‡å­èœå–®çš„å‹•ä½œçµ¦ä¸€è‡´åŒ–äº†</p><p>æœå‹™ç”Ÿåªè¦å‘¼å«å¯¦ä½œMenuComponentçš„èœå–®èˆ‡å­èœå–®å€‘, å°±å¯ä»¥ä¸€å£æ°£å°‡æ‰€æœ‰èœå–®èˆ‡å­èœå–®çš„é …ç›®å€‘å…¨éƒ½ä»‹ç´¹å‡ºä¾†ï¼</p><p>æœªä¾†è‹¥è¦æ“´å……å­èœå–®çš„é …ç›®ï¼Œä¹Ÿä¸ç”¨æ“”å¿ƒéœ€è¦å†ä¿®æ”¹æœå‹™ç”Ÿçš„é¡åˆ¥ï¼Œåªè¦æ–°çš„èœå–®æœ‰å¯¦ä½œMenuComponentå°±å¥½</p><p>é”åˆ° â€œå°ä¿®æ”¹é—œé–‰, å°æ“´å……é–‹æ”¾â€çš„åŸå‰‡ï¼</p><h2 id="å°‡æ¯å€‹èœå–®çš„Iteratorçµ¦åˆä½µèµ·ä¾†-IteratorComposite"><a href="#å°‡æ¯å€‹èœå–®çš„Iteratorçµ¦åˆä½µèµ·ä¾†-IteratorComposite" class="headerlink" title="å°‡æ¯å€‹èœå–®çš„Iteratorçµ¦åˆä½µèµ·ä¾†: IteratorComposite"></a>å°‡æ¯å€‹èœå–®çš„Iteratorçµ¦åˆä½µèµ·ä¾†: IteratorComposite</h2><p>é‚„è¨˜å¾—å‰›å‰›æœ‰æåˆ°å¦‚ä½•åˆ¤æ–·è©²èœå–®æ˜¯å¦æ˜¯ç´ é£Ÿçš„æƒ…æ³å‘¢ï¼Ÿï¼Ÿ</p><p>(å¾…çºŒ)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°‡æœ‰éšå±¤é—œä¿‚çš„é¡åˆ¥ç‹€æ…‹çµ¦æ‰å¹³åŒ–ï¼Œçµ¦ä½¿ç”¨è€…çœ‹åˆ°çš„æ˜¯ä¸€è‡´æ€§çš„é—œä¿‚&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Iterator Pattern åè¦†å™¨æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/08/03/Design-Pattern-Java-Iterator-Pattern-%E5%8F%8D%E8%A6%86%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/08/03/Design-Pattern-Java-Iterator-Pattern-åè¦†å™¨æ¨¡å¼/</id>
    <published>2020-08-03T15:50:41.000Z</published>
    <updated>2021-02-07T14:33:41.544Z</updated>
    
    <content type="html"><![CDATA[<p>å°‡è™•ç†é™£åˆ—æˆ–æ˜¯å–å€¼æ–¹å¼çš„é‚è¼¯çµ¦å°è£èµ·ä¾†ï¼Œä¸éœ€è®“ä½¿ç”¨è€…ç›´æ¥è™•ç†æ“ä½œå–å€¼çš„é‚è¼¯</p><a id="more"></a><h2 id="æ²’æœ‰Iterator-Patternçš„æƒ…æ³"><a href="#æ²’æœ‰Iterator-Patternçš„æƒ…æ³" class="headerlink" title="æ²’æœ‰Iterator Patternçš„æƒ…æ³"></a>æ²’æœ‰Iterator Patternçš„æƒ…æ³</h2><p>å‡è¨­ç¾åœ¨æœ‰2ç¨®èœå–®, åˆ†åˆ¥å«åšä¸­å¼æ–™ç†èœå–® èˆ‡ è¥¿å¼æ–™ç†èœå–®</p><p>ä¸­å¼æ–™ç†èœå–®æ˜¯ç”¨ArrayListçš„æ–¹å¼å„²å­˜èœå–®é …ç›®</p><p>ç¾å¼æ–™ç†èœå–®æ˜¯ç”¨Array[]å„²å­˜</p><p>ä¸­å¼æ–™ç†èœå–®<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChineseMenu</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; menu;</span><br><span class="line"></span><br><span class="line">    ChineseMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.setMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.menu.add(<span class="string">"éº»å©†è±†è…"</span>);</span><br><span class="line">        <span class="keyword">this</span>.menu.add(<span class="string">"è±¬è¡€ç³•"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">getMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> menu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç¾å¼æ–™ç†èœå–®<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AmericanMenu</span> </span>&#123;</span><br><span class="line">    String[] menu;</span><br><span class="line"></span><br><span class="line">    AmericanMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = <span class="keyword">new</span> String[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">this</span>.setMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">0</span>] = <span class="string">"æ¼¢å ¡"</span>;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">1</span>] = <span class="string">"è–¯æ¢"</span>;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">2</span>] = <span class="string">"ç‚¸é›"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getMenu() &#123;</span><br><span class="line">        <span class="keyword">return</span> menu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥è‘—å®šç¾©ä¸€å€‹é¡åˆ¥ï¼šæœå‹™ç”Ÿï¼Œä½†æœå‹™ç”Ÿéœ€è¦çŸ¥é“è¦æ€éº¼æ’ˆå…§å®¹, ArrayListèˆ‡Arrayçš„æ’ˆæ³•å°±æœƒä¸ä¸€æ¨£ï¼Œè¦å¯«å…©å€‹for loopâ€¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waitress</span> </span>&#123;</span><br><span class="line">    ChineseMenu chineseMenu;</span><br><span class="line">    AmericanMenu americaMenu;</span><br><span class="line"></span><br><span class="line">    Waitress(</span><br><span class="line">        ChineseMenu chMenu,</span><br><span class="line">        AmericanMenu amerMenu</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">this</span>.chineseMenu = chMenu;</span><br><span class="line">        <span class="keyword">this</span>.americaMenu = amerMenu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€™æ™‚å€™æœå‹™ç”Ÿéœ€è¦é‡å°å„å€‹menuåšèœè‰²ä»‹ç´¹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">introduceMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======ä»‹ç´¹ä¸­å¼æ–™ç†========"</span>);</span><br><span class="line">        <span class="keyword">for</span>(String dish: chineseMenu.getMenu()) &#123;</span><br><span class="line">            System.out.println(dish);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"=======ä»‹ç´¹ç¾å¼å¼æ–™ç†========"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;americaMenu.getMenu().length; i++) &#123;</span><br><span class="line">            System.out.println(americaMenu.menu[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—å‘¼å«æœå‹™ç”Ÿï¼Œä»‹ç´¹èœå–®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ChineseMenu chineseMenu = <span class="keyword">new</span> ChineseMenu();</span><br><span class="line">        AmericanMenu americanMenu = <span class="keyword">new</span> AmericanMenu();</span><br><span class="line">        Waitress waitress = <span class="keyword">new</span> Waitress(chineseMenu, americanMenu);</span><br><span class="line">        waitress.introduceMenu();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=======ä»‹ç´¹ä¸­å¼æ–™ç†========</span><br><span class="line">éº»å©†è±†è…</span><br><span class="line">è±¬è¡€ç³•</span><br><span class="line">=======ä»‹ç´¹ç¾å¼å¼æ–™ç†========</span><br><span class="line">æ¼¢å ¡</span><br><span class="line">è–¯æ¢</span><br><span class="line">ç‚¸é›</span><br></pre></td></tr></table></figure><h3 id="å•é¡Œ"><a href="#å•é¡Œ" class="headerlink" title="å•é¡Œ"></a>å•é¡Œ</h3><p>å¯ä»¥çœ‹åˆ°æœå‹™ç”Ÿå¿…é ˆè¦äº†è§£å¦‚ä½•å¾èœå–®å–å‡ºä¾†ï¼Œè®Šæˆæ¯ä¸€æ¬¡è‹¥åˆæœ‰æ–°çš„èœå–®ï¼Œé‚£æ¯æ¬¡æœå‹™ç”Ÿåˆå¾—æ›‰å¾—æ–°èœå–®çš„å–å¾—æ–¹å¼æ˜¯æ€æ¨£ï¼Œå¦‚æ­¤ä¸€ä¾†å°±å¾—ä¸€ç›´å¢åŠ for loop, æœ‰Nå€‹èœå–®å°±æœ‰Nå€‹for loop, ä¸å¤§å¥½ç¶­è­·ã€‚</p><h2 id="Iteratoræ¨¡å¼ç™»å ´"><a href="#Iteratoræ¨¡å¼ç™»å ´" class="headerlink" title="Iteratoræ¨¡å¼ç™»å ´"></a>Iteratoræ¨¡å¼ç™»å ´</h2><p>è©²æ¨¡å¼ä¸»è¦ç›®çš„ï¼šã€è®“æœå‹™ç”Ÿä¸éœ€çŸ¥é“å…¶å–å‡ºç´°ç¯€æ˜¯å¦‚ä½•ï¼Œåªè¦é€éä¸€å€‹æ¨™æº–çš„ä»‹é¢(Iterator)ï¼Œå°±å¯ä»¥ç›´æ¥å‘¼å«èœå–®å…§å®¹ã€</p><h3 id="å®šç¾©-Iterator-ä»‹é¢"><a href="#å®šç¾©-Iterator-ä»‹é¢" class="headerlink" title="å®šç¾© Iterator ä»‹é¢"></a>å®šç¾© Iterator ä»‹é¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">Boolean <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">T <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ”¹è‰¯ä¸€ä¸‹Menu-å°‡å„å€‹Menuå¯¦ä½œåŒä¸€å€‹ä»‹é¢"><a href="#æ”¹è‰¯ä¸€ä¸‹Menu-å°‡å„å€‹Menuå¯¦ä½œåŒä¸€å€‹ä»‹é¢" class="headerlink" title="æ”¹è‰¯ä¸€ä¸‹Menu å°‡å„å€‹Menuå¯¦ä½œåŒä¸€å€‹ä»‹é¢"></a>æ”¹è‰¯ä¸€ä¸‹Menu å°‡å„å€‹Menuå¯¦ä½œåŒä¸€å€‹ä»‹é¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Menu</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">T <span class="title">getMenu</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChineseMenu</span> <span class="keyword">implements</span> <span class="title">Menu</span>&lt;<span class="title">ArrayList</span>&lt;<span class="title">String</span>&gt;&gt; </span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; menu;</span><br><span class="line"></span><br><span class="line">    ChineseMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.setMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">this</span>.menu.add(<span class="string">"éº»å©†è±†è…"</span>);</span><br><span class="line">        <span class="keyword">this</span>.menu.add(<span class="string">"è±¬è¡€ç³•"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">getMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> menu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class AmericanMenu implements Menu&lt;String[]&gt; &#123;</span><br><span class="line">    String[] menu;</span><br><span class="line"></span><br><span class="line">    AmericanMenu() &#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = <span class="keyword">new</span> String[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">this</span>.setMenuItem();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMenuItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">0</span>] = <span class="string">"æ¼¢å ¡"</span>;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">1</span>] = <span class="string">"è–¯æ¢"</span>;</span><br><span class="line">        <span class="keyword">this</span>.menu[<span class="number">2</span>] = <span class="string">"ç‚¸é›"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String[] getMenu() &#123;</span><br><span class="line">        <span class="keyword">return</span> menu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™æ™‚æ”¹ç”¨å¯¦ä½œå…©å€‹Iteratoré¡åˆ¥ <code>ChineseMenuIterator</code>èˆ‡<code>AmericanMenuIterator</code>ï¼Œè² è²¬å®šç¾©å¦‚ä½•å–å‡ºèœå–®å…§å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChineseMenuIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; menu;</span><br><span class="line">    <span class="keyword">int</span> count = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ChineseMenuIterator</span><span class="params">(Menu&lt;ArrayList&lt;String&gt;&gt; menu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = menu.getMenu();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ChineseMenuæ˜¯ä½¿ç”¨ArrayListå®šç¾©èœå–®åˆ—è¡¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (count + <span class="number">1</span> &gt;= menu.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.menu.get(count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AmericanMenuIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    String[] menu;</span><br><span class="line">    <span class="keyword">int</span> count = -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AmericanMenuIterator</span><span class="params">(Menu&lt;String[]&gt; menu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.menu = menu.getMenu();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (count + <span class="number">1</span> &gt;= menu.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.menu[count];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™æ™‚å›åˆ°æœå‹™ç”Ÿï¼Œè‹¥è¦ä»‹ç´¹èœå–®å…§å®¹çš„è©±ï¼Œåªè¦ä½¿ç”¨ä¸Šé¢å®šç¾©çš„ <code>ChineseMenuIterator</code>èˆ‡<code>AmericanMenuIterator</code>, å°±å¯ä»¥ç›´æ¥å–å‡ºèœå–®é …ç›®å…§å®¹äº†ï¼Œæœå‹™ç”Ÿä¸éœ€è¦åœ¨æ›‰å¾—è¦æ€éº¼è™•ç†æ’ˆå–çš„ç´°ç¯€ï¼Œçœ‹åˆ°ä¸€å †for loopäº†</p><p>Waitress class<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waitress</span> </span>&#123;</span><br><span class="line">    ChineseMenu chineseMenu;</span><br><span class="line">    AmericanMenu americaMenu;</span><br><span class="line"></span><br><span class="line">    ChineseMenuIterator chineseMenuIterator;</span><br><span class="line">    AmericanMenuIterator americanMenuIterator;</span><br><span class="line">    Waitress(</span><br><span class="line">        ChineseMenu chMenu,</span><br><span class="line">        AmericanMenu amerMenu,</span><br><span class="line">        ChineseMenuIterator chineseMenuIterator,</span><br><span class="line">        AmericanMenuIterator americanMenuIterator</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">this</span>.chineseMenu = chMenu;</span><br><span class="line">        <span class="keyword">this</span>.americaMenu = amerMenu;</span><br><span class="line">        <span class="keyword">this</span>.chineseMenuIterator = chineseMenuIterator;</span><br><span class="line">        <span class="keyword">this</span>.americanMenuIterator = americanMenuIterator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€™æ™‚å€™æœå‹™ç”Ÿåªè¦é€éiterator, å°±å¯ä»¥ç›´æ¥ç”¨ä¸€å€‹for loopå…¨éƒ¨å–å‡ºä¾†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">introduceMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======ä»‹ç´¹ä¸­å¼æ–™ç†========"</span>);</span><br><span class="line">        <span class="keyword">while</span>(chineseMenuIterator.hasNext()) &#123;</span><br><span class="line">            System.out.println(chineseMenuIterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"=======ä»‹ç´¹ç¾å¼æ–™ç†========"</span>);</span><br><span class="line">        <span class="keyword">while</span>(americanMenuIterator.hasNext()) &#123;</span><br><span class="line">            System.out.println(americanMenuIterator.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å†åº¦å‘¼å«æœå‹™ç”Ÿä»‹ç´¹èœå–®</p><p>Main class<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ChineseMenu chineseMenu = <span class="keyword">new</span> ChineseMenu();</span><br><span class="line">        ChineseMenuIterator chineseMenuIterator = <span class="keyword">new</span> ChineseMenuIterator(chineseMenu);</span><br><span class="line">        AmericanMenu americanMenu = <span class="keyword">new</span> AmericanMenu();</span><br><span class="line">        AmericanMenuIterator americanMenuIterator = <span class="keyword">new</span> AmericanMenuIterator(americanMenu);</span><br><span class="line">        Waitress waitress = <span class="keyword">new</span> Waitress(</span><br><span class="line">                chineseMenu,</span><br><span class="line">                americanMenu,</span><br><span class="line">                chineseMenuIterator,</span><br><span class="line">                americanMenuIterator);</span><br><span class="line">        waitress.introduceMenu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>é€éIteratorä»‹é¢å®šç¾©å¦‚ä½•å¯¦ä½œæŠ½å–è³‡æ–™çµæ§‹çš„å…§å®¹ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥ä¸ç”¨è²»å¿ƒå»äº†è§£è¦æ€éº¼å–å¾—ï¼Œç›´æ¥å‘¼å«å·²ç¶“æœ‰å¯¦ä½œIteratorä»‹é¢çš„class</p><h2 id="å‚™è¨»"><a href="#å‚™è¨»" class="headerlink" title="å‚™è¨»"></a>å‚™è¨»</h2><p>Collection é¡åˆ¥ä¸­å…¶å¯¦å°±å·²ç¶“å®šç¾©äº†Iteratorä»‹é¢ï¼Œä¸éç‚ºäº†ä»‹ç´¹åè¦†å™¨æ¨¡å¼ï¼Œæ•…åœ¨ArrayListä¸­ç°¡å–®å¯¦ä½œäº†Iteratorä»‹é¢å…§å®¹</p><p><img src="https://i.imgur.com/KGnuRr5.png" alt=""></p><p>Reference: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°‡è™•ç†é™£åˆ—æˆ–æ˜¯å–å€¼æ–¹å¼çš„é‚è¼¯çµ¦å°è£èµ·ä¾†ï¼Œä¸éœ€è®“ä½¿ç”¨è€…ç›´æ¥è™•ç†æ“ä½œå–å€¼çš„é‚è¼¯&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Template Pattern æ¨£æ¿æ¨¡å¼  [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Template-Pattern-%E6%A8%A3%E6%9D%BF%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Template-Pattern-æ¨£æ¿æ¨¡å¼/</id>
    <published>2020-07-29T15:33:47.000Z</published>
    <updated>2021-01-28T12:17:59.406Z</updated>
    
    <content type="html"><![CDATA[<p>æ¨£æ¿, é¡§åæ€ç¾©å°±æ˜¯æŠŠåŒæ¨£çš„é‚è¼¯å®šç¾©æˆä¸€å€‹æ¨£æ¿, å¯è®“å…¶ä»–é¡åˆ¥å…±åŒä½¿ç”¨</p><p>æ¨£æ¿ä¹Ÿæœƒé–‹æ”¾å¯å®¢è£½åŒ–çš„æ–¹æ³• (æŠ½è±¡æ–¹æ³•), ä¾›å…¶ä»–é¡åˆ¥å¯¦ä½œ</p><a id="more"></a><p>æ¨£æ¿ä¸»è¦æ ¸å¿ƒ</p><ol><li>å°‡å…±åŒæ¼”ç®—æ³•é‚è¼¯åŒ…è£å¥½</li><li>å®šç¾©éå…±åŒçš„æ–¹æ³•ç‚ºæŠ½åƒæ–¹æ³•, è«‹ä½¿ç”¨æ¨£æ¿æ–¹æ³•çš„é¡åˆ¥è‡ªè¡Œå¯¦ä½œ</li></ol><h2 id="é€éæ³¡èŒ¶èˆ‡æ³¡å’–å•¡ä¾†ç­è§£æ¨£æ¿æ¨¡å¼å§"><a href="#é€éæ³¡èŒ¶èˆ‡æ³¡å’–å•¡ä¾†ç­è§£æ¨£æ¿æ¨¡å¼å§" class="headerlink" title="é€éæ³¡èŒ¶èˆ‡æ³¡å’–å•¡ä¾†ç­è§£æ¨£æ¿æ¨¡å¼å§"></a>é€éæ³¡èŒ¶èˆ‡æ³¡å’–å•¡ä¾†ç­è§£æ¨£æ¿æ¨¡å¼å§</h2><p>é€™æ™‚å€™è‹¥ç›´æ¥å¯«code, æœƒåˆ†åˆ¥å®šç¾©å‡º <code>Tea</code> èˆ‡ <code>Coffee</code> class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tea</span> </span>&#123;</span><br><span class="line">    Tea() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======é–‹å§‹æº–å‚™èŒ¶çš„å‹•ä½œ======="</span>);</span><br><span class="line">        boilWater();</span><br><span class="line">        steepTeaBag();</span><br><span class="line">        addLenmon();</span><br><span class="line">        pourIntoCup();</span><br><span class="line">        System.out.println(<span class="string">"=======çµæŸ======="</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">boilWater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç‡’é–‹æ°´"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">steepTeaBag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ³¡é–‹èŒ¶åŒ…"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addLenmon</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åŠ å…¥æª¸æª¬"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pourIntoCup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å€’å…¥æ¯ä¸­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> </span>&#123;</span><br><span class="line">    Coffee() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======é–‹å§‹æº–å‚™å’–å•¡çš„å‹•ä½œ======="</span>);</span><br><span class="line">        boilWater();</span><br><span class="line">        greedCoffeeGrinds();</span><br><span class="line">        addCreamer();</span><br><span class="line">        pourIntoCup();</span><br><span class="line">        System.out.println(<span class="string">"=======çµæŸ======="</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">boilWater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç‡’é–‹æ°´"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">greedCoffeeGrinds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç£¨å’–å•¡è±†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addCreamer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åŠ å¥¶ç²¾"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pourIntoCup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å€’å…¥æ¯ä¸­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸Šå®šç¾©çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Tea tea = <span class="keyword">new</span> Tea();</span><br><span class="line">        tea.prepare();</span><br><span class="line"></span><br><span class="line">        Coffee coffee = <span class="keyword">new</span> Coffee();</span><br><span class="line">        coffee.prepare();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/1PXbn6b.png" alt=""></p><h2 id="å¥—ç”¨Template-Patternå§"><a href="#å¥—ç”¨Template-Patternå§" class="headerlink" title="å¥—ç”¨Template Patternå§"></a>å¥—ç”¨Template Patternå§</h2><p>ä»”ç´°æ¯”è¼ƒæ³¡èŒ¶å’Œæ³¡å’–å•¡, éƒ½æœƒæœ‰è‘—ä»¥ä¸‹é¡ä¼¼çš„å‹•ä½œ</p><ol><li>ç…®æ²¸é–‹æ°´</li><li>å°‡(èŒ¶çš„èŒ¶åŒ…/å’–å•¡è—¥ç£¨æˆç²‰)æ³¡é–‹  &lt;â€“ é€™å€‹å‹•ä½œä¸€æ¨£, ä½†èŒ¶æ˜¯ç”¨èŒ¶åŒ…, å’–å•¡æ˜¯éœ€è¦å…ˆç£¨æˆç²‰</li><li>æ·»åŠ æœ‰çš„æ²’çš„ (å’–å•¡æœƒç”¨å¥¶ç²¾/èŒ¶æœƒæ”¾æª¸æª¬) &lt;â€“ é€™é‚Šçš„ä¹Ÿæ˜¯ä¸€æ¨£</li><li>å€’é€²æ¯ä¸­</li></ol><p>å‰›å¥½èŒ¶èˆ‡å’–å•¡éƒ½æ˜¯å«æœ‰å’–å•¡å› çš„é£²æ–™ï¼Œé€™æ™‚å°±å¯ä»¥å®šç¾©ä¸€å€‹æ¨£æ¿å«åš <code>CaffeineBeverage</code>, ä¸¦æŠŠä¸Šè¿° 2,3æ­¥é©Ÿ,å®šç¾©æˆæŠ½è±¡æ–¹æ³•, è®“èŒ¶èˆ‡å’–å•¡é¡åˆ¥è‡ªå·±å»å¯¦ä½œè‡ªå·±çš„é‚è¼¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CaffeineBeverage</span> </span>&#123;</span><br><span class="line">    String name = <span class="string">"å’–å•¡å› é£²æ–™"</span>;</span><br><span class="line">    CaffeineBeverage(String name) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======é–‹å§‹æº–å‚™ "</span> + <span class="keyword">this</span>.name + <span class="string">" çš„å‹•ä½œ======="</span>);</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        addCondiments();</span><br><span class="line">        pourIntoCup();</span><br><span class="line">        System.out.println(<span class="string">"=======çµæŸ======="</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">boilWater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç‡’é–‹æ°´"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šç¾©å¦‚ä½•æ³¡çš„æŠ½è±¡æ–¹æ³•, è®“èŒ¶èˆ‡å’–å•¡è‡ªè¡Œå®šç¾©</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// å®šç¾©è¦æ·»åŠ å…¶ä»–é…æ–™, è®“èŒ¶èˆ‡å’–å•¡è‡ªè¡Œå®šç¾©</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pourIntoCup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å€’é€²æ¯ä¸­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—<code>Tea</code>èˆ‡<code>Coffee</code>å¯¦ç¾è©²æ¨£æ¿é¡åˆ¥ <code>CaffeineBeverage</code><br>ä¸¦æ ¹æ“šè‡ªå·±çš„é‚è¼¯å¯¦ä½œabstractæ–¹æ³• <code>brew()</code>èˆ‡<code>addCondiments()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tea</span> <span class="keyword">extends</span> <span class="title">CaffeineBeverage</span> </span>&#123;</span><br><span class="line">    Tea(String name) &#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======é–‹å§‹æº–å‚™èŒ¶çš„å‹•ä½œ======="</span>);</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        addCondiments();</span><br><span class="line">        pourIntoCup();</span><br><span class="line">        System.out.println(<span class="string">"=======çµæŸ======="</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ³¡é–‹èŒ¶åŒ…"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åŠ å…¥æª¸æª¬"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> <span class="keyword">extends</span> <span class="title">CaffeineBeverage</span></span>&#123;</span><br><span class="line">    Coffee(String name) &#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"=======é–‹å§‹æº–å‚™å’–å•¡çš„å‹•ä½œ======="</span>);</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        addCondiments();</span><br><span class="line">        pourIntoCup();</span><br><span class="line">        System.out.println(<span class="string">"=======çµæŸ======="</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç£¨å’–å•¡è±†"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"åŠ å¥¶ç²¾"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—ä¸€æ¨£ä½¿ç”¨ä¹‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CaffeineBeverage tea = <span class="keyword">new</span> Tea(<span class="string">"èŒ¶"</span>);</span><br><span class="line">        tea.prepare();</span><br><span class="line"></span><br><span class="line">        CaffeineBeverage coffee = <span class="keyword">new</span> Coffee(<span class="string">"å’–å•¡"</span>);</span><br><span class="line">        coffee.prepare();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/lT9g7lA.png" alt=""></p><h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>é€éä»¥ä¸Šæ–¹æ³•å¯ä»¥çœ‹åˆ° æ¨£æ¿æ¨¡å¼ å°‡é‡è¤‡çš„åœ°æ–¹çµ¦çµ±æ•´èµ·ä¾†æˆç‚ºæ¼”ç®—æ³•é‚è¼¯, ä¸¦å®šç¾©ä¸€å€‹æŠ½è±¡é¡åˆ¥, å°‡éœ€è¦å®¢è£½åŒ–çš„éƒ¨åˆ†å®šç¾©æˆæŠ½è±¡æ–¹æ³•, çµ±ä¸€çš„éƒ¨åˆ†å°±ç›´æ¥å®šç¾©å¯¦é«”æ–¹æ³•</p><p>å¦‚æ­¤ä¸€ä¾†å„å€‹é¡åˆ¥åœ¨å¯¦ä½œæ™‚ï¼Œå°±ä¸ç”¨åœ¨è‡ªå·±å»åšé‡è¤‡ä¸€æ¨£çš„å‹•ä½œ(ä¾‹å¦‚ç‡’é–‹æ°´, å€’å…¥æ¯ä¸­) åªè¦ç›´æ¥ç¹¼æ‰¿æ¨£æ¿æŠ½è±¡é¡åˆ¥å°±æœ‰å›‰, ç„¶å¾Œåœ¨è‡ªå·±å¯¦ä½œè‡ªå·±éœ€è¦çš„éƒ¨åˆ† (å¦‚èŒ¶æœ‰è‡ªå·±çš„èŒ¶åŒ…æ³¡æ³•, å’–å•¡å‰‡æœ‰è‡ªå·±çš„å’–å•¡è±†è¦ç£¨ æ‰èƒ½æ³¡)</p><p>ä»¥å¯¦ç¾æ¨£æ¿æ¨¡å¼çš„ç²¾ç¥</p><h2 id="é€éhookæ–¹æ³•å°‡å°è£çš„æ¼”ç®—æ³•é‚è¼¯éƒ¨åˆ†åšæ§åˆ¶ä½¿ç”¨"><a href="#é€éhookæ–¹æ³•å°‡å°è£çš„æ¼”ç®—æ³•é‚è¼¯éƒ¨åˆ†åšæ§åˆ¶ä½¿ç”¨" class="headerlink" title="é€éhookæ–¹æ³•å°‡å°è£çš„æ¼”ç®—æ³•é‚è¼¯éƒ¨åˆ†åšæ§åˆ¶ä½¿ç”¨"></a>é€éhookæ–¹æ³•å°‡å°è£çš„æ¼”ç®—æ³•é‚è¼¯éƒ¨åˆ†åšæ§åˆ¶ä½¿ç”¨</h2><p>å¾…è£œå……</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¨£æ¿, é¡§åæ€ç¾©å°±æ˜¯æŠŠåŒæ¨£çš„é‚è¼¯å®šç¾©æˆä¸€å€‹æ¨£æ¿, å¯è®“å…¶ä»–é¡åˆ¥å…±åŒä½¿ç”¨&lt;/p&gt;
&lt;p&gt;æ¨£æ¿ä¹Ÿæœƒé–‹æ”¾å¯å®¢è£½åŒ–çš„æ–¹æ³• (æŠ½è±¡æ–¹æ³•), ä¾›å…¶ä»–é¡åˆ¥å¯¦ä½œ&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Facade Pattern è¡¨è±¡æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Facade-Pattern-%E8%A1%A8%E8%B1%A1%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Facade-Pattern-è¡¨è±¡æ¨¡å¼/</id>
    <published>2020-07-29T12:20:24.000Z</published>
    <updated>2021-01-28T12:17:26.218Z</updated>
    
    <content type="html"><![CDATA[<p>å°‡è¤‡é›œçš„é¡åˆ¥é—œä¿‚, ç”¨ä¸€å€‹é¡åˆ¥åŒ…è£èµ·ä¾†, ä¾›å‘¼å«</p><p>ä¸æœƒè®“ä½¿ç”¨è€…ç›´æ¥çœ‹åˆ°èƒŒå¾Œè¤‡é›œçš„é‚è¼¯, åªæœƒçœ‹åˆ° â€œè¡¨é¢çš„ç¾è±¡â€, æ•…å«åšè¡¨è±¡æ¨¡å¼</p><a id="more"></a><h2 id="ä»¥ä¸€å€‹å®¶åº­åŠ‡é™¢ä¾†è§£èªª"><a href="#ä»¥ä¸€å€‹å®¶åº­åŠ‡é™¢ä¾†è§£èªª" class="headerlink" title="ä»¥ä¸€å€‹å®¶åº­åŠ‡é™¢ä¾†è§£èªª"></a>ä»¥ä¸€å€‹å®¶åº­åŠ‡é™¢ä¾†è§£èªª</h2><p>å¦‚æœååœ¨å®¢å»³, æƒ³è¦ç‡Ÿé€ ä¸€å€‹å®¶åº­åŠ‡é™¢</p><p>æˆ‘å€‘å¾—åšä»¥ä¸‹äº‹æƒ…ï¼š</p><ol><li>æ‰“é–‹ç‡ˆ, èª¿æ•´äº®åº¦</li><li>æ‰“é–‹é›»è¦–, åˆ‡æ›åˆ°DVDæ¨¡å¼</li><li>æ‰“é–‹éŸ³éŸ¿, èª¿æ•´å¤§å°è²</li><li>æ‰“é–‹DVD, è®€å–è¦çœ‹çš„ç‰‡</li></ol><p>ç­‰ç­‰ä¹‹é¡çš„, ä»¥ä¸‹å®šç¾©é€™äº›æœå‹™çš„class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LightService</span> </span>&#123;</span><br><span class="line">    LightService() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lightOn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the light"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TVService</span> </span>&#123;</span><br><span class="line">    TVService() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openTV</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the TV"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoundService</span> </span>&#123;</span><br><span class="line">    SoundService() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openSound</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the Sound"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DVDPlayerService</span> </span>&#123;</span><br><span class="line">    DVDPlayerService() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openDVD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the DVD"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶å¾Œç›´è¦ºä¸Šæœƒå‘¼å«ä¹‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        LightService lightService = <span class="keyword">new</span> LightService();</span><br><span class="line">        TVService tvService = <span class="keyword">new</span> TVService();</span><br><span class="line">        SoundService soundService = <span class="keyword">new</span> SoundService();</span><br><span class="line">        DVDPlayerService dvdPlayerService = <span class="keyword">new</span> DVDPlayerService();</span><br><span class="line"></span><br><span class="line">        lightService.lightOn();</span><br><span class="line">        tvService.openTV();</span><br><span class="line">        soundService.openSound();</span><br><span class="line">        dvdPlayerService.openDVD();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶çµæœç‚ºï¼š</p><p><img src="https://i.imgur.com/4zTs3XQ.png" alt=""></p><h2 id="è¡¨è±¡æ¨¡å¼ç™»å ´"><a href="#è¡¨è±¡æ¨¡å¼ç™»å ´" class="headerlink" title="è¡¨è±¡æ¨¡å¼ç™»å ´"></a>è¡¨è±¡æ¨¡å¼ç™»å ´</h2><p>ä¸éå°æ–¼ä½¿ç”¨è€…ä¾†èªª, å…¶å¯¦å°±åªæƒ³è¦äº«å—å®¶åº­åŠ‡é™¢çš„å¨›æ¨‚, æ‰€ä»¥å…¶å¯¦æˆ‘å€‘å¯ä»¥ç”¨åŒ…è£çš„æ–¹å¼, å°‡ä¸Šé¢mainè£¡é¢ç›¸é—œæœå‹™çš„classéƒ½åŒ…åœ¨ä¸€å€‹classå…§, å«åš<code>MovieTheaterFacadeService</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MovieTheaterFacadeService</span> </span>&#123;</span><br><span class="line">    MovieTheaterFacadeService() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startMovieTheaterService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        LightService lightService = <span class="keyword">new</span> LightService();</span><br><span class="line">        TVService tvService = <span class="keyword">new</span> TVService();</span><br><span class="line">        SoundService soundService = <span class="keyword">new</span> SoundService();</span><br><span class="line">        DVDPlayerService dvdPlayerService = <span class="keyword">new</span> DVDPlayerService();</span><br><span class="line"></span><br><span class="line">        lightService.lightOn();</span><br><span class="line">        tvService.openTV();</span><br><span class="line">        soundService.openSound();</span><br><span class="line">        dvdPlayerService.openDVD();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æ­¤ä¸€ä¾†, æˆ‘å€‘çš„ä½¿ç”¨è€…(main()), åªè¦å‘¼å« <code>MovieTheaterFacadeService</code> å°±å¯ä»¥ç›´æ¥äº«å—å®¶åº­åŠ‡é™¢, ä¸ç”¨è¦ªè‡ªå»è™•ç†éç¨‹ä¸­çš„äº‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       MovieTheaterFacadeService movieTheaterFacadeService = <span class="keyword">new</span> MovieTheaterFacadeService();</span><br><span class="line"></span><br><span class="line">       movieTheaterFacadeService.startMovieTheaterService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h2><p>é€éä»¥ä¸Šçš„ä¾‹å­, å¯ä»¥çœ‹åˆ°è¡¨è±¡æ¨¡å¼æœ€å¤§çš„ç”¨è™•å°±æ˜¯å°‡è¤‡é›œçš„æœå‹™é¡åˆ¥å€‘çµ¦åŒ…è£åœ¨ä¸€èµ·, ä¸¦é–‹æ”¾å–®ä¸€å€‹é¡åˆ¥ä¾›ä½¿ç”¨è€…ä½¿ç”¨, è®“ä½¿ç”¨è€…åƒ…éœ€è¦çœ‹åˆ°è¡¨é¢å³å¯, ä¸ç”¨ç†è§£ç´°ç¯€æ˜¯ä»€éº¼ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°‡è¤‡é›œçš„é¡åˆ¥é—œä¿‚, ç”¨ä¸€å€‹é¡åˆ¥åŒ…è£èµ·ä¾†, ä¾›å‘¼å«&lt;/p&gt;
&lt;p&gt;ä¸æœƒè®“ä½¿ç”¨è€…ç›´æ¥çœ‹åˆ°èƒŒå¾Œè¤‡é›œçš„é‚è¼¯, åªæœƒçœ‹åˆ° â€œè¡¨é¢çš„ç¾è±¡â€, æ•…å«åšè¡¨è±¡æ¨¡å¼&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Adaptor Pattern è½‰æ¥å™¨æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Adaptor-Pattern-%E8%BD%89%E6%8E%A5%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/29/Design-Pattern-Java-Adaptor-Pattern-è½‰æ¥å™¨æ¨¡å¼/</id>
    <published>2020-07-29T00:15:30.000Z</published>
    <updated>2021-01-28T12:17:17.461Z</updated>
    
    <content type="html"><![CDATA[<p>å‡å¦‚è¦ä½¿ç”¨A, ä½†ç„¡æ³•ç›´æ¥ä½¿ç”¨, åªèƒ½ä½¿ç”¨Bä»‹é¢</p><p>æ‰€ä»¥æˆ‘å€‘ç”¨è½‰æ¥å™¨é¡åˆ¥åŒ…è£Açš„æ–¹æ³•ï¼Œä¸¦ä¸”å¯¦ä½œBï¼Œé”åˆ°è½‰æ¥çš„æ•ˆæœ</p><a id="more"></a><h2 id="ç”¨è¢å¹•è½‰æ¥å™¨çš„ä¾‹å­ç›´æ¥è§£é‡‹"><a href="#ç”¨è¢å¹•è½‰æ¥å™¨çš„ä¾‹å­ç›´æ¥è§£é‡‹" class="headerlink" title="ç”¨è¢å¹•è½‰æ¥å™¨çš„ä¾‹å­ç›´æ¥è§£é‡‹"></a>ç”¨è¢å¹•è½‰æ¥å™¨çš„ä¾‹å­ç›´æ¥è§£é‡‹</h2><p>ä¾‹å¦‚æˆ‘å€‘æœ‰å€‹ HDMIçš„ç·š, å«åš HDMI interface</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">HDMI</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šç¾©é€£æ¥è£ç½®çš„æ–¹æ³•æ ¼å¼</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">connect</span><span class="params">(String device)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†ç¾åœ¨æœ‰å€‹è¢å¹•åªæœ‰æ”¯æ´VGAçš„æ’å­”</p><p>æ‰€ä»¥æˆ‘å€‘éœ€è¦å€‹ HDMIè½‰VGAçš„Adaptoré¡åˆ¥, æŠŠVGAçš„é¡åˆ¥å¼•å…¥é€²ä¾†, ä¸¦ä½¿ç”¨ä¹‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HdmiToVgaAdpator</span> <span class="keyword">implements</span> <span class="title">HDMI</span> </span>&#123;</span><br><span class="line">    VGA vgaCable = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    HdmiToVgaAdpator(VGA vgaCable) &#123;</span><br><span class="line">        <span class="keyword">this</span>.vgaCable = vgaCable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¿…é ˆè¦å¯¦ä½œHDMIçš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connect</span><span class="params">(String device)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä»‹æ¥Vgaç·šçš„connectåŠŸèƒ½</span></span><br><span class="line">        System.out.println(<span class="string">"ä½¿ç”¨è½‰æ¥å™¨çš„connectåŠŸèƒ½!"</span>);</span><br><span class="line">        vgaCable.connect(device);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ç‚ºæœ‰ä½¿ç”¨åˆ°VGAé¡åˆ¥, æ‰€ä»¥ä¾†å®šç¾©ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">VGA</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šç¾©é€£æ¥è£ç½®çš„æ–¹æ³•æ ¼å¼</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">connect</span><span class="params">(String device)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VGACable</span> <span class="keyword">implements</span> <span class="title">VGA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connect</span><span class="params">(String device)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"VGAç·šé€£æ¥: "</span> + device);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾†å®šç¾©æœ‰å°ç­†é›», æ˜¯åªæœ‰å…·å‚™hdmiå­”, ä½†å…·å‚™è‘—å¯ä»¥é€£æ¥åˆ°æŸè£ç½®é€²è¡ŒæŠ•å½±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Labtop</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è©²å°ç­†é›»åªæœ‰hdmiå­”, ä¸¦æŒ‡å®šè¦é€£æ¥çš„è¢å¹•(device)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connectToDevice</span><span class="params">(HDMI hdmi, String device)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç­†é›»åªæœ‰hdmiå­”, ä½¿ç”¨å¯¦ä½œhdmiä»‹é¢çš„ 'hdmiè½‰vgaçš„è½‰æ¥å™¨' é¡åˆ¥ï¼"</span>);</span><br><span class="line">        hdmi.connect(device);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—ä¾†ä½¿ç”¨å§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Labtop laptop = <span class="keyword">new</span> Labtop();</span><br><span class="line">        <span class="comment">// å¦‚æœæŸç­†é›»åªæœ‰hdmiæ’å­”, ä½†è¦æ¥çš„æŠ•å½±è¢å¹•åªæœ‰vga</span></span><br><span class="line">        laptop.connectToDevice(</span><br><span class="line">                <span class="keyword">new</span> HdmiToVgaAdpator( <span class="comment">// é€™æ™‚å¯ä»¥ä½¿ç”¨Hdmiè½‰Vgaçš„è½‰æ¥å™¨ï¼ è½‰æ¥å™¨éœ€è¦å¸¶å…¥å¯¦éš›å…·æœ‰VGAåŠŸèƒ½çš„VGAç·šç‰©ä»¶</span></span><br><span class="line">                        <span class="keyword">new</span> VGACable()),</span><br><span class="line">                <span class="string">"è€èˆŠæŠ•å½±æ©Ÿ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°çµæœç‚º:</p><p><img src="https://i.imgur.com/pwtgvua.png" alt=""></p><ol><li>ç­†é›»ä½¿ç”¨äº† å¯¦ä½œhdmiä»‹é¢çš„è½‰æ¥å™¨ (è½‰æ¥å™¨å› ç‚ºå¯¦ä½œäº†hdmi interface, æ‰€ä»¥å¯ä»¥æ’å…¥ç­†é›»çš„hdmiå­”)</li><li>æ¥è‘—è½‰æ¥å™¨å¼•å…¥äº†VGA cableé¡åˆ¥, æ•…è½‰æ¥å™¨å°±å¯ä»¥ä½¿ç”¨VGAçš„connect()åŠŸèƒ½</li><li>æœ€å¾Œå°±è§¸ç™¼VGAåŠŸèƒ½, èˆ‡æŠ•å½±è£ç½®é€£å‹•</li></ol><h2 id="å¯¦éš›æ‡‰ç”¨å ´æ™¯"><a href="#å¯¦éš›æ‡‰ç”¨å ´æ™¯" class="headerlink" title="å¯¦éš›æ‡‰ç”¨å ´æ™¯"></a>å¯¦éš›æ‡‰ç”¨å ´æ™¯</h2><p>é€šå¸¸è½‰æ¥å™¨æ¨¡å¼å¯ç”¨åœ¨è½‰æ¥é‚£äº›å·²ç¶“éæ™‚çš„æ¨¡çµ„&amp;æ–¹æ³•</p><p>ä¾‹å¦‚æœ‰æ¨¡çµ„æ˜¯ç”¨Javaè¼ƒèˆŠè¿­ä»£Collectionçš„ç‰ˆæœ¬å»å¯«çš„, ç‚ºEnumeration Interface</p><p>ä½†ç¾åœ¨æ–°çš„å°ˆæ¡ˆä¸­ï¼Œæ˜¯ä½¿ç”¨Iteratoræ–¹å¼å»è¿­ä»£Collection</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewLoopService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨Java 5ç‰ˆæœ¬ä¹‹å¾Œæ”¯æ´çš„Iterator</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loopCollection</span><span class="params">(Collection col, Iterator itr)</span> </span>&#123;</span><br><span class="line">        itr = col.iterator();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(itr.hasNext()) &#123;</span><br><span class="line">            System.out.println(itr.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨NewLoopService<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span>() </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">"apple"</span>);</span><br><span class="line">        list.add(<span class="string">"banana"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å®£å‘ŠIteratorçš„è®Šæ•¸</span></span><br><span class="line">        Iterator itr;</span><br><span class="line">        </span><br><span class="line">        NewLoopService loopService = <span class="keyword">new</span> NewLoopService();</span><br><span class="line">        loopService.loopCollection(list, itr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½†ç¾åœ¨è‹¥åªèƒ½ç”¨èˆŠç‰ˆçš„ <code>Enumeration</code> æ–¹å¼å»è¿­ä»£</p><p>é€™æ™‚å°±å¯ä»¥å¯«ä¸€å€‹ <code>EnumeratorAdaptor</code> ä¾†å¯¦ä½œå¯å…¼å®¹<code>Iterator</code>çš„é¡åˆ¥, ä¸¦å¯å‘¼å« <code>Enumeration</code>çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¦ä½œIteratorçš„æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EnumeratorAdaptor</span>&lt;<span class="title">E</span>&gt; <span class="title">implement</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line">    Enumeration&lt;E&gt; enumeration;</span><br><span class="line">    </span><br><span class="line">    EnumeratorAdaptor(Enumeration&lt;E&gt; enumeration) &#123;</span><br><span class="line">        <span class="keyword">this</span>.enumeration = enumeration;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¯¦ä½œIterator ä»‹é¢æ‰€éœ€çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½†å¯¦éš›ä¸Šæ˜¯ä½¿ç”¨Enumerationçš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.enumeration.hasMoreElements();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.enumeration.nextElement();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½†é€™æ™‚å€™æœƒé‡åˆ°Enumerationæ²’æœ‰çš„æ–¹æ³•, ä½†åˆå¿…é ˆè¦å¯¦ä½œ æ»¿è¶³Iteratorçš„ä»‹é¢è¦ç¯„, é€™æ™‚å¯ä»¥throw Exceptionä¾†è™•ç†</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™æ™‚æˆ‘å€‘å¯ä»¥åœ¨<code>main()</code>ä¸­æ”¹ç”¨è½‰æ¥å™¨, ä¾†é–“æ¥ä½¿ç”¨Enumerationäº†ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span>() </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">"apple"</span>);</span><br><span class="line">        list.add(<span class="string">"banana"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä½¿ç”¨ `å¯¦ä½œIteratorä»‹é¢` çš„è½‰æ¥å™¨</span></span><br><span class="line">        EnumeratorAdaptor itr;</span><br><span class="line">        </span><br><span class="line">        NewLoopService loopService = <span class="keyword">new</span> NewLoopService();</span><br><span class="line">        loopService.loopCollection(list, itr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewLoopService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨Java 5ç‰ˆæœ¬ä¹‹å¾Œæ”¯æ´çš„Iterator</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loopCollection</span><span class="params">(Collection col, Iterator itr)</span> </span>&#123;</span><br><span class="line">        itr = col.iterator();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é€™æ™‚æœƒæ˜¯ä½¿ç”¨EnumeratorAdaptorå…§çš„hasNext()èˆ‡next() é”åˆ°è½‰æ¥çš„æ•ˆæœ</span></span><br><span class="line">        <span class="keyword">while</span>(itr.hasNext()) &#123;</span><br><span class="line">            System.out.println(itr.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€éä»¥ä¸Šæ–¹æ³•, å¯ä»¥æŠŠè¦ä½¿ç”¨Enumerationæ–¹å¼çš„service, ä½†è©²Serviceåˆæ˜¯åªèƒ½åƒIteratorçš„è¼¸å…¥, é‚£å°±å¯ä»¥å¯¦ä½œä¸€å€‹ <code>EnumeratorAdaptor</code>, å¸¶å…¥Service, ä¸¦é€éè½‰æ¥å™¨ä½¿ç”¨ Enumerationçš„æ–¹å¼å»æ’ˆå‡ºCollectionå…§å®¹.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‡å¦‚è¦ä½¿ç”¨A, ä½†ç„¡æ³•ç›´æ¥ä½¿ç”¨, åªèƒ½ä½¿ç”¨Bä»‹é¢&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘å€‘ç”¨è½‰æ¥å™¨é¡åˆ¥åŒ…è£Açš„æ–¹æ³•ï¼Œä¸¦ä¸”å¯¦ä½œBï¼Œé”åˆ°è½‰æ¥çš„æ•ˆæœ&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Observer Pattern è§€å¯Ÿè€…æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Observer-Pattern-%E8%A7%80%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Observer-Pattern-è§€å¯Ÿè€…æ¨¡å¼/</id>
    <published>2020-07-26T08:59:48.000Z</published>
    <updated>2021-01-28T12:17:41.422Z</updated>
    
    <content type="html"><![CDATA[<p>è§€å¯Ÿè€…æ¨¡å¼å¯ä»¥è®“ç‰©ä»¶äº†è§£è³‡æ–™è®ŠåŒ–çš„æƒ…æ³ã€‚<br>ç‰©ä»¶ç”šè‡³å¯ä»¥åœ¨åŸ·è¡ŒæœŸé–“æ±ºå®šæ˜¯å¦è¦ç¹¼çºŒè¢«é€šçŸ¥ï¼Œåˆæˆ–è€…æ˜¯å¯ä»¥ä¸»å‹•å»è©¢å•è³‡æ–™çš„ç‹€æ…‹ã€‚<br>åœ¨æ­¤æ¨¡å¼ä¸­ä¹Ÿæœƒäº†è§£ä¸€å°å¤šï¼Œä»¥åŠç‰©ä»¶é¬†ç¶çš„æ„ç¾©æ˜¯å¦‚ä½•ã€‚</p><a id="more"></a><h3 id="ä»¥æ°£è±¡ç›£æ¸¬ç³»çµ±çš„æ¦‚æ³ä¾†ç•¶åšä¾‹å­"><a href="#ä»¥æ°£è±¡ç›£æ¸¬ç³»çµ±çš„æ¦‚æ³ä¾†ç•¶åšä¾‹å­" class="headerlink" title="ä»¥æ°£è±¡ç›£æ¸¬ç³»çµ±çš„æ¦‚æ³ä¾†ç•¶åšä¾‹å­"></a>ä»¥æ°£è±¡ç›£æ¸¬ç³»çµ±çš„æ¦‚æ³ä¾†ç•¶åšä¾‹å­</h3><p>å‡è¨­ç³»çµ±ä¸­æœ‰ä¸‰å€‹çµ„æˆè¦ä»¶ï¼š<br>(1) æ°£è±¡ç«™: ç²å–å¯¦éš›æ°£è±¡çš„ç‰©ç†è£ç½®ï¼Œå‡è¨­æœ‰ä¸‰å€‹:æº«åº¦,æ¿•åº¦,å£“åŠ›æ„Ÿæ‡‰<br>(2) Weather Dataç‰©ä»¶: è¿½è¹¤ä¾†è‡ªæ°£è±¡ç«™çš„è³‡æ–™ï¼Œä¸¦ä¸”é¡¯ç¤ºåœ¨ä½ˆå‘Šç‰ˆä¸Š<br>(3) ä½ˆå‘Šç‰ˆ: å°‡Weather Dataç‰©ä»¶çµ¦äºˆçš„è³‡æ–™å‘ˆç¾å‡ºä¾†</p><p>æ•´å€‹ä¾‹å­æœƒæœ‰ï¼Œä¸€å€‹æ°£è±¡ç«™(ç”¢å‡ºå‡çš„æ°£è±¡è³‡æ–™)ï¼ŒWeather Dataç‰©ä»¶(ç²å–æ°£è±¡è³‡æ–™ä¸¦é€šçŸ¥ä½ˆå‘Šç‰ˆ)ï¼Œä½ˆå‘Šç‰ˆå°‡æ‹¿åˆ°çš„è³‡æ–™çµ¦å‘ˆç¾å‡ºä¾†</p><h3 id="æ²’ä½¿ç”¨è§€å¯Ÿè€…æ¨¡å¼-Observer-Patternçš„æƒ…æ³"><a href="#æ²’ä½¿ç”¨è§€å¯Ÿè€…æ¨¡å¼-Observer-Patternçš„æƒ…æ³" class="headerlink" title="æ²’ä½¿ç”¨è§€å¯Ÿè€…æ¨¡å¼ Observer Patternçš„æƒ…æ³"></a>æ²’ä½¿ç”¨è§€å¯Ÿè€…æ¨¡å¼ Observer Patternçš„æƒ…æ³</h3><p>åˆå­¸è€…æœƒå¾ˆç›´è¦ºçš„å¯«å‡ºé€™æ¨£çš„ç¨‹å¼æ¶æ§‹ï¼š</p><h4 id="ä½ˆå‘Šæ¬„"><a href="#ä½ˆå‘Šæ¬„" class="headerlink" title="ä½ˆå‘Šæ¬„"></a>ä½ˆå‘Šæ¬„</h4><p>CurrentConditionsDisplay.class<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CurrentConditionsDisplay</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> temp;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> humidity;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pressure;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.temp = temp;</span><br><span class="line">       <span class="keyword">this</span>.humidity = humidity;</span><br><span class="line">       <span class="keyword">this</span>.pressure = pressure;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é¡¯ç¤ºè³‡æ–™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(temp);</span><br><span class="line">        System.out.println(humidity);</span><br><span class="line">        System.out.println(pressure);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="WeatherData-class"><a href="#WeatherData-class" class="headerlink" title="WeatherData.class"></a>WeatherData.class</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherData</span> </span>&#123;</span><br><span class="line">    <span class="comment">// instance variable declarations</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å®£å‘Šä½ˆå‘Šæ¬„</span></span><br><span class="line">    CurrentConditionsDisplay currentConditionsDisplay;</span><br><span class="line">    StatisticsDisplay statisticsDisplay;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">// å»ºæ§‹å­</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherData</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        CurrentConditionsDisplay currentConditionsDisplay,</span></span></span><br><span class="line"><span class="function"><span class="params">        StatisticsDisplay statisticsDisplay</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentConditionsDisplay = currentConditionsDisplay;</span><br><span class="line">        <span class="keyword">this</span>.statisticsDisplay = statisticsDisplay;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTemperature</span><span class="params">()</span> </span>&#123;...&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHumidity</span><span class="params">()</span> </span>&#123;...&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPressure</span><span class="params">()</span> </span>&#123;...&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">measurementsChanged</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">float</span> temp = getTemperature();</span><br><span class="line">        <span class="keyword">float</span> humidity = getHumidity();</span><br><span class="line">        <span class="keyword">float</span> pressure = getPressure();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°ä½ˆå‘Šæ¬„é¡åˆ¥é€²è¡Œæ›´æ–°ä»–å€‘çš„é¡¯ç¤ºå…§å®¹</span></span><br><span class="line">        currentConditionsDisplay.update(temp, humidity, pressure);</span><br><span class="line">        statisticsDisplay.update(temp, humidity, pressure);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å…¶ä»–WeatherData function...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä»¥ä¸Šç¨‹å¼çµæ§‹æœƒæœ‰è€¦åˆæ€§çš„ç‹€æ³ï¼š</p><p><img src="https://i.imgur.com/gpIs58H.png" alt=""></p><p>æ‰€ä»¥æ¥ä¸‹ä¾†ä¾†äº†è§£è§€å¯Ÿè€…æ¨¡å¼çš„å…§æ¶µ</p><h4 id="è§€å¯Ÿè€…æ¨¡å¼è§£æ"><a href="#è§€å¯Ÿè€…æ¨¡å¼è§£æ" class="headerlink" title="è§€å¯Ÿè€…æ¨¡å¼è§£æ"></a>è§€å¯Ÿè€…æ¨¡å¼è§£æ</h4><p>å®šç¾©äº†ç‰©ä»¶ä¹‹é–“ä¸€å°å¤šé—œä¿‚ï¼Œå¦‚æ­¤ä¸€ä¾†ï¼Œç•¶ä¸€å€‹ç‰©ä»¶æ”¹è®Šç‹€æ…‹æ™‚ï¼Œå…¶ä»–ç›¸ä¾è€…éƒ½æœƒæ”¶åˆ°é€šçŸ¥ä¸¦è‡ªå‹•åšæ”¹è®Š</p><p>å…¶ç¤ºæ„åœ–å¦‚ä¸‹ï¼š</p><p><img src="https://i.imgur.com/d1zWR3x.png" alt=""></p><p>ä¸»é¡Œèˆ‡è§€å¯Ÿè€…å€‘å®šç¾©äº†ä¸€å°å¤šçš„é—œä¿‚</p><p>è‹¥è¦å¯¦è¸å‡ºå¯ä»¥éš”é›¢ä¸»é¡Œå’Œè§€å¯Ÿè€…å€‘çš„æ–¹å¼ï¼Œä»¥ <code>Subject</code>ä»‹é¢å’Œ<code>Observer</code>ä»‹é¢æœ€ç‚ºå¸¸è¦‹</p><p><img src="https://i.imgur.com/C155cCF.png" alt=""></p><p>åœ¨é€™å¼µåœ–è¦æ³¨æ„ä¸€å€‹é‡é»æ˜¯ï¼Œç”±æ–¼ç¾åœ¨å·²ç¶“é‡å°ä»‹é¢å¯¦ä½œï¼Œç¾åœ¨çš„Subjectä¸­çš„è¨»å†ŠObserveréƒ½æ˜¯ä»¥è¨»å†Šâ€<span style="color:red">ä»‹é¢</span>â€œç‚ºä¸»ï¼è€Œéæ˜¯åƒä¸Šé¢ä¸€é–‹å§‹çš„æ–°æ‰‹ä¾‹å­æ˜¯ç›´æ¥é‡å°å¯¦è¸è€Œå¯«</p><p>å¦‚æ­¤ä¸€ä¾†å¦‚æœè¦åœ¨æ–°å¢ä¸€å€‹ä½ˆå‘Šæ¬„å«åšForecastDisplayï¼Œç›´æ¥å¯¦è¸Observerå°±å¥½ï¼Œé€™æ¨£å°±ä¸ç”¨å‹•åˆ°å¯¦è¸Subjectä»‹é¢çš„WeatherDataä¹‹ç¨‹å¼ç¢¼</p><p><img src="https://i.imgur.com/GJTGp80.png" alt=""></p><h4 id="ä»¥è§€å¯Ÿè€…æ¨¡å¼ä¾†é‡å¯«æ°£è±¡ç›£æ¸¬ç³»çµ±"><a href="#ä»¥è§€å¯Ÿè€…æ¨¡å¼ä¾†é‡å¯«æ°£è±¡ç›£æ¸¬ç³»çµ±" class="headerlink" title="ä»¥è§€å¯Ÿè€…æ¨¡å¼ä¾†é‡å¯«æ°£è±¡ç›£æ¸¬ç³»çµ±"></a>ä»¥è§€å¯Ÿè€…æ¨¡å¼ä¾†é‡å¯«æ°£è±¡ç›£æ¸¬ç³»çµ±</h4><p>Subject.interface</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">registerObserver</span><span class="params">(Observer o)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeObserver</span><span class="params">(Observer o)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">notifyObservers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ObserverInterface</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temperature, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>WeatherData.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherData</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayList observers;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> temperature;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> humidity;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> pressure;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        observers = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerObserver</span><span class="params">(Observer o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = observers.indexOf(o);</span><br><span class="line">        observers.add(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeObserver</span><span class="params">(Observer o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = observers.indexOf(o);</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">            observers.remove(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘è§€å¯Ÿè€…å€‘é€ä»¥æ”¹å‹•çš„è³‡æ–™</span></span><br><span class="line">    <span class="comment">// å¯ä»¥çœ‹åˆ°ç¾åœ¨æˆ‘å€‘æ˜¯ç›´æ¥è¨»å†ŠObserverä»‹é¢ï¼Œå¦‚æ­¤ä¸€ä¾†è§€å¯Ÿè€…é¡åˆ¥çš„å¯¦ä½œå°±ä¸ç”¨å»åœ¨æ„</span></span><br><span class="line">    <span class="comment">// åªè¦çŸ¥é“è¦è¨»å†Šçš„å°è±¡å¿…é ˆè¦æœ‰å¯¦ä½œObserverä»‹é¢å°±å¥½</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObservers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;observers.size(); i++) &#123;</span><br><span class="line">            Observer observer = (Observer)observers.get(i);</span><br><span class="line">            observer.update(temperature, humidity, pressure);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŸ·è¡Œå‘è§€å¯Ÿè€…å€‘é€šçŸ¥è³‡æ–™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">measurementsChanged</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®€å–å‡è³‡æ–™ï¼Œå¯ä»¥æ”¹å‹•é€™åœ°æ–¹ï¼Œæ”¹ç‚ºå‘æ°£è±¡å±€ç¶²ç«™çˆ¬è³‡æ–™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMeasurements</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> temperature,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> humidity,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> pressure)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.temperature = temperature;</span><br><span class="line">        <span class="keyword">this</span>.humidity = humidity;</span><br><span class="line">        <span class="keyword">this</span>.pressure = pressure;</span><br><span class="line">        measurementsChanged();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™è£¡æˆ‘å€‘åªå¯¦è¸ä¸€å€‹ä½ˆå‘Šæ¬„ CurrentConditionDisplay</p><p>CurrentConditionDisplay.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CurrentConditionDisplay</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> temperature;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> humidity;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> pressure;</span><br><span class="line">    <span class="keyword">private</span> Subject weatherData;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CurrentConditionDisplay</span><span class="params">(Subject weatherData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.weatherData = weatherData;</span><br><span class="line">        weatherData.registerObserver(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temperature, <span class="keyword">float</span> humidity, <span class="keyword">float</span> pressure)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.temperature = temperature;</span><br><span class="line">        <span class="keyword">this</span>.humidity = humidity;</span><br><span class="line">        <span class="keyword">this</span>.pressure = pressure;</span><br><span class="line">        display();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Current condition: "</span>+temperature + <span class="string">"F degrees and "</span> + humidity + <span class="string">"% humidity and "</span>+ pressure + <span class="string">" pressure"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åŸ·è¡Œç¨‹å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        WeatherData weatherData = <span class="keyword">new</span> WeatherData();</span><br><span class="line"></span><br><span class="line">        CurrentConditionDisplay currentDisplay = <span class="keyword">new</span> CurrentConditionDisplay(weatherData);</span><br><span class="line"></span><br><span class="line">        weatherData.setMeasurements(<span class="number">80</span>, <span class="number">64</span>, <span class="number">30.4f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»¥ä¸‹çµæœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Current condition: 80.0F degrees and 64.0% humidity and 30.4 pressure</span><br></pre></td></tr></table></figure><p>ä¹‹å¾Œåªè¦é€éä¸»é¡Œå‘¼å«è§€å¯Ÿè€…çš„update()çš„æ–¹æ³•ï¼Œå°±å¯ä»¥é€šçŸ¥æ–°çš„è³‡æ–™çµ¦è§€å¯Ÿè€…</p><p>ä¸¦ä¸”é€éè¨»å†Šçš„æ–¹å¼+åªåŠ å…¥é‡å°å¯¦è¸Observerä»‹é¢çš„è§€å¯Ÿè€…ï¼Œå¦‚æ­¤ä¸€ä¾†å¯ä»¥é”åˆ°åˆ†é›¢ä¸»é¡Œç‰©ä»¶èˆ‡è§€å¯Ÿè€…ç‰©ä»¶çš„é‚è¼¯ï¼Œä¹‹å¾Œæ–°å¢æ–°çš„ä½ˆå‘Šæ¬„å°±ä¸ç”¨å‹•åˆ°ä¸»é¡Œçš„ç¨‹å¼é‚è¼¯ã€‚</p><h3 id="è£œå……"><a href="#è£œå……" class="headerlink" title="è£œå……"></a>è£œå……</h3><h4 id="java-sdkä¹Ÿæœ‰è‡ªè¡Œæä¾›Observeræ–¹æ³•"><a href="#java-sdkä¹Ÿæœ‰è‡ªè¡Œæä¾›Observeræ–¹æ³•" class="headerlink" title="java sdkä¹Ÿæœ‰è‡ªè¡Œæä¾›Observeræ–¹æ³•"></a>java sdkä¹Ÿæœ‰è‡ªè¡Œæä¾›Observeræ–¹æ³•</h4><p>å…¶ä¸­æœƒæœ‰<code>setChange()</code>çš„æ–¹æ³•ï¼Œä¸»è¦è®“å‘¼å«è€…å®šç¾©ä»€éº¼æ™‚å€™æ‰è¦é€šçŸ¥æ–°çš„è³‡æ–™çµ¦è§€å¯Ÿè€…ï¼Œé¿å…æ¯æ¬¡è³‡æ–™ä¸€æ”¹è®Šå°±ä¸€ç›´é€šçŸ¥è§€å¯Ÿè€…ã€‚Ex: å¦‚æœæ²’æœ‰setChangedçš„æ–¹æ³•ï¼ŒWeahterDataç‰©ä»¶å°±æœƒæŒçºŒä¸æ–·çš„é€šçŸ¥è§€å¯Ÿè€…ï¼Œæ‰€ä»¥è‹¥æˆ‘å€‘å¸Œæœ›æº«åº¦å·®è·åŠåº¦æ‰æ›´æ–°ï¼Œæº«åº¦å·®è·æ’åˆ°åŠåº¦ä»¥ä¸Šï¼Œä¸»é¡Œæ‰æœƒå‘¼å«è§€å¯Ÿè€…çš„update()çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">setChanged() &#123;</span><br><span class="line">    changed = ture;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">notifyObservers(Object arg) &#123;</span><br><span class="line">    if(changed) &#123;</span><br><span class="line">        for every observer on the list &#123;</span><br><span class="line">            call update(this. org)</span><br><span class="line">        &#125;</span><br><span class="line">        changed = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">notifyObsergers() &#123;</span><br><span class="line">    notifyObservers(null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è§€å¯Ÿè€…æ¨¡å¼å¯ä»¥è®“ç‰©ä»¶äº†è§£è³‡æ–™è®ŠåŒ–çš„æƒ…æ³ã€‚&lt;br&gt;ç‰©ä»¶ç”šè‡³å¯ä»¥åœ¨åŸ·è¡ŒæœŸé–“æ±ºå®šæ˜¯å¦è¦ç¹¼çºŒè¢«é€šçŸ¥ï¼Œåˆæˆ–è€…æ˜¯å¯ä»¥ä¸»å‹•å»è©¢å•è³‡æ–™çš„ç‹€æ…‹ã€‚&lt;br&gt;åœ¨æ­¤æ¨¡å¼ä¸­ä¹Ÿæœƒäº†è§£ä¸€å°å¤šï¼Œä»¥åŠç‰©ä»¶é¬†ç¶çš„æ„ç¾©æ˜¯å¦‚ä½•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Strategy Pattern ç­–ç•¥æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Strategy-Pattern-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Strategy-Pattern-ç­–ç•¥æ¨¡å¼/</id>
    <published>2020-07-26T08:58:12.000Z</published>
    <updated>2021-01-28T12:17:55.339Z</updated>
    
    <content type="html"><![CDATA[<p>å¯ä»¥åœ¨åŸ·è¡ŒæœŸå‹•æ…‹æ›´æ›ç‰©ä»¶çš„è¡Œç‚º</p><p>ã€ç­–ç•¥æ¨¡å¼ã€å®šç¾©äº†æ¼”ç®—æ³•å®¶æ—ï¼Œå°‡ä»–å€‘å€‹åˆ¥å°è£èµ·ä¾†ï¼Œå¯ä»¥è®“ä»–å€‘ä¹‹é–“äº’ç›¸æ›¿æ›ï¼Œæ­¤æ¨¡å¼ä¸æœƒå½±éŸ¿åˆ°ä½¿ç”¨æ­¤æ¼”ç®—æ³•çš„ç¨‹å¼ã€‚</p><a id="more"></a><h2 id="æ²’æœ‰æ€è€ƒä½¿ç”¨è¨­è¨ˆæ¨¡å¼çš„æ™‚å€™-æ¨¡æ“¬é´¨å­ç‰ˆæœ¬"><a href="#æ²’æœ‰æ€è€ƒä½¿ç”¨è¨­è¨ˆæ¨¡å¼çš„æ™‚å€™-æ¨¡æ“¬é´¨å­ç‰ˆæœ¬" class="headerlink" title="æ²’æœ‰æ€è€ƒä½¿ç”¨è¨­è¨ˆæ¨¡å¼çš„æ™‚å€™:æ¨¡æ“¬é´¨å­ç‰ˆæœ¬"></a>æ²’æœ‰æ€è€ƒä½¿ç”¨è¨­è¨ˆæ¨¡å¼çš„æ™‚å€™:æ¨¡æ“¬é´¨å­ç‰ˆæœ¬</h2><p>å‡è¨­æˆ‘å€‘è¦é–‹ç™¼æ¨¡æ“¬é´¨å­éŠæˆ²ï¼Œæœƒæœ‰å„ç¨®ä¸åŒçš„é´¨å­ï¼Œé€™æ™‚å€™æœƒå€‘é€šå¸¸éƒ½æœƒå…ˆè¨­è¨ˆå‡ºä¸€å€‹classå«åš Duckï¼Œç„¶å¾ŒDuckæœƒåŒ…å«é´¨å­çš„å…±åŒè¡Œç‚ºï¼šç™¼å‡ºå«è² quack(), æ¸¸æ³³ swin(), ä»¥åŠå±•ç¾å¤–è§€ display()ï¼Œç„¶å¾Œæœ‰ç¶ é ­é´¨ MallardDuck classå’Œ ç´…é ­é´¨ RedheadDuck classåˆ†åˆ¥ç¹¼æ‰¿ Ducké¡åˆ¥</p><p>(åšUML)</p><p>è‹¥ç¾åœ¨éœ€è¦è®“æ¯éš»é´¨å­éƒ½æœƒé£›ï¼Œæˆ‘å€‘æœƒå¾ˆç›´è¦ºçš„åœ¨ Duck classä¸­åŠ å…¥ fly()</p><p>ä½†è‹¥ç¾åœ¨æœ‰å€‹æ©¡çš®é´¨å­ï¼Œæœƒä¸å°å¿ƒç¹¼æ‰¿åˆ°Duck classçš„fly(), ä½†æ©¡çš®é´¨ä¸æœƒé£›ï¼</p><h3 id="ç”¨ç¹¼æ‰¿çš„å¯ä»¥æ”¹å–„ä½œæ³•"><a href="#ç”¨ç¹¼æ‰¿çš„å¯ä»¥æ”¹å–„ä½œæ³•" class="headerlink" title="ç”¨ç¹¼æ‰¿çš„å¯ä»¥æ”¹å–„ä½œæ³•"></a>ç”¨ç¹¼æ‰¿çš„å¯ä»¥æ”¹å–„ä½œæ³•</h3><p>ç›´æ¥åœ¨æ©¡çš®é´¨ classä¸­çš„fly() ä¸å®šç¾©ä»»ä½•äº‹æƒ…</p><p>(åšUML)</p><h4 id="å•é¡Œ"><a href="#å•é¡Œ" class="headerlink" title="å•é¡Œ"></a>å•é¡Œ</h4><p>è‹¥åˆé‡åˆ°èª˜é¤Œé´¨ï¼Œå°±æœƒé¢è‡¨fly()æ²’å®šç¾©ä»»ä½•äº‹æƒ…ï¼Œquack()ä¹Ÿæ²’å®šç¾©ä»»ä½•äº‹æƒ…<br>å› ç‚ºè‹¥æœ‰å¾ˆå¤šæ–°å‹æ…‹çš„é´¨å­ï¼Œæœƒå°è‡´æ¯ä¸€å€‹ä¸åŒçš„é´¨å­éƒ½å¾—æª¢è¦–è©²é´¨å­æ˜¯å¦å¯é£›æˆ–å¯å«</p><p>(åšUML)</p><h3 id="æ”¹ç”¨ä»‹é¢åšæ”¹å–„"><a href="#æ”¹ç”¨ä»‹é¢åšæ”¹å–„" class="headerlink" title="æ”¹ç”¨ä»‹é¢åšæ”¹å–„"></a>æ”¹ç”¨ä»‹é¢åšæ”¹å–„</h3><p>å°‡flyèˆ‡quackå¾DuckæŠ½é›¢å‡ºä¾†è®Šæˆ Flyableèˆ‡Quackableä»‹é¢ï¼Œè®“æœ‰éœ€è¦é£›æˆ–å«çš„é´¨å­å¯¦ä½œä¹‹</p><h4 id="å•é¡Œ-1"><a href="#å•é¡Œ-1" class="headerlink" title="å•é¡Œ"></a>å•é¡Œ</h4><p>é‡è¤‡çš„ç¨‹å¼ç¢¼æœƒè®Šè¶…å¤šï¼Œå› ç‚ºåŒæ¨£æœƒé£›æˆ–å«çš„é´¨å­éƒ½å„è‡ªå¯¦ä½œäº†Flyableèˆ‡Quackableä»‹é¢çš„ç¨‹å¼ç¢¼ï¼Œè©²ç¨‹å¼ç¢¼é‚è¼¯éƒ½æ˜¯ç›¸åŒçš„ã€‚</p><h3 id="è¨­è¨ˆå®ˆå‰‡-ä¸€"><a href="#è¨­è¨ˆå®ˆå‰‡-ä¸€" class="headerlink" title="è¨­è¨ˆå®ˆå‰‡(ä¸€)"></a>è¨­è¨ˆå®ˆå‰‡(ä¸€)</h3><ul><li><p>æ‰¾å‡ºç¨‹å¼ä¸­éœ€è¦æ›´å‹•ä¹‹è™•ï¼Œä¸¦å°‡ä¹‹ç¨ç«‹å‡ºä¾†ï¼Œä¸è¦å’Œé‚£äº›ä¸éœ€è¦æ›´å‹•çš„ç¨‹å¼ç¢¼æ··åœ¨ä¸€èµ·</p></li><li><p>æŠŠæœƒè®Šå‹•çš„éƒ¨åˆ†å–å‡ºä¾†ä¸¦å°‡ä¹‹å°è£èµ·ä¾†ï¼Œä»¥ä¾¿ä»¥å¾Œå¯ä»¥è¼•æ˜“åœ°æ“´å……æ­¤éƒ¨åˆ†ï¼Œè€Œä¸å½±éŸ¿ä¸éœ€è¦æ›´å‹•çš„éƒ¨åˆ†ã€‚</p></li></ul><blockquote><p>å°‡é´¨å­çš„è¡Œç‚ºå¾Ducké¡åˆ¥å–å‡ºä¾†ï¼</p></blockquote><h3 id="æŠ½é›¢æœƒè®Šå‹•çš„éƒ¨åˆ†æˆç‚ºç¨ç«‹é¡åˆ¥"><a href="#æŠ½é›¢æœƒè®Šå‹•çš„éƒ¨åˆ†æˆç‚ºç¨ç«‹é¡åˆ¥" class="headerlink" title="æŠ½é›¢æœƒè®Šå‹•çš„éƒ¨åˆ†æˆç‚ºç¨ç«‹é¡åˆ¥"></a>æŠ½é›¢æœƒè®Šå‹•çš„éƒ¨åˆ†æˆç‚ºç¨ç«‹é¡åˆ¥</h3><p>å°‡é£›è¡Œè¡Œç‚º fly,èˆ‡å‘±å‘±å«è¡Œç‚º quackç¨ç«‹æˆclass</p><p>ä¸¦ä¸”åœ¨Ducké¡åˆ¥è¨­ç½® â€œå¯ä»¥è¨­å®šè¡Œç‚ºçš„æ–¹æ³•â€ï¼Œå¯ä»¥åœ¨â€œåŸ·è¡ŒæœŸâ€å‹•æ…‹åœ°æ”¹è®Šé´¨å­çš„é£›è¡Œæˆ–å‘±å‘±å«è¡Œç‚º</p><h3 id="è¨­è¨ˆå®ˆå‰‡-äºŒ"><a href="#è¨­è¨ˆå®ˆå‰‡-äºŒ" class="headerlink" title="è¨­è¨ˆå®ˆå‰‡(äºŒ)"></a>è¨­è¨ˆå®ˆå‰‡(äºŒ)</h3><p>å¯«ç¨‹å¼æ˜¯é‡å°ä»‹é¢è€Œå¯«ï¼Œè€Œä¸æ˜¯é‡å°å¯¦è¸</p><h3 id="ç”¨ä»‹é¢ä»£è¡¨æ¯å€‹è¡Œç‚º-FlyBehavior-QuackBehavior"><a href="#ç”¨ä»‹é¢ä»£è¡¨æ¯å€‹è¡Œç‚º-FlyBehavior-QuackBehavior" class="headerlink" title="ç”¨ä»‹é¢ä»£è¡¨æ¯å€‹è¡Œç‚º: FlyBehavior, QuackBehavior"></a>ç”¨ä»‹é¢ä»£è¡¨æ¯å€‹è¡Œç‚º: FlyBehavior, QuackBehavior</h3><p>ç”¨å„å€‹é´¨å­çš„è¡Œç‚ºé¡åˆ¥å»å¯¦è¸FlyBehaviorå’ŒQuackBehaviorä»‹é¢<br>è€Œä¸æ˜¯ç”±Ducké¡åˆ¥å¯¦è¸è©²ä»‹é¢</p><p>:::info<br>å¯«ç¨‹å¼æ˜¯é‡å°ä»‹é¢å»å¯«ï¼šå…¶çœŸæ­£æ„æ€æ˜¯ã€å¯«ç¨‹å¼æ˜¯é‡å°è¶…å‹æ…‹(supertype)è€Œå¯«ã€</p><p>ä½¿ç”¨è¶…å‹æ…‹çš„è©±å¯ä»¥ä¸ç”¨ç†æœƒä»¥å¾ŒåŸ·è¡Œæ™‚çš„çœŸæ­£ç‰©ä»¶å‹æ…‹ï¼šç‚ºâ€œå¤šå‹â€çš„å¯¦è¸</p><p>ex:</p><p>Animal interface { makeSound() }<br>Dog implment Animal { makeSound() { bark() }}<br>Cat implement Animal { makeSound() { meow() }}</p><p>Animal animal = new Dog();<br>animal.makeSound();</p><p>æœ‰å€‹å¥½è™•æ˜¯ï¼Œå¯ä»¥ä¸ç”¨ç›´æ¥åœ¨ä¸€é–‹å§‹åƒµåŒ–æŸå€‹è®Šæ•¸çš„å®£å‘Šå‹æ…‹ ex: Dog x = new dog(); // åƒµåŒ–äº†xè®Šæ•¸ç‚ºdogå‹æ…‹</p><p>è€Œæ˜¯å¯ä»¥åœ¨åŸ·è¡ŒæœŸï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨çš„æ™‚å€™æŒ‡å®šè©²ç‰©ä»¶å‹æ…‹</p><p>ex:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// å®šç¾©getAnimalç‚ºå›å‚³Dog();</span><br><span class="line">x = getAnimal(); // å¾—åˆ° Dogå‹æ…‹</span><br><span class="line">x.makeSound(); // ç™¼å‡ºç‹—å«è²</span><br><span class="line"></span><br><span class="line">// å°‡getAnimal() ä¸­æ”¹æˆå‚³å›Cat();</span><br><span class="line">x = getAnimal(); // å¾—åˆ° Catå‹æ…‹</span><br><span class="line">x.makeSound(); // ç™¼å‡ºè²“å«è²</span><br></pre></td></tr></table></figure><p>:::</p><h2 id="å¯¦è¸é´¨å­çš„è¡Œç‚º"><a href="#å¯¦è¸é´¨å­çš„è¡Œç‚º" class="headerlink" title="å¯¦è¸é´¨å­çš„è¡Œç‚º"></a>å¯¦è¸é´¨å­çš„è¡Œç‚º</h2><ul><li><p>FlyBehaviorä»‹é¢ï¼Œç”¨FlyWithWings(å¯¦è¸æ‰€æœ‰æœ‰ç¿…è†€çš„é´¨å­æœƒé£›çš„è¡Œç‚º)èˆ‡FlyNoWay(å¯¦è¸æ‰€æœ‰ä¸æœƒé£›çš„é´¨å­çš„å‹•ä½œ)é€™å…©å€‹é¡åˆ¥ä¾†å¯¦ä½œ</p></li><li><p>QuackBehaviorä»‹é¢ï¼Œç”¨Quack(çœŸçš„å‘±å‘±å«)ã€Squeak(æ©¡çš®å±å±å«)èˆ‡MuteQuack(å«ä¸å‡ºè²éŸ³)é€™ä¸‰å€‹é¡åˆ¥ä¾†å¯¦ä½œ</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»¥ä¸Šè¨­è¨ˆå°‡é£›è¡Œèˆ‡å‘±å‘±å«çš„è¡Œç‚ºå¯ä»¥è¢«å…¶ä»–ç‰©ä»¶å†ä¸‰åˆ©ç”¨ï¼Œå°‡é´¨å­çš„è¡Œç‚ºæŠ½é›¢å‡ºä¾†</span><br></pre></td></tr></table></figure><h3 id="å•é¡Œèˆ‡æ€è€ƒ"><a href="#å•é¡Œèˆ‡æ€è€ƒ" class="headerlink" title="å•é¡Œèˆ‡æ€è€ƒ"></a>å•é¡Œèˆ‡æ€è€ƒ</h3><ol><li>æ˜¯å¦è©²å…ˆæŠŠç³»çµ±åšå‡ºä¾†ï¼Œåœ¨çœ‹çœ‹å“ªäº›åœ°æ–¹éœ€è¦æ›´å‹•ï¼Œå†å›é ­å°‡éœ€æ›´å‹•çš„é‚è¼¯ç¨ç«‹å‡ºä¾†ï¼Ÿ<ul><li>ç­”ï¼šä¸å„˜ç„¶ï¼Œè¨­è¨ˆç³»çµ±ä¸­å¯ä»¥é å…ˆè€ƒæ…®åˆ°æœªä¾†å“ªäº›åœ°æ–¹å¯èƒ½éœ€è¦è®Šå‹•</li></ul></li><li>é´¨å­æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥è¨­è¨ˆæˆä¸€å€‹ä»‹é¢ï¼Ÿ<ul><li>ç­”: ä¸æ°ç•¶ï¼Œå› ç‚ºå·²ç¶“å°‡æœƒè®Šå‹•çš„é‚è¼¯(flyèˆ‡quack)æŠ½é›¢å‡ºdock class, é‚£dock classå°±å¯ä»¥ç›´æ¥ç‚ºæ¯éš»é´¨å­éƒ½æœƒæœ‰åŒæ¨£é‚è¼¯çš„é¡åˆ¥ï¼Œè®“ä¸åŒé¡å‹çš„é´¨å­ç›´æ¥ç¹¼æ‰¿ä½¿ç”¨</li></ul></li></ol><h2 id="æ•´åˆé´¨å­çš„è¡Œç‚º"><a href="#æ•´åˆé´¨å­çš„è¡Œç‚º" class="headerlink" title="æ•´åˆé´¨å­çš„è¡Œç‚º"></a>æ•´åˆé´¨å­çš„è¡Œç‚º</h2><p>å°‡é£›è¡Œèˆ‡å‘±å‘±å«çš„å‹•ä½œï¼Œå§”è¨—å…¶ä»–äººè™•ç† (åœ¨Docké¡åˆ¥ä¸­å®£å‘Š FlyBehaviorèˆ‡QuackBehaviorï¼Œé€éBehaviorä»‹é¢å–å¾— æœ‰å¯¦ä½œè©²Behaviorä»‹é¢çš„è¡Œç‚ºå€‘ ex: FlyBehaviorä»‹é¢æœƒæœ‰FlyWithNoWingsé¡åˆ¥å¯¦ä½œ)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Duck &#123;</span><br><span class="line">    FlyBehavior flyBehavior;</span><br><span class="line">    QuackBehavior quackBehavior;</span><br><span class="line">    </span><br><span class="line">    public void performQuack() &#123;</span><br><span class="line">        quackBehavior.quack();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public void performFly() &#123;</span><br><span class="line">        flyBehavior.fly();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¾åœ¨ç”±ç¶ é ­é´¨(MallarDuck)ä¾†ä½¿ç”¨Duckçš„quackBehavioræ‰€æ“æœ‰çš„æœ‰å¯¦è¸è‡ªå·±çš„å­é¡åˆ¥ Quack()<br>ç”¨flyBehaviorçš„FlyWithNoWings</p><p>ä¸”MallarDuckç¹¼æ‰¿äº†Ducké¡åˆ¥ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨quackBehaviorå’ŒflyBehaviorå–ç”¨è‡ªå·±å°æ‡‰çš„å‹•ä½œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class MallardDuck extends Duck &#123;</span><br><span class="line">    // constructor</span><br><span class="line">    pubilc MallardDuck() &#123;</span><br><span class="line">        quackBehavior = new Quack();</span><br><span class="line">        flyBehavior = new FlyWithNoWings();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    quackBehavior.performQuack(); </span><br><span class="line">    flyBehavior.performFly();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å®Œæ•´æ¸¬è©¦çš„codeï¼šå¯¦ä½œä¸€å€‹MiniDuck"><a href="#å®Œæ•´æ¸¬è©¦çš„codeï¼šå¯¦ä½œä¸€å€‹MiniDuck" class="headerlink" title="å®Œæ•´æ¸¬è©¦çš„codeï¼šå¯¦ä½œä¸€å€‹MiniDuck"></a>å®Œæ•´æ¸¬è©¦çš„codeï¼šå¯¦ä½œä¸€å€‹MiniDuck</h2><h3 id="Duck-class"><a href="#Duck-class" class="headerlink" title="Duck class"></a>Duck class</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    FlyBehavior flyBehavior;</span><br><span class="line">    QuackBehavior quackBehavior;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Duck</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performFly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        flyBehavior.fly();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performQuack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        quackBehavior.quack();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"All ducks float, even decoys!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="FlyBehavior-and-QuackBehaviorä»‹é¢èˆ‡å¯¦è¸ä¹‹çš„å‹•ä½œ"><a href="#FlyBehavior-and-QuackBehaviorä»‹é¢èˆ‡å¯¦è¸ä¹‹çš„å‹•ä½œ" class="headerlink" title="FlyBehavior and QuackBehaviorä»‹é¢èˆ‡å¯¦è¸ä¹‹çš„å‹•ä½œ"></a>FlyBehavior and QuackBehaviorä»‹é¢èˆ‡å¯¦è¸ä¹‹çš„å‹•ä½œ</h3><p>FlyBehavior.inrface<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å„ç¨®å¯¦è¸Flyçš„é¡åˆ¥</p><p>FlyWithWings.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyWithWings</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am flying"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>FlyNoWay.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyNoWay</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I cannot fly"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>QuackBehavior.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å„ç¨®å¯¦è¸Quackçš„é¡åˆ¥</p><p>Quack.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Quack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Quack"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>MuteQuack.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MuteQuack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"&lt;&lt;Silence&gt;&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Squeak.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Squeak</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Squeak"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å¯¦è¸ç¶ é ­é´¨çš„é¡åˆ¥ï¼šMallardDuck-java"><a href="#å¯¦è¸ç¶ é ­é´¨çš„é¡åˆ¥ï¼šMallardDuck-java" class="headerlink" title="å¯¦è¸ç¶ é ­é´¨çš„é¡åˆ¥ï¼šMallardDuck.java"></a>å¯¦è¸ç¶ é ­é´¨çš„é¡åˆ¥ï¼šMallardDuck.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MallardDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="comment">// constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MallardDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        quackBehavior = <span class="keyword">new</span> Quack();</span><br><span class="line">        flyBehavior = <span class="keyword">new</span> FlyWithWings();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am a real Mallard duck"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¸¬è©¦ç”¨é¡åˆ¥ï¼šMiniDuckSimulator-java"><a href="#æ¸¬è©¦ç”¨é¡åˆ¥ï¼šMiniDuckSimulator-java" class="headerlink" title="æ¸¬è©¦ç”¨é¡åˆ¥ï¼šMiniDuckSimulator.java"></a>æ¸¬è©¦ç”¨é¡åˆ¥ï¼šMiniDuckSimulator.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MiniDuckSimulator</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       Duck mallard = <span class="keyword">new</span> MallardDuck();</span><br><span class="line">       </span><br><span class="line">       <span class="comment">// æœƒå‘¼å« MallardDuckç¹¼æ‰¿ä¾†çš„performQuack()</span></span><br><span class="line">       <span class="comment">// é€²è€Œå§”è¨— quackBehaviorè™•ç†quackè¡Œç‚ºï¼Œè€Œéåœ¨è‡ªå·±classå…§è™•ç†</span></span><br><span class="line">       mallard.performQuack();</span><br><span class="line">       mallard.performFly();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‹•æ…‹è¨­å®šè¡Œç‚º"><a href="#å‹•æ…‹è¨­å®šè¡Œç‚º" class="headerlink" title="å‹•æ…‹è¨­å®šè¡Œç‚º"></a>å‹•æ…‹è¨­å®šè¡Œç‚º</h2><p>åœ¨é´¨å­é¡åˆ¥ä¸­å¯ä»¥åŠ å…¥è¨­ç½®flyBehaviorå’ŒquackBehaviorçš„æ–¹æ³•</p><p>å¯ä»¥éš¨æ™‚å‘¼å«ä»¥ä¸‹æ–¹æ³•æ”¹è®Šé´¨å­çš„è¡Œç‚º<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFlyBehavior</span><span class="params">(FlyBehavior fb)</span> </span>&#123;</span><br><span class="line">       flyBehavior = fb;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuackBehavior</span><span class="params">(QuackBehavior qb)</span> </span>&#123;</span><br><span class="line">       quackBehavior = qb;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¾‹å¦‚æœ‰å€‹ â€œæ¨¡å‹é´¨â€œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ModelDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ModelDuck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        flyBehavior = <span class="keyword">new</span> FlyNoWay();</span><br><span class="line">        quackBehavior = <span class="keyword">new</span> Quack();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Model duck"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å»ºç«‹ä¸€å€‹æ–°çš„FlyBehaviorå‹æ…‹ï¼Œå…·æœ‰ç«ç®­å™´å°„çš„åŠŸèƒ½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyRocketPowered</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am flying a rocket"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ”¹è®Šæ¸¬è©¦é¡åˆ¥ï¼ŒåŠ ä¸Šæ¨¡å‹é´¨å­ï¼Œä½¿æ¨¡å‹é´¨å…·æœ‰ç«ç®­å‹•åŠ›ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MiniDuckSimulator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Duck mallard = <span class="keyword">new</span> MallardDuck();</span><br><span class="line">        ...</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å…·æœ‰å™´å°„å‹•åŠ›çš„æ¨¡å‹é´¨å­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Duck modelDuck = <span class="keyword">new</span> ModelDuck();</span><br><span class="line">        modelDuck.performFly(); <span class="comment">// ä¸æœƒé£›</span></span><br><span class="line">        <span class="comment">// å‹•æ…‹åœ°æ›´æ›é£›è¡Œçš„è¡Œç‚º</span></span><br><span class="line">        modelDuck.setFlyBehavior(<span class="keyword">new</span> FlyRocketPowered());</span><br><span class="line">        modelDuck.performFly(); <span class="comment">// å™´å°„ï¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„è¡Œç‚ºç‚ºå°‡å…©å€‹é¡åˆ¥(FlyBehaviorèˆ‡QuackBehavior)çµ„åˆèµ·ä¾†ä½¿ç”¨ï¼Œç‚ºâ€Composition åˆæˆâ€çš„ç²¾ç¥ï¼Œèˆ‡ç¹¼æ‰¿ä¸ä¸€æ¨£çš„æ˜¯ï¼Œé´¨å­Duckçš„è¡Œç‚ºä¸æ˜¯ç¹¼æ‰¿è€Œä¾†ï¼Œè€Œæ˜¯é€éé©ç•¶çš„è¡Œç‚ºç‰©ä»¶ã€åˆæˆã€è€Œä¾†ï¼</p><h3 id="è¨­è¨ˆå®ˆå‰‡"><a href="#è¨­è¨ˆå®ˆå‰‡" class="headerlink" title="è¨­è¨ˆå®ˆå‰‡"></a>è¨­è¨ˆå®ˆå‰‡</h3><p>å¤šç”¨åˆæˆï¼Œå°‘ç”¨ç¹¼æ‰¿</p><p>åˆæˆå¯ä»¥å°‡æ¼”ç®—æ³•å°è£æˆé¡åˆ¥ï¼Œæ›´å¯ä»¥ã€åœ¨åŸ·è¡Œå‹•æ…‹åœ°æ”¹è®Šè¡Œç‚ºã€ï¼Œåªè¦åˆæˆçš„è¡Œç‚ºç‰©ä»¶ï¼Œç¬¦åˆç‰¹å®šçš„ä»‹é¢æ¨™æº–å³å¯</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯ä»¥åœ¨åŸ·è¡ŒæœŸå‹•æ…‹æ›´æ›ç‰©ä»¶çš„è¡Œç‚º&lt;/p&gt;
&lt;p&gt;ã€ç­–ç•¥æ¨¡å¼ã€å®šç¾©äº†æ¼”ç®—æ³•å®¶æ—ï¼Œå°‡ä»–å€‘å€‹åˆ¥å°è£èµ·ä¾†ï¼Œå¯ä»¥è®“ä»–å€‘ä¹‹é–“äº’ç›¸æ›¿æ›ï¼Œæ­¤æ¨¡å¼ä¸æœƒå½±éŸ¿åˆ°ä½¿ç”¨æ­¤æ¼”ç®—æ³•çš„ç¨‹å¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Factory Pattern å·¥å» æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Factory-Pattern-%E5%B7%A5%E5%BB%A0%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Factory-Pattern-å·¥å» æ¨¡å¼/</id>
    <published>2020-07-26T08:57:20.000Z</published>
    <updated>2021-01-28T12:17:31.169Z</updated>
    
    <content type="html"><![CDATA[<p>å·¥å» æ¨¡å¼æä¾›äº†å¯å‰µå»º(new)å„ç¨®ä¸åŒé¡åˆ¥(class)çš„å¯¦ä¾‹(instance)</p><p>å·¥å» æ¨¡å¼ä¸»è¦åˆæ¶µè“‹äº† (1) ç°¡å–®å·¥å» æ¨¡å¼ Simple Factory Pattern (2) å·¥å» æ–¹æ³•æ¨¡å¼ (3) æŠ½è±¡æ–¹æ³•æ¨¡å¼</p><p>ç°¡å–®å·¥å» æ–¹æ³•æ˜¯æœ€åˆéšçš„ç”¨æ³•ï¼Œæœƒé•åOOPçš„Open-close principle(OCP)<br>ç„¶è€Œå·¥å» æ–¹æ³•å’ŒæŠ½è±¡æ–¹æ³•å‰‡æ¯”è¼ƒèƒ½è®“æ¨¡çµ„é–“è€¦åˆåº¦é™ä½ã€‚</p><p>ä»¥ä¸‹æœƒä¾åºåšä»‹ç´¹</p><a id="more"></a><h2 id="ç°¡å–®å·¥å» æ¨¡å¼-Simple-Factory-Method"><a href="#ç°¡å–®å·¥å» æ¨¡å¼-Simple-Factory-Method" class="headerlink" title="ç°¡å–®å·¥å» æ¨¡å¼ Simple Factory Method"></a>ç°¡å–®å·¥å» æ¨¡å¼ Simple Factory Method</h2><p>ç°¡å–®å·¥å» æ¨¡å¼åƒ…æä¾›ä¸€å€‹å·¥å» é¡åˆ¥ï¼Œæ¥æ”¶åƒæ•¸(æ±ºå®šç”Ÿç”¢å“ªç¨®ç”¢å“)ï¼Œä¾†ç”¢ç”Ÿå‡ºå°æ‡‰çš„ç”¢å“ç‰©ä»¶(Object)</p><p>ä»¥ç”Ÿç”¢Pizzaç‚ºä¾‹ï¼Œå‡è¨­æˆ‘å€‘æœ‰å€‹æŠ«è–©ç°¡å–®å·¥å» (SimplePizzaFactory)å¯ä»¥ç”Ÿç”¢å…©ç¨®ä¸åŒå£å‘³çš„Pizza(Cheeseå’ŒPotato):</p><p>SimplePizzaFactory.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimplePizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(type.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"potato"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PotatoPizza();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¥å» æœƒå›å‚³æŠ½è±¡çš„Pizzaé¡åˆ¥</p><p>Pizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line">  String ingridient;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Preparing"</span> + name);</span><br><span class="line">    System.out.println(<span class="string">"Ingredient"</span> + ingridient);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Bake for 20 mins"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»¥åŠå¯¦ä½œäº†å…©å€‹å£å‘³çš„æŠ«è–© CheesePizzaå’ŒPotatoPizza</p><p>CheesePizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  String name = <span class="string">"CheesePizza"</span>;</span><br><span class="line">  String ingridient = <span class="string">"Cheese"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>PotatoPizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PotatoPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  String name = <span class="string">"PotatoPizza"</span>;</span><br><span class="line">  String ingridient = <span class="string">"Potato"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p>Pizzaéƒ½å®šç¾©å®Œç•¢å¾Œï¼Œå®šç¾©SimplePizzaFactory.java</p><p>SimplePizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimplePizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    pizza = createPizza(type);</span><br><span class="line">    pizza.prepare();</span><br><span class="line">    pizza.bake();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(type.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"potato"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PotatoPizza();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨Main.javaé€éSimplePizzaFactoryè£½ä½œå…©å€‹Pizza:</p><p>Main.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SimplePizzaFactory simplePizzaFactory = <span class="keyword">new</span> SimplePizzaFactory();</span><br><span class="line">    </span><br><span class="line">    simplePizzaFactory.orderPizza(<span class="string">"cheese"</span>);</span><br><span class="line">    simplePizzaFactory.orderPizza(<span class="string">"potato"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åŸ·è¡ŒMain.java</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Preparing: CheesePizza</span><br><span class="line">Ingredient: Cheese</span><br><span class="line">Bake for 20 mins</span><br><span class="line">Preparing: PotatoPizza</span><br><span class="line">Ingredient: Potato</span><br><span class="line">Bake for 20 mins</span><br></pre></td></tr></table></figure><p>ä½†æ­¤è‹¥ä¹‹å¾Œè¦æ“´å……Pizzaçš„ç¨®é¡ï¼Œä¾‹å¦‚è¦å¤šä¸€å€‹å«åšOnionPizzaï¼Œå‹¢å¿…å¾—ä¿®æ”¹SimplePizzaFacotory.java</p><p>SimplePizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimplePizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    pizza = createPizza(type);</span><br><span class="line">    pizza.prepare();</span><br><span class="line">    pizza.bake();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(type.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"potato"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PotatoPizza();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"onion"</span>)) &#123; <span class="comment">// æ–°å¢æ´‹è”¥å£å‘³pizza  </span></span><br><span class="line">      pizza = <span class="keyword">new</span> OnionPizza();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>:::danger<br>ä¸Šè¿°åšæ³•ç ´å£äº†OODçš„OCP(Open-Close Principle)çš„åŸå‰‡ï¼Œäº¦å³é€²è¡Œæ“´å……æ™‚ä¸ä¿®æ”¹åˆ°SimplePizzaFactoryçš„ç¨‹å¼ç¢¼ã€‚<br>:::</p><h2 id="å·¥å» æ–¹æ³•æ¨¡å¼"><a href="#å·¥å» æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å» æ–¹æ³•æ¨¡å¼"></a>å·¥å» æ–¹æ³•æ¨¡å¼</h2><p>ç‚ºäº†æ”¹å–„ç°¡å–®å·¥å» æ¨¡å¼ï¼Œå·¥å» æ–¹æ³•æ¨¡å¼é€éâ€æŠ½è±¡æ–¹æ³•â€çš„æ¨¡å¼ï¼Œè®“ä¹‹å¾Œæ“´å……çš„å·¥å» å¯¦ä½œè©²â€æŠ½è±¡æ–¹æ³•â€ï¼Œä»¥é€²è¡Œå…¶ä»–é¡åˆ¥çš„æ“´å……</p><p>èˆ‰ä¾‹ï¼šæœ‰å€‹PizzaFactoryè² è²¬å®šç¾©äº†Pizzaå·¥å» è©²åšçš„ä¸€ä»¶äº‹(æŠ½è±¡æ–¹æ³•)<br>å«åš createPizza();</p><p>PizzaFactory.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    pizza = createPizza(type);</span><br><span class="line">    pizza.prepare();</span><br><span class="line">    pizza.bake();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸæœ¬æˆ‘å€‘å·²ç¶“æœ‰å…©ç¨®å£å‘³(Cheeseå’ŒPotato) Pizzaï¼Œå«åšåŸå‘³æŠ«è–©(OriginalPizzaFactory), ä½¿OringinalPizzaFactoryå»å¯¦ä½œPizzaFactoryçš„createPizza()æ–¹æ³•</p><p>OringinalPizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OriginalPizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(type.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"potato"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> PotatoPizza();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è‹¥è¦æ–°å¢æ´‹è”¥å£å‘³çš„Pizzaçš„è©±ï¼Œé‚£å°±ç›´æ¥åœ¨å®šç¾©ä¸€å€‹é¡å¤–çš„å·¥å» å«åšï¼Œç‰¹åˆ¥æŠ«è–©å·¥å»  (SpecialPizzaFactory)é€²è¡Œæ“´å……ï¼Œå¦‚æ­¤ä¸€ä¾†å°±ä¸ç”¨æ›´å‹•åˆ°åˆ°åŸæœ¬åŸå‘³æŠ«è–©å·¥å» (OriginalPizzaFactory)çš„ç¨‹å¼ç¢¼</p><p>SpecialPizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpecialPizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(type.equals(<span class="string">"onion"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> OnionPizza();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¨˜å¾—å¤šæ–°å¢ä¸€å€‹æ´‹è”¥æŠ«è–©çš„é¡åˆ¥ </p><p>OnionPizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OnionPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">OnionPizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    name = <span class="string">"OnionPizza"</span>;</span><br><span class="line">    ingridient = <span class="string">"Onion"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨Main.javaä¸­å‘¼å«åŸå‘³å’Œç‰¹åˆ¥å£å‘³çš„æŠ«è–©</p><p>Main.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    PizzaFactory originalPizzaFactory = <span class="keyword">new</span> OriginalPizzaFactory();</span><br><span class="line">    </span><br><span class="line">    originalPizzaFactory.orderPizza(<span class="string">"cheese"</span>);</span><br><span class="line">    originalPizzaFactory.orderPizza(<span class="string">"potato"</span>);</span><br><span class="line"></span><br><span class="line">    PizzaFactory specialPizzaFactory = <span class="keyword">new</span> SpecialPizzaFactory();</span><br><span class="line">    specialPizzaFactory.orderPizza(<span class="string">"onion"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€éä¸‹é¢çš„åœ–å¯ä»¥çœ‹åˆ°ï¼Œé€éå®šç¾©ä¸€å€‹æŠ½è±¡æ–¹æ³•çš„å·¥å» ï¼Œè‹¥è¦æ“´å……ç”¢å“(åœ¨é€™è£¡æˆ‘å€‘ç”¨çš„æ˜¯Pizza)é¡åˆ¥çš„è©±ï¼Œé€éå¯¦ä½œè©²æŠ½è±¡æ–¹æ³•å·¥å» ï¼Œä¾†é€²è¡Œæ“´å……ã€‚</p><p><img src="https://i.imgur.com/cmWuZ3v.png" alt=""></p><p>ç”±æ–¼æˆ‘å€‘äº¦æŠŠPizzaé¡åˆ¥çµ¦ç¨ç«‹å‡ºä¾†æˆç‚ºä¸€å€‹æŠ½è±¡é¡åˆ¥ï¼Œè‹¥è¦æ–°å¢å…¶ä»–å£å‘³çš„Pizzaä¹Ÿå¯ä»¥é”åˆ°ä¸é•åOCPç²¾ç¥çš„æ“´å……ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p><p><img src="https://i.imgur.com/Wp4QRfE.png" alt=""></p><h2 id="æŠ½è±¡å·¥å» "><a href="#æŠ½è±¡å·¥å» " class="headerlink" title="æŠ½è±¡å·¥å» "></a>æŠ½è±¡å·¥å» </h2><p>æŠ½è±¡å·¥å» é¡§åæ€ç¾©å°±æ˜¯å®šç¾©ä¸€å€‹æŠ½è±¡ä»‹é¢å·¥å» ï¼Œæ¬²æ“´å……çš„è©±å°±å¯¦ä½œè©²æŠ½è±¡ä»‹é¢å·¥å» </p><p>ä»¥æŠ«è–©åŸæ–™å·¥å» (PizzaIngredientFactory)ç‚ºä¾‹ï¼Œæœ‰é†¬æ–™å’Œè”¬èœå…©ç¨®åŸæ–™ï¼š<br>æ–¹é¢çµ¦ä¹‹å¾Œæˆ‘å€‘è¦è£½ä½œçš„ä¸­å¼å’Œç¾å¼æŠ«è–©çš„åŸæ–™å¯¦ä½œï¼Œåšæ“´å±•ï¼š</p><p>PizzaIngredientFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PizzaIngredientFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Sauce <span class="title">createSauce</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Vegetable <span class="title">createVegetable</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h3 id="æŠ½è±¡å·¥å» -åŸæ–™å·¥å» -åœ¨é€éå·¥å» æ–¹æ³•ä¾†è£½ä½œåŸæ–™ç”¢å“"><a href="#æŠ½è±¡å·¥å» -åŸæ–™å·¥å» -åœ¨é€éå·¥å» æ–¹æ³•ä¾†è£½ä½œåŸæ–™ç”¢å“" class="headerlink" title="æŠ½è±¡å·¥å» (åŸæ–™å·¥å» )åœ¨é€éå·¥å» æ–¹æ³•ä¾†è£½ä½œåŸæ–™ç”¢å“"></a>æŠ½è±¡å·¥å» (åŸæ–™å·¥å» )åœ¨é€éå·¥å» æ–¹æ³•ä¾†è£½ä½œåŸæ–™ç”¢å“</h3><p>æˆ‘å€‘å†åˆ†åˆ¥ç”¢ç”Ÿç¾å¼ç‰ˆæœ¬(AmericaIngredientFactory)å’Œä¸­å¼ç‰ˆæœ¬(ChinesePizzaFactory)çš„æŠ«è–©åŸæ–™å·¥å» ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†createSauceå’ŒcreateVegetableï¼Œé€éå·¥å» æ–¹æ³•ä¾†ç”¢ç”ŸåŸæ–™ç”¢å“</p><p>AmericaIngredientFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AmericaIngredientFactory</span> <span class="keyword">implements</span> <span class="title">PizzaIngredientFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Sauce <span class="title">createSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> TomatoSauce();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Vegetable <span class="title">createVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Potato();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ChineseIngredientFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChineseIngredientFactory</span> <span class="keyword">implements</span> <span class="title">PizzaIngredientFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Sauce <span class="title">createSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SoySauce();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Vegetable <span class="title">createVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Onion();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p>æ¥è‘—å®šç¾©å‰›å‰›åŸæ–™å·¥å» æœ‰ä½¿ç”¨åˆ°çš„åŸæ–™é¡åˆ¥å€‘(Sauce: SoySauceèˆ‡PotatoSauce; Vegetable: Onionå’ŒPotatoï¼Œè©²åŸæ–™äº¦åœ¨å¯¦ä½œPizzaé¡åˆ¥çš„å…·é«”é¡åˆ¥äº¦æœƒç”¨åˆ°</p><p>:::info<br>Pizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// åœ¨Pizzaé¡åˆ¥ä¸­å·²ç¶“æœ‰å®£å‘Šæœƒç”¨åˆ°çš„åŸæ–™æœ‰å“ªäº›ï¼Œæ˜¯ä»¥ä»‹é¢ä¾†å¯¦ä½œï¼Œæ–¹ä¾¿åšæ“´å±•</span></span><br><span class="line">  Sauce sauce;</span><br><span class="line">  Vegetable vegetable;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>:::</p><p>å®šç¾©é†¬æ–™SauceåŸæ–™å€‘ï¼š</p><p>Sauce.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Sauce</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getSauce</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>SoySauce.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SoySauce</span> <span class="keyword">extends</span> <span class="title">Sauce</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SoySauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"soy sauce"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"The sauce is :"</span> + name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>TomatoSauce.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TomatoSauce</span> <span class="keyword">extends</span> <span class="title">Sauce</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TomatoSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    name = <span class="string">"tomato sauce"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"The sauce is :"</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹ä¾†æ›å®šç¾©VegetableåŸæ–™å€‘</p><p>Vegetable.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Vegetable</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getVegetable</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Onion.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Onion</span> <span class="keyword">extends</span> <span class="title">Vegetable</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Onion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    name = <span class="string">"onion"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"The vegetable is :"</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Potato.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Potato</span> <span class="keyword">extends</span> <span class="title">Vegetable</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Potato</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    name = <span class="string">"potato"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"The vegetable is :"</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p>å°‡æŠ«è–©ä¿®æ”¹æˆåŒ…å«ä¸Šè¿°åŸæ–™ (Sauceå’ŒVegetable)</p><p>Pizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  String name;</span><br><span class="line">  </span><br><span class="line">  Sauce sauce;</span><br><span class="line">  Vegetable vegetable;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å°‡prepareä¿®æ”¹æˆæŠ½è±¡ï¼Œè©²æ–¹æ³•éœ€è¦æ”¶é›†Pizzaæ‰€éœ€çš„åŸæ–™ï¼ŒåŸæ–™ä¾†è‡ªæ–¼åŸæ–™å·¥å» ï¼</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Bake for 30 mins"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®šç¾©å…©å€‹styleçš„Pizza: ä¸­å¼æŠ«è–©(Chinese Pizza)å’Œç¾å¼æŠ«è–©(America Pizza)ï¼Œåœ¨é€™å…©éš»é¡åˆ¥å¯ä»¥çœ‹åˆ°æˆ‘å€‘å‚³å…¥äº†åŸæ–™å·¥å» ï¼Œä»¥æ±ºå®šå“ªç¨®é¢¨æ ¼çš„æŠ«è–©å°±ç”¨å°æ‡‰é¢¨æ ¼çš„åŸæ–™å·¥å» </p><p>ChinesePizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChinesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  PizzaIngredientFactory ingredientFactory;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ChinesePizza</span><span class="params">(PizzaIngredientFactory ingredientFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.ingredientFactory = ingredientFactory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Preparing: "</span> + name);</span><br><span class="line"></span><br><span class="line">    sauce = ingredientFactory.createSauce();</span><br><span class="line">    sauce.getSauce();</span><br><span class="line"></span><br><span class="line">    vegetable = ingredientFactory.createVegetable();</span><br><span class="line">    vegetable.getVegetable();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>AmericaPizza.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AmericaPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">  PizzaIngredientFactory ingredientFactory;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">AmericaPizza</span><span class="params">(PizzaIngredientFactory ingredientFactory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.ingredientFactory = ingredientFactory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Preparing: "</span> + name);</span><br><span class="line"></span><br><span class="line">    sauce = ingredientFactory.createSauce();</span><br><span class="line">    sauce.getSauce();</span><br><span class="line"></span><br><span class="line">    vegetable = ingredientFactory.createVegetable();</span><br><span class="line">    vegetable.getVegetable();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p>æ¥è‘—å†åˆ©ç”¨å·¥å» æ–¹æ³•ï¼Œå®šç¾©ä¸­å¼å’Œç¾å¼çš„æŠ«è–©å·¥å» ï¼Œè£½ä½œå‡ºä¸­å¼å’Œç¾å¼çš„æŠ«è–©</p><p>PizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    pizza = createPizza(type);</span><br><span class="line">    pizza.prepare();</span><br><span class="line">    pizza.bake();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>AmericaPizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AmericaPizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Pizza <span class="title">createPizza</span><span class="params">(String style)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨äº†ç¾å¼åŸæ–™å·¥å» </span></span><br><span class="line">    PizzaIngredientFactory ingredientFactory = <span class="keyword">new</span> AmericaIngredientFactory();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(style.equals(<span class="string">"America"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> AmericaPizza(ingredientFactory);</span><br><span class="line">      pizza.setName(<span class="string">"America style pizza"</span>);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>:::info<br>å¯ä»¥åœ¨å°ç¾å¼å·¥å» æ–°å¢å…¶ä»–ç¨®ä¸åŒå£å‘³çš„Pizzaï¼Œç”¨ä¸åŒçš„åŸæ–™å·¥å» ä¾†é”æˆ<br>:::</p><p>ChinesePizzaFactory.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChinesePizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">protected</span> Pizza <span class="title">createPizza</span><span class="params">(String style)</span> </span>&#123;</span><br><span class="line">    Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨äº†ä¸­å¼åŸæ–™å·¥å» </span></span><br><span class="line">    PizzaIngredientFactory ingredientFactory = <span class="keyword">new</span> ChineseIngredientFactory();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(style.equals(<span class="string">"Chinese"</span>)) &#123;</span><br><span class="line">      pizza = <span class="keyword">new</span> ChinesePizza(ingredientFactory);</span><br><span class="line">      pizza.setName(<span class="string">"Chinese style pizza"</span>);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pizza;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p>æœ€å¾Œåœ¨Main.javaä¸­ä¾†è£½ä½œæŠ«è–©ï¼š</p><p>Main.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    PizzaFactory AmericaPizzaFactory = <span class="keyword">new</span> AmericaPizzaFactory();</span><br><span class="line">    </span><br><span class="line">    AmericaPizzaFactory.orderPizza(<span class="string">"America"</span>);</span><br><span class="line"></span><br><span class="line">    PizzaFactory ChinesePizzaFactory = <span class="keyword">new</span> ChinesePizzaFactory();</span><br><span class="line"></span><br><span class="line">    ChinesePizzaFactory.orderPizza(<span class="string">"Chinese"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æŠ½è±¡å·¥å» æ–¹æ³•å¯ä»¥å¹«æˆ‘å€‘æŠŠç›¸é—œç”¢å“é›†çµèµ·ä¾†(ä¸Šè¿°ä¾‹å­ç‚ºåŸæ–™å€‘)ï¼Œå¯ä»¥ç”¢ç”Ÿå‡ºä¸åŒçµ„çš„åŸæ–™é¡åˆ¥å€‘ï¼Œå¦å¤–æŠ½è±¡å·¥å» é€šå¸¸é‚„æœƒå†æ­é…å·¥å» æ–¹æ³•ï¼Œä¾†å»ºç«‹å…¶ç”¢å“(æŠ«è–©å€‘ï¼Œå„å€‹æŠ«è–©æœƒç”¨åˆ°å„å€‹ä¸åŒçš„æŠ½è±¡å·¥å» æ‰€å»ºç«‹çš„åŸæ–™å·¥å» )ï¼Œå¦‚åŒè©²é€£çµæ‰€åšçš„-&gt;<a href="#æŠ½è±¡å·¥å» (åŸæ–™å·¥å» ">é€£çµ</a>åœ¨é€éå·¥å» æ–¹æ³•ä¾†è£½ä½œåŸæ–™ç”¢å“)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·¥å» æ¨¡å¼æä¾›äº†å¯å‰µå»º(new)å„ç¨®ä¸åŒé¡åˆ¥(class)çš„å¯¦ä¾‹(instance)&lt;/p&gt;
&lt;p&gt;å·¥å» æ¨¡å¼ä¸»è¦åˆæ¶µè“‹äº† (1) ç°¡å–®å·¥å» æ¨¡å¼ Simple Factory Pattern (2) å·¥å» æ–¹æ³•æ¨¡å¼ (3) æŠ½è±¡æ–¹æ³•æ¨¡å¼&lt;/p&gt;
&lt;p&gt;ç°¡å–®å·¥å» æ–¹æ³•æ˜¯æœ€åˆéšçš„ç”¨æ³•ï¼Œæœƒé•åOOPçš„Open-close principle(OCP)&lt;br&gt;ç„¶è€Œå·¥å» æ–¹æ³•å’ŒæŠ½è±¡æ–¹æ³•å‰‡æ¯”è¼ƒèƒ½è®“æ¨¡çµ„é–“è€¦åˆåº¦é™ä½ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æœƒä¾åºåšä»‹ç´¹&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Singleton Pattern ç¨é«”æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Singleton-Pattern-%E7%8D%A8%E9%AB%94%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/26/Design-Pattern-Java-Singleton-Pattern-ç¨é«”æ¨¡å¼/</id>
    <published>2020-07-26T08:56:27.000Z</published>
    <updated>2021-01-28T12:24:58.355Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯æ¬¡å¼•ç”¨é¡åˆ¥éƒ½åªæœƒç”¢å‡ºç›¸åŒçš„ç‰©ä»¶</p><p>é©åˆç”¨åœ¨: åŸ·è¡Œç·’æ± (thread pool)ï¼Œå¿«å–å€(cache)ï¼Œå°è©±ç›’ã€è™•ç†å°è©±è¨­å®šå’Œç™»éŒ„çš„ç‰©ä»¶ï¼Œå’Œé©…å‹•ç¨‹å¼æºé€šçš„ç‰©ä»¶ã€‚</p><a id="more"></a><h2 id="ä½œæ³•"><a href="#ä½œæ³•" class="headerlink" title="ä½œæ³•"></a>ä½œæ³•</h2><p>å‡å¦‚æœ‰ä¸€å€‹é¡åˆ¥å«åšMyClassï¼Œç¾åœ¨è¦è®“MyClassè®Šæˆç¨é«”æ¨¡å¼ï¼Œè®“å¤–é¢çš„é¡åˆ¥åªèƒ½é€é MyClass.getInstance() å–å¾—MyClassç‰©ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¨­å®šæˆprivateèˆ‡staticï¼Œä¸èƒ½çµ¦å¤–é¢é¡åˆ¥å­˜å–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MyClass uniqueInstance;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°‡å»ºæ§‹å¼è¨­å®šæˆ privateï¼Œé€™æ¨£å°±å¯ä»¥é¿å…ç›´æ¥è¢«é¡åˆ¥ newå‡ºä¾†</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MyClass</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¨­ç½®æˆstaticï¼Œä½¿å¤–é¢é¡åˆ¥å¯ä»¥ç›´æ¥å­˜å–MyClass.getInstanceæ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyClass <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è‹¥ç¬¬ä¸€æ¬¡å–å¾—MyClassï¼Œ new å‡ºMyClass();</span></span><br><span class="line">        <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            uniqueInstance = <span class="keyword">new</span> MyClass();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä»–é¡åˆ¥è¦å–ç”¨MyClass</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String args[]) &#123;</span><br><span class="line">    // 1. ç¬¬ä¸€æ¬¡å–ç”¨getInstance</span><br><span class="line">    Myclass instance = MyClass.getInstance();</span><br><span class="line">    // 2. ç¬¬äºŒæ¬¡å–ç”¨getInstanceæ™‚ï¼ŒMyClassçš„uniqueInstanceå·²ç¶“æœ‰å€¼äº†ï¼Œå¾—åˆ°èˆ‡ä¸Šé¢instanceä¸€æ¨£çš„object</span><br><span class="line">    Myclass instance1 = MyClass.getInstance();</span><br><span class="line">    </span><br><span class="line">    if(instance == instance1) &#123;</span><br><span class="line">        System.out.println(&quot;instance and instance1 are the same&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šåŸ·è¡Œç·’ä¸‹ç¨é«”æ¨¡å¼æœƒé‡åˆ°çš„ç‹€æ³"><a href="#å¤šåŸ·è¡Œç·’ä¸‹ç¨é«”æ¨¡å¼æœƒé‡åˆ°çš„ç‹€æ³" class="headerlink" title="å¤šåŸ·è¡Œç·’ä¸‹ç¨é«”æ¨¡å¼æœƒé‡åˆ°çš„ç‹€æ³"></a>å¤šåŸ·è¡Œç·’ä¸‹ç¨é«”æ¨¡å¼æœƒé‡åˆ°çš„ç‹€æ³</h2><p>å‡å¦‚æœ‰å…©å€‹thread(thread 1å’Œthread 2)ï¼ŒåŒæ™‚è¦è·ŸMyClasså–å¾—ç‰©ä»¶ï¼Œä½†æœƒé¢è‡¨thread1å’Œthread2æœƒå–å¾—ä¸åŒçš„MyClassç‰©ä»¶ï¼Œæƒ…æ³å¦‚ä¸‹ï¼š</p><p><img src="https://i.imgur.com/OjAKXpb.png" alt=""></p><h3 id="è§£æ³•ä¸€ï¼šåªè¦æŠŠgetInstance-çµ¦åŒæ­¥åŒ–-æœƒæœ‰æ•ˆèƒ½ä¸ä½³çš„ç‹€æ³ï¼Œå¯èƒ½é€ æˆæ•ˆç‡ä¸‹é™100å€"><a href="#è§£æ³•ä¸€ï¼šåªè¦æŠŠgetInstance-çµ¦åŒæ­¥åŒ–-æœƒæœ‰æ•ˆèƒ½ä¸ä½³çš„ç‹€æ³ï¼Œå¯èƒ½é€ æˆæ•ˆç‡ä¸‹é™100å€" class="headerlink" title="è§£æ³•ä¸€ï¼šåªè¦æŠŠgetInstance()çµ¦åŒæ­¥åŒ– (æœƒæœ‰æ•ˆèƒ½ä¸ä½³çš„ç‹€æ³ï¼Œå¯èƒ½é€ æˆæ•ˆç‡ä¸‹é™100å€)"></a>è§£æ³•ä¸€ï¼šåªè¦æŠŠgetInstance()çµ¦åŒæ­¥åŒ– (æœƒæœ‰æ•ˆèƒ½ä¸ä½³çš„ç‹€æ³ï¼Œå¯èƒ½é€ æˆæ•ˆç‡ä¸‹é™100å€)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MyClass uniqueInstance;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MyClass</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¨­å®šæˆsynchronizedï¼Œå°±å¯ä»¥è®“åŸ·è¡Œç·’ä¾åºé€²å…¥getInstanceå…§</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> MyClass <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(uniqueInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            uniqueInstance = <span class="keyword">new</span> MyClass();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æˆ‘å€‘åªéœ€è¦ç¬¬ä¸€æ¬¡é€²å…¥getInstanceæ‰é€²è¡ŒåŒæ­¥åŒ–å°±å¥½ï¼Œä¸ç„¶å…¶ä»–æ¬¡è¦å–å¾—uniqueInstnaceéƒ½å¾—è®ŠæˆåŒæ­¥çš„æ–¹å¼ï¼Œé€ æˆå–ç”¨Instanceçš„ç·©æ…¢</p><h3 id="è§£æ³•äºŒï¼šç‡å…ˆå»ºç«‹å¯¦é«”ï¼Œä¸è¦ç­‰åˆ°æœ‰äººå‘¼å«getInstanceæ‰newå‡ºMyClasså¯¦é«”"><a href="#è§£æ³•äºŒï¼šç‡å…ˆå»ºç«‹å¯¦é«”ï¼Œä¸è¦ç­‰åˆ°æœ‰äººå‘¼å«getInstanceæ‰newå‡ºMyClasså¯¦é«”" class="headerlink" title="è§£æ³•äºŒï¼šç‡å…ˆå»ºç«‹å¯¦é«”ï¼Œä¸è¦ç­‰åˆ°æœ‰äººå‘¼å«getInstanceæ‰newå‡ºMyClasså¯¦é«”"></a>è§£æ³•äºŒï¼šç‡å…ˆå»ºç«‹å¯¦é«”ï¼Œä¸è¦ç­‰åˆ°æœ‰äººå‘¼å«getInstanceæ‰newå‡ºMyClasså¯¦é«”</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç›´æ¥åˆå§‹è©±MyClass()ï¼Œä¸¦è¨­æˆprivate</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MyClass uniqueInstnace = <span class="keyword">new</span> MyClass();</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MyClass</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyClass <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤ä½œæ³•ä¾è³´JVMè¼‰å…¥æ­¤é¡åˆ¥æ™‚ï¼Œé¦¬ä¸Šå»ºç«‹æ­¤å”¯ä¸€çš„ç¨é«”ç‰©ä»¶ï¼ŒJVMä¿è­‰åœ¨ä»»ä½•åŸ·è¡Œç·’å­˜å–uniqueInstnaceéœæ…‹è®Šæ•¸ä¹‹å‰ï¼Œä¸€å®šå…ˆå»ºç«‹æ­¤å¯¦é«”</p><h3 id="è§£æ³•ä¸‰ï¼šåˆ©ç”¨-â€œé›™é‡æª¢æŸ¥ä¸Šé–â€-åœ¨getInstance-ä¸­æ¸›å°‘ä½¿ç”¨åŒæ­¥åŒ–"><a href="#è§£æ³•ä¸‰ï¼šåˆ©ç”¨-â€œé›™é‡æª¢æŸ¥ä¸Šé–â€-åœ¨getInstance-ä¸­æ¸›å°‘ä½¿ç”¨åŒæ­¥åŒ–" class="headerlink" title="è§£æ³•ä¸‰ï¼šåˆ©ç”¨ â€œé›™é‡æª¢æŸ¥ä¸Šé–â€ åœ¨getInstance()ä¸­æ¸›å°‘ä½¿ç”¨åŒæ­¥åŒ–"></a>è§£æ³•ä¸‰ï¼šåˆ©ç”¨ â€œé›™é‡æª¢æŸ¥ä¸Šé–â€ åœ¨getInstance()ä¸­æ¸›å°‘ä½¿ç”¨åŒæ­¥åŒ–</h3><p>åˆ©ç”¨é›™é‡æª¢æŸ¥ä¸Šé–ï¼Œé¦–å…ˆæª¢æŸ¥æ˜¯å¦å¯¦é«”å·²ç¶“å»ºç«‹äº†ï¼Œ<br>è‹¥æ²’æœ‰ï¼Œâ€œæ‰â€é€²è¡ŒåŒæ­¥åŒ–ï¼Œå¦‚æ­¤ä¸€ä¾†åªæœ‰ç¬¬ä¸€æ¬¡é€²å…¥getInstanceæ‰åŒæ­¥åŒ–ï¼Œæ‰æ˜¯æˆ‘å€‘æ‰€æƒ³è¦çš„ã€‚</p><p><code>`</code>java=<br>public class MyClass {<br>    // volatileç‚ºJava 6ä¹‹å¾Œæ‰æœ‰çš„é—œéµå­—ï¼Œèƒ½å¤ ä½¿åŸ·è¡Œç·’å€‘å–å¾—ç›¸åŒçš„uniqueInstance<br>    private volatile static MyClass uniqueInstance;</p><pre><code>private MyClass() {}public static MyClass getInstance() {    // åªæœ‰ç¬¬ä¸€æ¬¡æ‰å¾¹åº•åŸ·è¡Œä»¥ä¸‹ç¨‹å¼ç¢¼     // ç•¶åŸ·è¡Œç·’é‡åˆ°è¢«å®£å‘Šæˆvolatileçš„uniqueInstnaceï¼Œæœƒè®Šå¾—è¬¹æ…    if(uniqueInstance == null) {        synchronized(MyClass.class) {            // å†æª¢æŸ¥ä¸€æ¬¡ï¼Œè‹¥ç‚ºnullå‰‡new MyClass();            if(uniqueInstance == null) {                uniqueInstance = new MyClass();            }        }    }    return uniqueInstance;}</code></pre><p>}</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯æ¬¡å¼•ç”¨é¡åˆ¥éƒ½åªæœƒç”¢å‡ºç›¸åŒçš„ç‰©ä»¶&lt;/p&gt;
&lt;p&gt;é©åˆç”¨åœ¨: åŸ·è¡Œç·’æ± (thread pool)ï¼Œå¿«å–å€(cache)ï¼Œå°è©±ç›’ã€è™•ç†å°è©±è¨­å®šå’Œç™»éŒ„çš„ç‰©ä»¶ï¼Œå’Œé©…å‹•ç¨‹å¼æºé€šçš„ç‰©ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Command Pattern å‘½ä»¤æ¨¡å¼ [Design Pattern in Java]</title>
    <link href="http://a10000005588.github.io/2020/07/26/Design-Pattern-Command-Pattern-%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    <id>http://a10000005588.github.io/2020/07/26/Design-Pattern-Command-Pattern-å‘½ä»¤æ¨¡å¼/</id>
    <published>2020-07-26T08:52:42.000Z</published>
    <updated>2021-01-28T12:17:01.716Z</updated>
    
    <content type="html"><![CDATA[<p>å‘½ä»¤æ¨¡å¼ä¸»è¦å°‡åŸ·è¡Œçš„å‘½ä»¤, èˆ‡åŸ·è¡Œè€…åšé¬†ç¶çš„å‹•ä½œ</p><a id="more"></a><h2 id="æ²’æœ‰å‘½ä»¤æ¨¡å¼æœƒæ˜¯æ€æ¨£çš„å¯«æ³•ï¼Ÿï¼Ÿ"><a href="#æ²’æœ‰å‘½ä»¤æ¨¡å¼æœƒæ˜¯æ€æ¨£çš„å¯«æ³•ï¼Ÿï¼Ÿ" class="headerlink" title="æ²’æœ‰å‘½ä»¤æ¨¡å¼æœƒæ˜¯æ€æ¨£çš„å¯«æ³•ï¼Ÿï¼Ÿ"></a>æ²’æœ‰å‘½ä»¤æ¨¡å¼æœƒæ˜¯æ€æ¨£çš„å¯«æ³•ï¼Ÿï¼Ÿ</h2><p>å‡å¦‚æˆ‘å€‘ç¾åœ¨è¦å¯«ä¸€å€‹ é™æ§å™¨ RemoteControl (åŸ·è¡Œè€…), ä¸Šé¢æœƒæœ‰å¾ˆå¤šæŒ‰éˆ•åŠŸèƒ½ (å‘½ä»¤)</p><p>æ¯å€‹æŒ‰éˆ•å¯èƒ½éƒ½å°æ‡‰å„å€‹åŠŸèƒ½, ä¾‹å¦‚ æ‰“é–‹, é—œé–‰æŸäº›æˆ¿é–“çš„ç‡ˆ</p><p>æ–¼æ˜¯æˆ‘å€‘å®šç¾©äº† <code>Light</code> æŠ½è±¡é¡åˆ¥, æœ‰è‘— <code>on()</code>èˆ‡<code>off()</code>é–‹é—œç‡ˆçš„æ–¹æ³•, ä¸¦ä¸”å¯¦ä½œäº† <code>LivingRoomLight</code>, <code>KitchenLight</code>é€™å…©å€‹æˆ¿é–“ä¸¦ç¹¼æ‰¿ <code>Light</code>æŠ½è±¡é¡åˆ¥çš„æ–¹æ³•, ä½¿ä»–å€‘éƒ½æœ‰é–‹é—œçš„åŠŸèƒ½ï¼</p><p>æ¥è‘—åœ¨é™æ§å™¨ <code>RemoteControl</code>é¡åˆ¥å…§å®šç¾©äº† <code>Light[]</code> é™£åˆ—, å„²å­˜æ¬²åŸ·è¡Œçš„åŠŸèƒ½ (å¯¦ä½œLightçš„é¡åˆ¥å€‘)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å®šç¾©å‡ºä¸€å€‹é™æ§å™¨instance</span></span><br><span class="line">        RemoteControl remoteControl =</span><br><span class="line">                <span class="keyword">new</span> RemoteControl(</span><br><span class="line">                <span class="keyword">new</span> Light[]&#123;</span><br><span class="line">                        <span class="keyword">new</span> LivingRoomLight(),</span><br><span class="line">                        <span class="keyword">new</span> KitchenLight()</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 0: æ‰“é–‹LivingRoom Light</span></span><br><span class="line">        <span class="comment">// 1: æ‰“é–‹Kitchen Light</span></span><br><span class="line">        remoteControl.turnOnLight(<span class="number">0</span>);</span><br><span class="line">        remoteControl.turnOnLight(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 0: é—œé–‰LivingRoom Light</span></span><br><span class="line">        <span class="comment">// 1: é—œé–‰Kitchen Light</span></span><br><span class="line">        remoteControl.turnOffLight(<span class="number">0</span>);</span><br><span class="line">        remoteControl.turnOffLight(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Light[] lights = <span class="keyword">new</span> Light[<span class="number">10</span>];</span><br><span class="line">    RemoteControl(Light[] lights) &#123;</span><br><span class="line">        <span class="comment">// å°‡å‚³é€²ä¾†çš„lightsæ”¾å…¥åˆ°lightså…§</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;lights.length; i++) &#123;</span><br><span class="line">            <span class="keyword">this</span>.lights[i] = lights[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOnLight</span><span class="params">(<span class="keyword">int</span> buttonNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lights[buttonNumber].on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOffLight</span><span class="params">(<span class="keyword">int</span> buttonNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lights[buttonNumber].off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    Light() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LivingRoomLight</span> <span class="keyword">extends</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    LivingRoomLight() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the living room light"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn off the living room light"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KitchenLight</span> <span class="keyword">extends</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    KitchenLight() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the kitchen light"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn off the kitchem light"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸ·è¡Œçµæœå¦‚ä¸‹</p><p><img src="https://i.imgur.com/AvxerGU.png" alt=""></p><h3 id="å•é¡Œ"><a href="#å•é¡Œ" class="headerlink" title="å•é¡Œ"></a>å•é¡Œ</h3><p>å‡å¦‚ç¾åœ¨åˆæƒ³è¦æ·»åŠ é›»è¦–èˆ‡å†·æ°£é–‹é—œçš„åŠŸèƒ½ <code>TV</code>, <code>AirConditioner</code>, é‚£ä¸å°±åˆè¦åœ¨<code>RemoteControl</code>é¡åˆ¥å…§é€²è¡Œä¿®æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆæ–°å¢äº†HomeDeviceé™£åˆ—...å®šç¾©å®¶å…·é›†åˆçš„é¡åˆ¥</span></span><br><span class="line">    HomeDevice[] homeDevices = <span class="keyword">new</span> HomeDevice[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">    Light[] lights = <span class="keyword">new</span> Light[<span class="number">10</span>];</span><br><span class="line">    RemoteControl(Light[] lights) &#123;</span><br><span class="line">        <span class="comment">// å°‡å‚³é€²ä¾†çš„lightsæ”¾å…¥åˆ°lightså…§</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;lights.length; i++) &#123;</span><br><span class="line">            <span class="keyword">this</span>.lights[i] = lights[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOnLight</span><span class="params">(<span class="keyword">int</span> buttonNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lights[buttonNumber].on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOffLight</span><span class="params">(<span class="keyword">int</span> buttonNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lights[buttonNumber].off();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆåœ¨å®šç¾©HomeDeviceçš„é–‹é—œåŠŸèƒ½...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯çœ‹åˆ°æ¯æ¬¡è‹¥è¦ç‚ºé™æ§å™¨é¡åˆ¥æ–°å¢åŠŸèƒ½, éƒ½è¦å°<code>RemoteControl</code>é€²è¡Œä¿®æ”¹çš„å‹•ä½œ, å¦‚æ­¤ä¸€ä¾†å¯èƒ½æœƒé€ æˆå…¶ä»–å·²ç¶“å…§åµŒå¥½çš„åŠŸèƒ½å¯èƒ½è¢«æ”¹å£çš„ç‹€æ³ç™¼ç”Ÿ, é€™æ™‚æˆ‘å€‘å¯ä»¥ä½¿ç”¨ <code>Command æ¨¡å¼</code> ä¾†é¿å…é€™ç¨®ç‹€æ³ç™¼ç”Ÿ</p><h2 id="Command-å‘½ä»¤æ¨¡å¼çš„å„ªå‹¢"><a href="#Command-å‘½ä»¤æ¨¡å¼çš„å„ªå‹¢" class="headerlink" title="Command å‘½ä»¤æ¨¡å¼çš„å„ªå‹¢"></a>Command å‘½ä»¤æ¨¡å¼çš„å„ªå‹¢</h2><p>å‘½ä»¤æ¨¡å¼å¯ä»¥å¹«æˆ‘å€‘æŠŠè¦è³¦äºˆ<code>RemoteControl</code>çš„é€™äº›åŠŸèƒ½çµ¦å°è£èµ·ä¾†, æˆç‚ºä¸€å€‹ç¨ç«‹çš„å€‹é«”, ä¸æœƒè·Ÿ<code>RemoteControl</code>çµ¦è€¦åˆå†ä¸€èµ· (åƒä¸Šé¢turnOnLight, turnOffLightç­‰åŠŸèƒ½)</p><p>æˆ‘å€‘å¯ä»¥æŠŠ <code>Light</code> çš„é–‹é—œåŠŸèƒ½éƒ½è¦–ä½œç‚º <code>Command (å‘½ä»¤)</code>æŠ½è±¡ä»‹é¢, è©²ä»‹é¢åŒ…å«äº†ä¸€å€‹ <code>execute()</code>åŠŸèƒ½, </p><p>æ¥è‘—ç”±Command (å‘½ä»¤)è¡ä¼¸å‡º <code>LightOnCommand</code>èˆ‡<code>LightOffCommand</code>é€™å…©å€‹å¯¦ä½œé¡åˆ¥, è² è²¬å®šç¾©<code>Light</code>çš„é–‹èˆ‡é—œçš„å‹•ä½œ</p><p><img src="https://i.imgur.com/t1zF1vQ.jpg" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šç¾©ä¸€å€‹å‘½ä»¤, åŒ…å«çš„åŸ·è¡Œexecuteçš„å‹•ä½œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¦ä½œç‡ˆçš„é–‹é—œå‘½ä»¤</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn on the light"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn off the light"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LightOnCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    Light light;</span><br><span class="line"></span><br><span class="line">    LightOnCommand() &#123;</span><br><span class="line">        <span class="keyword">this</span>.light = <span class="keyword">new</span> Light();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.on();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LightOffCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    Light light;</span><br><span class="line"></span><br><span class="line">    LightOffCommand() &#123;</span><br><span class="line">        <span class="keyword">this</span>.light = <span class="keyword">new</span> Light();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    NoCommand() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Not yet defined"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥è‘—æˆ‘å€‘éœ€è¦åœ¨é™æ§å™¨é¡åˆ¥ <code>RemoteControl</code> å®šç¾©å¯æ”¾ç½®Commandçš„å‹•ä½œ <code>setXXXCommand()</code>, ä»¥åŠå‘¼å«Commandçš„ <code>pressOnButton()</code>èˆ‡<code>pressOffButton()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šç¾©é™æ§å™¨é¡åˆ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RemoteControl</span> </span>&#123;</span><br><span class="line">    Command[] onCommands = <span class="keyword">new</span> Command[<span class="number">7</span>];</span><br><span class="line">    Command[] offCommands = <span class="keyword">new</span> Command[<span class="number">7</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€é–‹å§‹çš„æ’æ§½, è‹¥æ²’åŠŸèƒ½å°±å®šç¾©ä¸€å€‹æ²’ä½œç”¨çš„commandä¾›å‘¼å« (å¯é¿å…ç”¨ if (command != null) é€™ç¨®åˆ¤æ–·æ–¹å¼</span></span><br><span class="line">    RemoteControl() &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">7</span>; i++) &#123;</span><br><span class="line">            onCommands[i] = <span class="keyword">new</span> NoCommand();</span><br><span class="line">            offCommands[i] = <span class="keyword">new</span> NoCommand();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnCommand</span><span class="params">(<span class="keyword">int</span> slot, Command onCommand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.onCommands[slot] = onCommand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOffCommand</span><span class="params">(<span class="keyword">int</span> slot, Command offCommand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.offCommands[slot] = offCommand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pressOnButton</span><span class="params">(<span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.onCommands[slot].execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pressOffButton</span><span class="params">(<span class="keyword">int</span> slot)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.offCommands[slot].execute();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¡¯ç¤ºæˆ‘å€‘å¡äº†å“ªäº›åŠŸèƒ½åˆ°slotå…§</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuffer stringBuff = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        stringBuff.append(<span class="string">"\n ------- Remote Control-------\n"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; onCommands.length; i++) &#123;</span><br><span class="line">            stringBuff.append(<span class="string">"[slot "</span> + i + <span class="string">"] "</span> + onCommands[i].getClass().getName() + <span class="string">"    "</span> + offCommands[i].getClass().getName() + <span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stringBuff.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€éé€™æ¨£çš„åšæ³•, æˆ‘å€‘å¯ä»¥çœ‹åˆ°åŸæœ¬<code>RemoteControl</code>å…§çš„èˆ‡Lightæ“ä½œæœ‰é—œçš„å‹•ä½œ, éƒ½è¢«æˆ‘å€‘é€é <code>Command</code> æŠ½è±¡ä»‹é¢ä»¥åŠå…¶ <code>LightOnCommand</code>èˆ‡<code>LightOffCommand</code>å¯¦ä½œé¡åˆ¥çµ¦æŠ½é›¢å‡ºä¾†äº†</p><p>æ–¼æ˜¯æˆ‘å€‘å¯ä»¥ä¾†åŸ·è¡Œçœ‹çœ‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RemoteControl remoteControl = <span class="keyword">new</span> RemoteControl();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šç¾©å‡ºå…©ç¨®æˆ¿é–“çš„ç‡ˆ</span></span><br><span class="line">        Light LivingRoomLight = <span class="keyword">new</span> Light(<span class="string">"Living Room"</span>);</span><br><span class="line">        Light KitchenLight = <span class="keyword">new</span> Light(<span class="string">"Kitchen"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¨­ç½®CommandæŒ‰éˆ•</span></span><br><span class="line">        remoteControl.setOnCommand(<span class="number">0</span>, <span class="keyword">new</span> LightOnCommand(LivingRoomLight));</span><br><span class="line">        remoteControl.setOffCommand(<span class="number">0</span>, <span class="keyword">new</span> LightOffCommand(LivingRoomLight));</span><br><span class="line"></span><br><span class="line">        remoteControl.setOnCommand(<span class="number">1</span>, <span class="keyword">new</span> LightOnCommand(KitchenLight));</span><br><span class="line">        remoteControl.setOffCommand(<span class="number">1</span>, <span class="keyword">new</span> LightOffCommand(KitchenLight));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é¡¯ç¤ºæœ‰å“ªäº›åŠŸèƒ½</span></span><br><span class="line">        System.out.println(remoteControl.toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŸ·è¡Œå‘½ä»¤</span></span><br><span class="line">        <span class="comment">//// å®¢å»³çš„</span></span><br><span class="line">        remoteControl.pressOnButton(<span class="number">0</span>);</span><br><span class="line">        remoteControl.pressOffButton(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//// å»šæˆ¿çš„</span></span><br><span class="line">        remoteControl.pressOnButton(<span class="number">1</span>);</span><br><span class="line">        remoteControl.pressOffButton(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.imgur.com/q9PTG18.png" alt=""></p><p>è‹¥æ¥ä¸‹ä¾†éœ€è¦æ–°å¢å¦‚æµ´å®¤é–‹é—œ, é›»è¦–é–‹é—œ, åªè¦é€é<code>RemoteConrol</code>çš„<code>setCommand()</code>æ–¹æ³•, å³å¯ä»¥å‹•æ…‹åšè¨­ç½®, ä¸éœ€æ›´å‹•åˆ°é™æ§å™¨é¡åˆ¥åŸæœ¬çš„ç¨‹å¼ç¢¼ï¼ (é™¤éè¦æ”¹è®Šé™æ§å™¨çš„slotå¤§å°äº†)</p><h2 id="é€²éšçš„Command-PatternæŠ€å·§"><a href="#é€²éšçš„Command-PatternæŠ€å·§" class="headerlink" title="é€²éšçš„Command PatternæŠ€å·§"></a>é€²éšçš„Command PatternæŠ€å·§</h2><p>ç­‰å¾…è£œå…… (ç‚ºCommandä»‹é¢æ–°å¢ undo()æ–¹æ³•, ä½¿å‹•ä½œå¾©åŸ)</p><h2 id="æ‡‰ç”¨å ´æ™¯"><a href="#æ‡‰ç”¨å ´æ™¯" class="headerlink" title="æ‡‰ç”¨å ´æ™¯"></a>æ‡‰ç”¨å ´æ™¯</h2><p>é‹ç”¨åœ¨ä»»å‹™åºåˆ—ä¸­, å¤šåŸ·è¡Œç·’åªè¦æ‹¿åˆ°Commandç‰©ä»¶, ä¸¦ä¸”åŸ·è¡Œ<code>execute</code>æ–¹æ³•è² è²¬åŸ·è¡Œå®Œå°±å¥½</p><p>æˆ–æ˜¯ç”¨åœ¨æ—¥èªŒç®¡ç†, å°‡åŸ·è¡Œéçš„å‹•ä½œçµ¦è¨˜éŒ„èµ·ä¾†, ä¸¦ä¸”è‹¥å¾ŒçºŒä¼ºæœå™¨ç•¶æ©Ÿ, å¯å°‡å‘½ä»¤çµ¦å¾©åŸ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘½ä»¤æ¨¡å¼ä¸»è¦å°‡åŸ·è¡Œçš„å‘½ä»¤, èˆ‡åŸ·è¡Œè€…åšé¬†ç¶çš„å‹•ä½œ&lt;/p&gt;
    
    </summary>
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/categories/Design-Pattern/"/>
    
    
      <category term="Design Pattern" scheme="http://a10000005588.github.io/tags/Design-Pattern/"/>
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>ä¸‹ç­è‡ªä¿®çš„ç¶“é©—åˆ†äº«</title>
    <link href="http://a10000005588.github.io/2020/05/16/%E4%B8%8B%E7%8F%AD%E8%87%AA%E4%BF%AE%E7%9A%84%E7%B6%93%E9%A9%97%E5%88%86%E4%BA%AB/"/>
    <id>http://a10000005588.github.io/2020/05/16/ä¸‹ç­è‡ªä¿®çš„ç¶“é©—åˆ†äº«/</id>
    <published>2020-05-16T12:47:39.000Z</published>
    <updated>2021-01-28T12:13:44.948Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å‰›å¥½åœ¨Backendç‰ˆä¸Šçœ‹åˆ°æœ‰äººPoæ–‡å•èªª: â€œä¸‹ç­å¾Œè¦å¦‚ä½•ç²¾é€²è‡ªä¿®â€, æ„å¤–çœ‹åˆ°è¨±å¤šå¤§å¤§å€‘åœ¨ä¸‹é¢ç•™è¨€, æ­£å¥½æœ€è¿‘æˆ‘ä¹Ÿåœ¨æ€è€ƒè¦å¦‚ä½•ç²¾é€²è‡ªå·±, æ‰€ä»¥è¶é€™æ©Ÿæœƒä¾†çµ±æ•´ä¸€ä¸‹å¤§å¤§å€‘æå‡ºä¾†çš„æƒ³æ³•ä¸¦ä¸”èˆ‡è‡ªå·±ç›®å‰çš„é€²ä¿®æ–¹å¼åšçµåˆ, ä¸»è¦æœƒä»¥Full-Stack engineerçš„ç²¾é€²æ–¹å¼ä¾†åšå€‹ç´€éŒ„åˆ†äº«.</p><a id="more"></a><h2 id="å¦‚æœå°æŸç¨‹å¼èªè¨€-amp-æ¡†æ¶æŒæ¡åº¦é‚„ä¸å¤ -è«‹å…ˆç†Ÿæ‚‰ä¹‹ï¼"><a href="#å¦‚æœå°æŸç¨‹å¼èªè¨€-amp-æ¡†æ¶æŒæ¡åº¦é‚„ä¸å¤ -è«‹å…ˆç†Ÿæ‚‰ä¹‹ï¼" class="headerlink" title="å¦‚æœå°æŸç¨‹å¼èªè¨€&amp;æ¡†æ¶æŒæ¡åº¦é‚„ä¸å¤ , è«‹å…ˆç†Ÿæ‚‰ä¹‹ï¼"></a>å¦‚æœå°æŸç¨‹å¼èªè¨€&amp;æ¡†æ¶æŒæ¡åº¦é‚„ä¸å¤ , è«‹å…ˆç†Ÿæ‚‰ä¹‹ï¼</h2><p>å¦‚æœä¸Šç­æ¥è§¸åˆ°æŸç¨®è‡ªå·±ä¸ç†Ÿæ‚‰çš„èªè¨€æˆ–æ¡†æ¶, åƒæˆ‘ç›®å‰éœ€è¦å¯«Java &amp; Spring, èˆ‡Angular &amp; Typescript.</p><p>æ‰€ä»¥æˆ‘æœƒåå¥½å…ˆåˆ°ç·šä¸Šç¨‹å¼èªè¨€ç·šä¸Šå¹³å°é€²ä¿®ä¹‹, å› ç‚ºé€™äº›å­¸ç¿’å¹³å°èƒ½å¤ æä¾›å®Œæ•´çš„å­¸ç¿’è¼ªå»“, èƒ½å¤ è®“æˆ‘å¿«é€ŸæŒæ¡è©²ç¨‹å¼èªè¨€&amp;æ¡†æ¶æ‰€éœ€å…·å‚™çš„ç¡¬çŸ¥è­˜ç‚ºä½•.</p><p>èªªåˆ°ç·šä¸Šç¨‹å¼å­¸ç¿’å¹³å°, æˆ‘è »æ¨è–¦ <a href="https://app.pluralsight.com/" target="_blank" rel="noopener">Pluralsight</a>, å› ç‚ºè©²å¹³å°æä¾›äº†è©²ç¨‹å¼èªè¨€æˆ–æ¡†æ¶æ¨è–¦å­¸ç¿’çš„å½±ç‰‡, ä¸¦ä¸”é€éæ¸¬é©—æ¨ä¼°ä½ å°è©²æŠ€è¡“çš„çŸ¥è­˜ç¨‹åº¦ç‚ºä½•.</p><p><img src="https://i.imgur.com/2vtrkLm.png" alt=""></p><p>æœ‰èˆˆè¶£å¯ä»¥åˆ°è©²å¹³å°è©¦è©¦çœ‹, ä¸éæ¯å€‹æœˆæœƒæ”¶å–29ç¾å…ƒçš„èŠ±è²», ä¸éé€™èŠ±è²»ç•¶ä½œæŠ•è³‡æ˜¯è »å€¼å¾—çš„.</p><h2 id="è‹¥å·²ç¶“å°ç¨‹å¼èªè¨€-amp-æ¡†æ¶æœ‰ç¶“é©—-å¯ä»¥å˜—è©¦çœ‹çœ‹Side-Project"><a href="#è‹¥å·²ç¶“å°ç¨‹å¼èªè¨€-amp-æ¡†æ¶æœ‰ç¶“é©—-å¯ä»¥å˜—è©¦çœ‹çœ‹Side-Project" class="headerlink" title="è‹¥å·²ç¶“å°ç¨‹å¼èªè¨€&amp;æ¡†æ¶æœ‰ç¶“é©—, å¯ä»¥å˜—è©¦çœ‹çœ‹Side Project"></a>è‹¥å·²ç¶“å°ç¨‹å¼èªè¨€&amp;æ¡†æ¶æœ‰ç¶“é©—, å¯ä»¥å˜—è©¦çœ‹çœ‹Side Project</h2><p>ç‚ºä»€éº¼æœƒç‰¹åœ°æåˆ°Side Project?? é‚£æ˜¯å› ç‚ºåœ¨å…¬å¸å…¶å¯¦å¾ˆé›£è‡ªå·±èƒ½å¤ è² è²¬å°ˆæ¡ˆçš„æ‰€æœ‰å…¨è²Œ, ä¾‹å¦‚å¯èƒ½åªæ˜¯è² è²¬å¯«API, ä¹Ÿå¯èƒ½åªè² è²¬å‰ç«¯é é¢çš„åˆ»ç•«.</p><p>æ‰€ä»¥é€éSide Project, ä¾¿èƒ½å¤ æœ‰æ©Ÿæœƒå˜—è©¦æ‰€æœ‰æŠ€è¡“çš„æ©Ÿæœƒ, ä¸¦ä¸”å¾ä¸­å»é«”æœƒåˆ°è‡ªå·±æœ€æƒ³è¦åŠ å¼·çš„é ˜åŸŸæ˜¯å“ªé‚Š, ä¾‹å¦‚å¾Œç«¯æ•ˆèƒ½? å‰ç«¯æ¸²æŸ“é€Ÿåº¦? Container, CI/CDçš„é‹ä½œ? è«¸å¦‚æ­¤é¡, å¾è€ŒåŸ¹é¤Šä¸€å€‹Full-Stackçš„ç¶“é©—.</p><p>æ‰€ä»¥ä¸‹ç­å¾Œè‡ªå·±è·‘ä¸€å€‹Side Projectæ˜¯å€‹ä¸éŒ¯çš„ç²¾é€²æ–¹å¼.</p><h3 id="ä½†è¦æ€éº¼æ¨£æƒ³å‡ºä¸€å€‹Side-Project"><a href="#ä½†è¦æ€éº¼æ¨£æƒ³å‡ºä¸€å€‹Side-Project" class="headerlink" title="ä½†è¦æ€éº¼æ¨£æƒ³å‡ºä¸€å€‹Side Project?"></a>ä½†è¦æ€éº¼æ¨£æƒ³å‡ºä¸€å€‹Side Project?</h3><p>æˆ‘è¦ºå¾—å­¸ç¿’æœ€å¿«çš„æ–¹å¼å°±æ˜¯æ¨¡ä»¿, å¯ä»¥åˆ°Githubä¸Šæœå°‹æœ‰èˆˆè¶£çš„å°ˆæ¡ˆ, ä¸¦ä¸”è©¦è‘—ç”¨è‡ªå·±çš„ç¨‹å¼èªè¨€èˆ‡æ¡†æ¶è‡ªå·±åšå‡ºä¸€å¥—æ˜¯æœ€å¿«çš„æ–¹å¼.</p><p>åƒæˆ‘å› ç‚ºå¾ˆå–œæ­¡ç”¨Markdownæ–¹å¼ä¾†åšç­†è¨˜, ç›®å‰æ‰“ç®—è‡ªå·±åšå€‹å°å‹çš„ç·šä¸Šç­†è¨˜ç·¨è¼¯ç³»çµ±, ä¸¦çœ‹åˆ°Githubä¸Šæœ‰æä¾›<a href="https://github.com/codimd/server" target="_blank" rel="noopener">CodiMD</a> çš„é–‹æºå°ˆæ¡ˆå¯åƒè€ƒ,<br>ä¾†è©¦è‘—è‡ªå·±å»ºé€ å‡ºä¸€å€‹çœ‹çœ‹. ä¹‹å¾Œæœ‰æ©Ÿæœƒå†åˆ†äº«åˆ°è‡ªå·±çš„éƒ¨è½æ ¼ä¸Šæ€éº¼ä¸€æ­¥ä¸€æ­¥é€²è¡Œçš„.</p><h2 id="å˜—è©¦æ’°å¯«ç·šä¸Šç­†è¨˜æˆ–éƒ¨è½æ ¼å§"><a href="#å˜—è©¦æ’°å¯«ç·šä¸Šç­†è¨˜æˆ–éƒ¨è½æ ¼å§" class="headerlink" title="å˜—è©¦æ’°å¯«ç·šä¸Šç­†è¨˜æˆ–éƒ¨è½æ ¼å§"></a>å˜—è©¦æ’°å¯«ç·šä¸Šç­†è¨˜æˆ–éƒ¨è½æ ¼å§</h2><p>æˆ‘èªç‚ºç¾åœ¨æŠ€è¡“çœŸçš„å¤ªå¤šå¤ªå¤šäº†, å¦‚æœæ²’æœ‰å°‡è‡ªå·±çœ‹éçš„æŠ€è¡“æ–‡ç« æˆ–å­¸ç¿’å½±ç‰‡çµ¦æ¶ˆåŒ–å’Œè¨˜éŒ„èµ·ä¾†, å¾ˆå¿«å°±åˆæœƒå¿˜è¨˜. æ‰€ä»¥æœ€å¥½çš„æ–¹å¼æ˜¯æœ‰å€‹åšç­†è¨˜çš„ç¿’æ…£!</p><p>åšç­†è¨˜çš„è©±æˆ‘éƒ½æ˜¯ç”¨Hackmdå…ˆè¨˜éŒ„èµ·ä¾†, ä¹‹å¾Œç­‰æœ‰ç©ºçš„æ™‚é–“æœƒå†æ¶ˆåŒ–å¯©è¦–è‡ªå·±å¯«éçš„å…§å®¹, ä¸¦ç™¼ä½ˆåˆ°è‡ªå·±çš„Blogerä¸Š, é€™æ¨£æœ‰åŠ©æ–¼å°‡å­¸ç¿’éçš„çŸ¥è­˜çµ¦å…§åŒ–åˆ°è‡ªå·±çš„è…¦æµ·ä¸­.</p><h2 id="å…¶ä»–æ›´é€²éšçš„é€²ä¿®æ–¹æ³•"><a href="#å…¶ä»–æ›´é€²éšçš„é€²ä¿®æ–¹æ³•" class="headerlink" title="å…¶ä»–æ›´é€²éšçš„é€²ä¿®æ–¹æ³•"></a>å…¶ä»–æ›´é€²éšçš„é€²ä¿®æ–¹æ³•</h2><h3 id="æ ¹æ“šæŠ€èƒ½æ¨¹-RoadMap-ä¾†è£œå……è‡ªå·±æœ€å¸¸ç”¨-æœ‰èˆˆè¶£ä½†æ‰€ç¼ºä¹çš„è§€å¿µèˆ‡æŠ€è¡“"><a href="#æ ¹æ“šæŠ€èƒ½æ¨¹-RoadMap-ä¾†è£œå……è‡ªå·±æœ€å¸¸ç”¨-æœ‰èˆˆè¶£ä½†æ‰€ç¼ºä¹çš„è§€å¿µèˆ‡æŠ€è¡“" class="headerlink" title="æ ¹æ“šæŠ€èƒ½æ¨¹(RoadMap)ä¾†è£œå……è‡ªå·±æœ€å¸¸ç”¨,æœ‰èˆˆè¶£ä½†æ‰€ç¼ºä¹çš„è§€å¿µèˆ‡æŠ€è¡“"></a>æ ¹æ“šæŠ€èƒ½æ¨¹(RoadMap)ä¾†è£œå……è‡ªå·±æœ€å¸¸ç”¨,æœ‰èˆˆè¶£ä½†æ‰€ç¼ºä¹çš„è§€å¿µèˆ‡æŠ€è¡“</h3><p>é€™ç¶²ç«™<a href="https://roadmap.sh/roadmaps" target="_blank" rel="noopener">Roadmap</a>æä¾›äº†å„é–‹ç™¼è€…(Frontend, Backend, DevOps)æ‰€éœ€è¦å…·å‚™çš„æŠ€èƒ½æ¨¹ç‚ºä½•<br>, è‹¥æƒ³è¦å¾€å¾Œç«¯ç²¾é€², å¯ä»¥çœ‹åˆ°ä¸‹é¢é€™å¼µåœ–æœƒç¢°åˆ°å“ªäº›æ‰€éœ€å…·å‚™çš„èƒ½åŠ›.</p><p><img src="https://i.imgur.com/tGdhgGX.png" alt=""></p><p>çœ‹å®Œä¹‹å¾Œæœƒç™¼è¦ºæœ‰å¤ªå¤šæ±è¥¿éœ€è¦Coveräº†, å­¸æµ·ç„¡æ¶¯ (èŒ¶).</p><h3 id="ç¶“ç‡Ÿ-Stackoverflow"><a href="#ç¶“ç‡Ÿ-Stackoverflow" class="headerlink" title="ç¶“ç‡Ÿ Stackoverflow"></a>ç¶“ç‡Ÿ Stackoverflow</h3><p>é€™é»æ˜¯æˆ‘çœ‹åˆ°å¤§å¤§å€‘æå‡ºä¾†å¯ä»¥å˜—è©¦çš„æ–¹å¼, ä¸éæˆ‘ç›®å‰ä¹Ÿåªæœ‰åœ¨Stackoverflowä¸Šé¢å•å¹¾å€‹å°å•é¡Œ, å°é€™æ–¹é¢é‚„æ²’æœ‰æ¶‰ç•¥, å¯åƒè€ƒä¸‹é¢å¤§å¤§æ‰€å¯«çš„Stackoverflowçš„ä»‹ç´¹, æœªä¾†æˆ‘æœƒæƒ³åœ¨é€™é‚Šå˜—è©¦çœ‹çœ‹èƒ½ä¸èƒ½ä¹Ÿè©¦è‘—å›ç­”åˆ¥äººé‡åˆ°çš„å•é¡Œ.</p><p><a href="https://lab.howie.tw/2019/04/learn-from-stackoverflow.html?fbclid=IwAR2VuMNEjP8gvE-IFa69zJZaHNROM8-pj8dgt0-641gcjGwmkCNuBzNal8k" target="_blank" rel="noopener">å·¥ç¨‹å¸«é›éŠæ¥è»Œä¸–ç•Œçš„èƒ½åŠ›å¾stackoverflow é–‹å§‹ - é˜¿è²å¥½å¨çš„å¯¦é©—å®¤</a></p><h2 id="å°çµ"><a href="#å°çµ" class="headerlink" title="å°çµ"></a>å°çµ</h2><p>ä¸‹ç­å¾Œè¦å†è‡ªä¿®çœŸçš„éœ€è¦æœ‰èˆˆè¶£ä½¿ç„¶ä»¥åŠå¼·å¤§çš„æ¯…åŠ›, å¦å‰‡å¾ˆå®¹æ˜“å°±æœƒåŠé€”è€Œå»¢.</p><p>æ‰€ä»¥æœ€é‡è¦çš„é‚„æ˜¯è¦è®“è‡ªå·±æœ‰å€‹è¦åŠƒ, ä¸¦ä¸”å¾å¯¦è¸è¦åŠƒä¸­å…§åŒ–æˆè‡ªå·±çš„æ—¥å¸¸ç¿’æ…£, ä¹…è€Œä¹…ä¹‹å°±æœƒè®“è‡ªå·±è®Šå¾—æ›´å¼·çš„ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘å‰›å¥½åœ¨Backendç‰ˆä¸Šçœ‹åˆ°æœ‰äººPoæ–‡å•èªª: â€œä¸‹ç­å¾Œè¦å¦‚ä½•ç²¾é€²è‡ªä¿®â€, æ„å¤–çœ‹åˆ°è¨±å¤šå¤§å¤§å€‘åœ¨ä¸‹é¢ç•™è¨€, æ­£å¥½æœ€è¿‘æˆ‘ä¹Ÿåœ¨æ€è€ƒè¦å¦‚ä½•ç²¾é€²è‡ªå·±, æ‰€ä»¥è¶é€™æ©Ÿæœƒä¾†çµ±æ•´ä¸€ä¸‹å¤§å¤§å€‘æå‡ºä¾†çš„æƒ³æ³•ä¸¦ä¸”èˆ‡è‡ªå·±ç›®å‰çš„é€²ä¿®æ–¹å¼åšçµåˆ, ä¸»è¦æœƒä»¥Full-Stack engineerçš„ç²¾é€²æ–¹å¼ä¾†åšå€‹ç´€éŒ„åˆ†äº«.&lt;/p&gt;
    
    </summary>
    
      <category term="Life" scheme="http://a10000005588.github.io/categories/Life/"/>
    
    
      <category term="Mindset" scheme="http://a10000005588.github.io/tags/Mindset/"/>
    
  </entry>
  
  <entry>
    <title>Spring Security åŠŸèƒ½ä»‹ç´¹</title>
    <link href="http://a10000005588.github.io/2020/04/11/Spring-Security%E4%BB%8B%E7%B4%B9/"/>
    <id>http://a10000005588.github.io/2020/04/11/Spring-Securityä»‹ç´¹/</id>
    <published>2020-04-11T13:34:23.000Z</published>
    <updated>2020-08-03T14:32:05.404Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Security-åŠŸèƒ½ä»‹ç´¹"><a href="#Spring-Security-åŠŸèƒ½ä»‹ç´¹" class="headerlink" title="Spring Security åŠŸèƒ½ä»‹ç´¹"></a>Spring Security åŠŸèƒ½ä»‹ç´¹</h1><p>å…ˆä»‹ç´¹ä»¥ä¸‹å¸¸ç”¨èªè­‰åŠŸèƒ½</p><a id="more"></a><h2 id="User-name-password-åŸºæœ¬èªè­‰"><a href="#User-name-password-åŸºæœ¬èªè­‰" class="headerlink" title="User name / password åŸºæœ¬èªè­‰"></a>User name / password åŸºæœ¬èªè­‰</h2><p>ä½¿ç”¨ä½¿ç”¨è€…åç¨±/å¯†ç¢¼åšé©—è­‰</p><h2 id="SSO-Okta-LDAP"><a href="#SSO-Okta-LDAP" class="headerlink" title="SSO / Okta / LDAP"></a>SSO / Okta / LDAP</h2><h3 id="SSO-Single-Sign-On"><a href="#SSO-Single-Sign-On" class="headerlink" title="SSO (Single Sign On)"></a>SSO (Single Sign On)</h3><p>ç‚ºOAuthçš„è¿‘ä¸€æ­¥å¯¦ç¾ï¼Œè‹¥å·²ç¶“é€éGoogleå–å¾—token, å°±å¯ä»¥åœ¨å…¶ä»–æœå‹™çš„å°ç¶²ç«™ï¼Œéƒ½ä½¿ç”¨Googleæä¾›çš„èº«ä»½é©—è­‰æœå‹™</p><h3 id="Okta"><a href="#Okta" class="headerlink" title="Okta"></a>Okta</h3><p>å”åŠ©éç‡Ÿåˆ©çµ„ç¹”çš„æ–¹å¼ã€‚å¾åŸºæœ¬çš„å–®ä¸€ç™»å…¥ï¼ˆsingle sign-onï¼Œç°¡ç¨±ç‚º SSOï¼‰åˆ°é€²éšçš„èº«ä»½èªè­‰å’Œå­˜å–æ¬Šé™çš„ç®¡ç†æ–¹æ¡ˆ</p><h3 id="LDAP-Lightweight-Directory-Access-Protocol"><a href="#LDAP-Lightweight-Directory-Access-Protocol" class="headerlink" title="LDAP (Lightweight Directory Access Protocol)"></a>LDAP (Lightweight Directory Access Protocol)</h3><p>ç‚ºä¸€ç¨®è¼•é‡çš„ç›®éŒ„æœå‹™å”å®šï¼Œåƒæ˜¯é€šè¨ŠéŒ„ä¸€æ¨£ç´€éŒ„äººå“¡è³‡è¨Šï¼Œå¯ä»¥æ‹¿ä¾†åšå¸³è™Ÿæ•´åˆ,é©—è­‰ã€‚</p><p>LDAPç›®éŒ„æœå‹™é€šå¸¸æœ‰å±¤ç´šçµæ§‹ï¼Œåƒæ˜¯å…¬å¸çµ„ç¹”éšå±¤</p><h2 id="OAuth-Intra-App-Authorization"><a href="#OAuth-Intra-App-Authorization" class="headerlink" title="OAuth (Intra App Authorization)"></a>OAuth (Intra App Authorization)</h2><p>OAuthè®“ç”¨æˆ¶å¯ä»¥æˆæ¬Šç¬¬ä¸‰æ–¹ç¶²ç«™å­˜å–ä»–å€‘åœ¨å¦å¤–æœå‹™æä¾›è€…(ex: Facebook, Line)çš„æŸäº›ç‰¹å®šè³‡è¨Šï¼Œè€Œéæ‰€æœ‰å…§å®¹ã€‚</p><h3 id="ç‚ºä»€éº¼æœ‰OAuthå‡ºç¾ï¼Ÿ"><a href="#ç‚ºä»€éº¼æœ‰OAuthå‡ºç¾ï¼Ÿ" class="headerlink" title="ç‚ºä»€éº¼æœ‰OAuthå‡ºç¾ï¼Ÿ"></a>ç‚ºä»€éº¼æœ‰OAuthå‡ºç¾ï¼Ÿ</h3><p>å› ç‚ºå„å€‹ç¶²ç«™éƒ½åšæœƒå“¡æ©Ÿåˆ¶å¾ˆéº»ç…©ï¼Œä¸”å°ç¶²ç«™å¯èƒ½æœ‰è³‡å®‰é¢¨éšªã€‚</p><p>æ•…å¤§ç¶²ç«™åƒæ˜¯Facebook, Lineæ—©å·²ç¶“åšå¥½è¶…ç´šå®‰å…¨çš„æœƒå“¡ç®¡ç†æ©Ÿåˆ¶ï¼Œå¤§ç¶²ç«™å¹«ä½ ç®¡ç†å€‹è³‡ï¼Œæä¾›ç™»å…¥çš„æœå‹™ã€‚</p><p>ä½†æä¾›é€™æ¨£æœå‹™çš„å¤§å» è¶Šä¾†è¶Šå¤šï¼Œè‹¥å°ç¶²ç«™åŒæ™‚è¦æä¾›ç”¨æˆ¶é€£çµåˆ°å¤šå€‹æœ‰æä¾›èº«åˆ†æœå‹™çš„å¤§ç¶²ç«™æœƒè®Šå¾—å¾ˆè¤‡é›œï¼Œæ–¼æ˜¯å°±è¨‚å®šçš„å·¥æ¥­æ¨™æº–ï¼šOAuth.</p><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><ul><li>é€²å…¥å°ç¶²ç«™ -&gt;   </li><li>è·³è½‰åˆ°å¤§ç¶²ç«™ç™»å…¥ç•«é¢ -&gt;  </li><li>ç™»å…¥æˆåŠŸå¤§ç¶²ç«™çµ¦äºˆä¸€å€‹æœ‰æ™‚æ•ˆçš„token çµ¦å°ç¶²ç«™ -&gt; </li><li>å°ç¶²ç«™é€étokenè·Ÿå¤§ç¶²ç«™ç´¢å–ç”¨æˆ¶çš„è³‡è¨Š (é€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æ¯æ¬¡ç™»å…¥ç¬¬ä¸‰æ–¹éƒ½æœƒè©¢å•ä½ æ˜¯å¦è¦æ­éœ²ä»¥ä¸‹è³‡è¨Šçµ¦å°ç¶²ç«™)</li></ul><p>ä¸éä¸€èˆ¬å°ç¶²ç«™â€ç„¡æ³•â€ç›´æ¥å–å¾—token, è€Œæ˜¯å–å¾—ä¸€å€‹code, å†ç”¨é€™å€‹codeå‘å¤§ç¶²ç«™æ›å¾—ä¸€å€‹token<br>(å¤šé€™é“æ‰‹çºŒçš„åŸå› æ˜¯å› ç‚ºï¼ŒInternetå¯èƒ½æœƒè¢«è·¯ä¸Šç¶“æ‰‹çš„routeræˆ–å…¶ä»–è¨­å‚™æ“·å–,å½é€ ,è®Šæ›´)</p><h3 id="å¯¦éš›æƒ…æ³"><a href="#å¯¦éš›æƒ…æ³" class="headerlink" title="å¯¦éš›æƒ…æ³"></a>å¯¦éš›æƒ…æ³</h3><p>åœ¨ Line Loginæ™‚, Line Notifyä¸­ï¼Œçµ„å‡ºä¸€å€‹URLï¼Œå–å¾—Authorization Code, é€™ä¸€æ®µå–å¾—çš„Codeç‚ºæ˜ç¢¼, èµ°çš„æ˜¯http getï¼Œé€éç€è¦½å™¨ç¶²å€åˆ—ä¾†å‚³é (è‹¥æ²’æœ‰ç”¨SSLå‚³éçš„è©±ï¼Œæœƒè¢«ä»»ä½•äººæ“·å–çœ‹åˆ°). </p><p>æ¥ä¸‹ä¾†å°ç¶²ç«™å–å¾—Authorization Codeå¾Œï¼Œåœ¨é€éhttp postï¼Œå¾å¾Œç«¯è·Ÿå¤§ç¶²ç«™æ›å¾—token (å› ç‚ºèµ°å¾Œç«¯ å¤§ç¶²ç«™å°±çŸ¥é“å°ç¶²ç«™çš„èº«ä»½å’Œæ‰€æ‹¿çš„code)</p><p>:::warning<br>OAuthä¸»è¦åŠŸèƒ½æ˜¯æˆæ¬Šï¼Œä¸æ˜¯èªè­‰ï¼Œæ‰€ä»¥å¾Œä¾†æ‰å»¶ä¼¸å‡ºOpenID Connect (OIDC)ä¾†æä¾›èªè­‰ç”¨ã€‚<br>:::<br>:::info<br>Authentication æª¢æŸ¥ç™¼é€æª¢æŸ¥äººçš„èº«ä»½æ˜¯èª°ã€æ˜¯å¦åˆæ ¼;<br>Authorization å‰‡æ˜¯è¦ç¯„ä½¿ç”¨è€…æ¬Šé™çš„è¦å‰‡ï¼Œè¦å®šå“ªäº›èƒ½åšã€å“ªäº›ä¸èƒ½</p><p>å› æ­¤å¦‚æœè©² Request æœªå¸¶ token æˆ–æ˜¯ token éæœŸã€ä¸åˆæ³•çš†ç®—æ˜¯ Authentication Error ï¼Œè·Ÿ http status code çš„ 401 æ„æ€ä¸€æ¨£ ; </p><p>å¦‚æœ Request çš„ token èªè­‰æˆåŠŸä½†æ˜¯è©²ä½¿ç”¨è€…çš„æ¬Šé™ä¸è¶³ä»¥åŸ·è¡Œè©² Request å‰‡æ˜¯ Forbidden Error (å³ å›  Authorization ç™¼ç”Ÿçš„éŒ¯èª¤) ï¼Œå¦‚ http status code çš„ 403 æ„æ€ç›¸åŒã€‚</p><p>:::</p><p>:::success<br>å–®ç´”ç”¨å¤§ç¶²ç«™çš„OAuthç•¶è‡ªå·±çš„æœƒå“¡ç³»çµ±é‚„æ˜¯æœ‰å¾ˆå¤§çš„å•é¡Œ<br>æœ€æ˜é¡¯çš„æ˜¯ç•¶ä½¿ç”¨è€…åŒæ™‚æœ‰Google èˆ‡ Facebookçš„å¸³è™Ÿæ™‚<br>å…©å€‹å¸³è™Ÿä¸Šé¢çš„Emailå¯èƒ½ä¸æ˜¯ä¸€æ¨£çš„<br>è‡ªå·±çš„ç¶²ç«™å¾ˆå¯èƒ½ç„¡æ³•è¾¨èªé€™æ˜¯åŒä¸€å€‹äººçš„å¸³æˆ¶<br>æ‰€ä»¥ä¸€èˆ¬é‚„æ˜¯æœƒéœ€è¦è‡ªå·±çš„æœƒå“¡ç³»çµ±åšæ•´åˆ<br>:::</p><h3 id="Microservice-security-using-tokens-JWT"><a href="#Microservice-security-using-tokens-JWT" class="headerlink" title="Microservice security (using tokens, JWT)"></a>Microservice security (using tokens, JWT)</h3><p>JWT (JSON web token):</p><ul><li>JWTåŸºæ–¼JSONçš„é–‹æ”¾æ¨™æº– (RFC 7519)</li><li>è¢«ç”¨åœ¨èº«ä»½æä¾›è€…å’Œæœå‹™æä¾›è€…é–“å‚³éï¼Œè¢«èªè­‰çš„ç”¨æˆ¶èº«ä»½è¨Šæ¯</li><li>å¯é¡å¤–å¢åŠ è²æ˜è¨Šæ¯ï¼Œè©²JWT tokenå¯ä»¥ç›´æ¥è¢«ç”¨æ–¼èªè­‰(Authorization)ï¼Œä¹Ÿå¯è¢«åŠ å¯†</li><li>ç‰¹åˆ¥é©ç”¨æ–¼SSO</li></ul><h4 id="JWT-èˆ‡-Sessionå·®åˆ¥ï¼š"><a href="#JWT-èˆ‡-Sessionå·®åˆ¥ï¼š" class="headerlink" title="JWT èˆ‡ Sessionå·®åˆ¥ï¼š"></a>JWT èˆ‡ Sessionå·®åˆ¥ï¼š</h4><h4 id="Session"><a href="#Session" class="headerlink" title="Session:"></a>Session:</h4><p>ç”±æ–¼httpå”è­°ç‚ºstateless,ç„¡æ³•çŸ¥é“æ¯æ¬¡requestæ˜¯èª°ï¼Œä½†æ¯æ¬¡requestè‹¥éƒ½è¦å¸³è™Ÿå¯†ç¢¼å¾ˆéº»ç…©</p><p>æ•…ç”¨æˆ¶ç¬¬ä¸€æ¬¡ç™¼Requestæ™‚ï¼Œå°±ç”¢ç”Ÿä¸€çµ„tokenç´€éŒ„åœ¨dbèˆ‡session, ä¸¦å°‡tokençµ¦ç”¨æˆ¶ï¼Œå‘Šè¨´ç”¨æˆ¶å°‡tokenå­˜åœ¨cookieï¼Œç•¶ä¸‹æ¬¡ç™¼é€requestæ™‚ï¼Œé€étokenè­‰æ˜è‡ªå·±èº«ä»½ã€‚</p><h4 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h4><p>çµ„æˆå…§å®¹æœ‰ä¸‰å€‹éƒ¨åˆ†(Header, Paylaod,Signature)ä¸¦ç”±<code>.</code> åšå€éš”ï¼Œæœ€å¾Œé€éé€™ä¸‰å€‹éƒ¨åˆ†ï¼Œä¸²æˆä¸€å€‹ Jwt å­—ä¸²</p><p>Header: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &apos;typ&apos;: &apos;JWT&apos;, # è²æ˜é¡å‹</span><br><span class="line">  &apos;alg&apos;: &apos;HS256&apos; # åŠ å¯†çš„æ–¹æ³•: HMACã€SHA256ã€RSA é€²è¡Œ Base64 ç·¨ç¢¼</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payload: æ”¾è²æ˜å…§å®¹ï¼Œå¯ä»¥èªªå°±æ˜¯å­˜æ”¾æºé€šè¨Šæ¯çš„åœ°æ–¹</p><p>åœ¨å®šç¾©ä¸Šæœ‰ 3 ç¨®è²æ˜ (Claims)</p><ul><li>Reserved (è¨»å†Šè²æ˜)</li><li>Public (å…¬é–‹è²æ˜)</li><li>Private (ç§æœ‰è²æ˜)</li></ul><p>è¨»å†Šè²æ˜åƒæ•¸ (å»ºè­°ä½†ä¸å¼·åˆ¶ä½¿ç”¨)</p><ul><li>iss (Issuer) - jwtç°½ç™¼è€…</li><li>sub (Subject) - jwtæ‰€é¢å‘çš„ç”¨æˆ¶</li><li>aud (Audience) - æ¥æ”¶jwtçš„ä¸€æ–¹</li><li>exp (Expiration Time) - jwtçš„éæœŸæ™‚é–“ï¼Œé€™å€‹éæœŸæ™‚é–“å¿…é ˆè¦å¤§æ–¼ç°½ç™¼æ™‚é–“</li><li>nbf (Not Before) - å®šç¾©åœ¨ä»€éº¼æ™‚é–“ä¹‹å‰ï¼Œè©²jwtéƒ½æ˜¯ä¸å¯ç”¨çš„</li><li>iat (Issued At) - jwtçš„ç°½ç™¼æ™‚é–“</li><li>jti (JWT ID) - jwtçš„å”¯ä¸€èº«ä»½æ¨™è­˜ï¼Œä¸»è¦ç”¨ä¾†ä½œç‚ºä¸€æ¬¡æ€§token,å¾è€Œè¿´é¿é‡æ”¾æ”»æ“Š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class="line">  &quot;iat&quot;: 1516239022</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Signature: ç”±ä¸‰å€‹éƒ¨åˆ†çµ„æˆ</p><ul><li>header (base64å¾Œçš„)</li><li>payload (base64å¾Œçš„)</li><li>secret </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), &apos;secret&apos;)</span><br></pre></td></tr></table></figure><p>:::warning<br>secret è¦ä¿å­˜åœ¨ server ç«¯ï¼Œjwt çš„ ç°½ç™¼é©—è­‰éƒ½å¿…é ˆä½¿ç”¨é€™å€‹ secretï¼Œç•¶å…¶ä»–äººå¾—çŸ¥é€™å€‹ secretï¼Œé‚£å°±æ„å‘³è‘—å®¢æˆ¶ç«¯æ˜¯å¯ä»¥è‡ªæˆ‘ç°½ç™¼ jwt ï¼Œå› æ­¤åœ¨ä»»ä½•å ´æ™¯éƒ½ä¸æ‡‰è©²å¤–æµ<br>:::</p><p>æœ€å¾Œå°‡ Header, Payload, Signatureåšbase64ç·¨ç¢¼ï¼Œçµ„æˆ</p><p>ä½¿ç”¨çš„æ™‚å€™ï¼Œåœ¨reqeustçš„headeråŠ ä¸Š <code>Authorization: Bearer &lt;token&gt;</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">post(&apos;api/user/1&apos;, &#123;</span><br><span class="line">  headers: &#123;</span><br><span class="line">    &apos;Authorization&apos;: &apos;Bearer &apos; + token</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="JWT-å‰å¾Œç«¯äº’å‹•ç¤ºæ„åœ–"><a href="#JWT-å‰å¾Œç«¯äº’å‹•ç¤ºæ„åœ–" class="headerlink" title="JWT å‰å¾Œç«¯äº’å‹•ç¤ºæ„åœ–"></a>JWT å‰å¾Œç«¯äº’å‹•ç¤ºæ„åœ–</h3><p><img src="https://i.imgur.com/wGqdCkr.png" alt=""></p><h3 id="JWTå„ªé»"><a href="#JWTå„ªé»" class="headerlink" title="JWTå„ªé»"></a>JWTå„ªé»</h3><ul><li>è·¨èªè¨€ï¼Œå› ç‚º json æ ¼å¼å¤§éƒ¨åˆ†èªè¨€éƒ½å¯ä½¿ç”¨</li><li>å¯å„²å­˜ä¸€äº›ç°¡å–®ä½†éæ•æ„Ÿçš„å•†æ¥­é‚è¼¯ - role ..</li><li>æ§‹æˆå…§å®¹ç°¡å–®ï¼Œä½”ç”¨ Size å°æ–¹ä¾¿å‚³è¼¸</li><li>!!! ä¸éœ€åœ¨ server ä¿å­˜ sessionï¼Œæ‰€ä»¥å®ƒæ˜“æ–¼æ‡‰ç”¨çš„æ“´å±•</li></ul><h2 id="Spring-Security-æ•™å­¸è¦–é »"><a href="#Spring-Security-æ•™å­¸è¦–é »" class="headerlink" title="Spring Security æ•™å­¸è¦–é »"></a>Spring Security æ•™å­¸è¦–é »</h2><p>Spring Boot + Spring Security + JWT from scratch - Java Brains<br><a href="https://www.youtube.com/watch?v=X80nJ5T7YpE" target="_blank" rel="noopener">https://www.youtube.com/watch?v=X80nJ5T7YpE</a></p><h2 id="åƒè€ƒè³‡æºï¼š"><a href="#åƒè€ƒè³‡æºï¼š" class="headerlink" title="åƒè€ƒè³‡æºï¼š"></a>åƒè€ƒè³‡æºï¼š</h2><p>Okta å¦‚ä½•å”åŠ©éç‡Ÿåˆ©çµ„ç¹”-å¾ 25 å€‹å…è²»çš„æˆæ¬Šé–‹å§‹<br><a href="https://www.techsoup-taiwan.org.tw/okta" target="_blank" rel="noopener">https://www.techsoup-taiwan.org.tw/okta</a></p><p>LDAP ç°¡ä»‹<br><a href="https://poychang.github.io/ldap-introduction/" target="_blank" rel="noopener">https://poychang.github.io/ldap-introduction/</a></p><p>ä¸€æ¬¡ææ‡‚OAuthèˆ‡SSOåœ¨å¹¹ä»€éº¼?<br><a href="http://studyhost.blogspot.com/2017/01/oauthsso.html" target="_blank" rel="noopener">http://studyhost.blogspot.com/2017/01/oauthsso.html</a></p><p>GraphQL è¨­è¨ˆï¼š Autentication èˆ‡ Authorization å¤§å…¨<br><a href="https://ithelp.ithome.com.tw/articles/10208278" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10208278</a></p><p>JSON Web Token(JWT) ç°¡å–®ä»‹ç´¹<br><a href="https://mgleon08.github.io/blog/2018/07/16/jwt/" target="_blank" rel="noopener">https://mgleon08.github.io/blog/2018/07/16/jwt/</a></p><p>What is Spring Security really all about? Java Brains Brain Bytes</p><p><a href="https://www.youtube.com/watch?v=sm-8qfMWEV8&amp;list=PLqq-6Pq4lTTYTEooakHchTGglSvkZAjnE" target="_blank" rel="noopener">https://www.youtube.com/watch?v=sm-8qfMWEV8&amp;list=PLqq-6Pq4lTTYTEooakHchTGglSvkZAjnE</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Spring-Security-åŠŸèƒ½ä»‹ç´¹&quot;&gt;&lt;a href=&quot;#Spring-Security-åŠŸèƒ½ä»‹ç´¹&quot; class=&quot;headerlink&quot; title=&quot;Spring Security åŠŸèƒ½ä»‹ç´¹&quot;&gt;&lt;/a&gt;Spring Security åŠŸèƒ½ä»‹ç´¹&lt;/h1&gt;&lt;p&gt;å…ˆä»‹ç´¹ä»¥ä¸‹å¸¸ç”¨èªè­‰åŠŸèƒ½&lt;/p&gt;
    
    </summary>
    
      <category term="Spring" scheme="http://a10000005588.github.io/categories/Spring/"/>
    
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
      <category term="Spring" scheme="http://a10000005588.github.io/tags/Spring/"/>
    
      <category term="Authentication" scheme="http://a10000005588.github.io/tags/Authentication/"/>
    
  </entry>
  
  <entry>
    <title>Spring Annotationç­†è¨˜æ•´ç†</title>
    <link href="http://a10000005588.github.io/2020/03/10/Spring-Annotation%E4%BB%8B%E7%B4%B9/"/>
    <id>http://a10000005588.github.io/2020/03/10/Spring-Annotationä»‹ç´¹/</id>
    <published>2020-03-10T14:13:00.000Z</published>
    <updated>2020-08-01T02:39:49.090Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spring-Annotation-ç­†è¨˜"><a href="#Spring-Annotation-ç­†è¨˜" class="headerlink" title="Spring Annotation ç­†è¨˜"></a>Spring Annotation ç­†è¨˜</h1><p>é€™é‚Šä¸»è¦æ•´ç†äº†æˆ‘ä½¿ç”¨æˆ–æ˜¯é‡åˆ°çš„Spring Annotationè³‡æ–™æŸ¥è©¢èˆ‡çµ±æ•´çš„ç´€éŒ„</p><a id="more"></a><h2 id="API-ç›¸é—œ-Annotation"><a href="#API-ç›¸é—œ-Annotation" class="headerlink" title="API ç›¸é—œ @Annotation"></a>API ç›¸é—œ @Annotation</h2><h3 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h3><p>å°‡classè¨­ç½®ç‚ºå¤–éƒ¨æ§åˆ¶å™¨</p><h4 id="RestControllerAdvice"><a href="#RestControllerAdvice" class="headerlink" title="@RestControllerAdvice"></a>@RestControllerAdvice</h4><p>ç­‰åŒæ–¼@ControllerAdvice + @ResponseBody</p><p>@ControllerAdviceç‚ºå¯åœ¨å®£å‘Šçš„å‡½å¼ä¸­ä½¿ç”¨@ExceptionHandler, @InitBinderæˆ– @ModelAttributeè¨»è§£çš„æ–¹æ³•</p><h5 id="ExceptionHandler"><a href="#ExceptionHandler" class="headerlink" title="@ExceptionHandler"></a>@ExceptionHandler</h5><p>æ””æˆªæ‰€æœ‰æ§åˆ¶å™¨æ‰€ç™¼å‡ºçš„exceptionï¼Œä¸¦è¿”å›bodyå‹å¼</p><h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h3><p>æ§åˆ¶å™¨è£¡é¢çš„æ–¹æ³•ï¼Œä½¿ä¹‹æˆç‚ºå¤–éƒ¨è«‹æ±‚</p><p>è‹¥è¦è¨­ç½®GET method, å¦‚ä¸‹<br>(ä¹Ÿå¯ä»¥æ”¹æˆ POST, PUT, DELETE)</p><p>å®šç¾©ä¸€çµ„restful apiå‰ç¶´è·¯ç”±<br>ex : @RequestMapping(â€œ/api/v1â€)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequstMapping</span>(<span class="string">"/api/v1"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">  <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"helloworld"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦ä½¿ç”¨çš„è©±å¾—åœ¨postmanä¸­ç”¨ã€€<code>/api/v1/hello</code>ã€€</p><h3 id="HTTPå‹•ä½œAnnotation"><a href="#HTTPå‹•ä½œAnnotation" class="headerlink" title="HTTPå‹•ä½œAnnotation"></a>HTTPå‹•ä½œAnnotation</h3><h4 id="PostMapping"><a href="#PostMapping" class="headerlink" title="@PostMapping"></a>@PostMapping</h4><h4 id="GetMapping"><a href="#GetMapping" class="headerlink" title="@GetMapping"></a>@GetMapping</h4><h4 id="PutMapping"><a href="#PutMapping" class="headerlink" title="@PutMapping"></a>@PutMapping</h4><h4 id="DeleteMapping"><a href="#DeleteMapping" class="headerlink" title="@DeleteMapping"></a>@DeleteMapping</h4><h3 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a>@RequestBody</h3><p>å¯ä»¥æ¥æ”¶Bodyåƒæ•¸ï¼Œå¾—é€éclasså®£å‘Šä¸€çµ„objectä¾†æ¥æ”¶ã€€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="keyword">private</span> Integer number;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">setNumber</span><span class="params">(Integer number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> getType...</span><br><span class="line">    <span class="keyword">public</span> getNumber...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/api/v1"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CarController</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€éå®£å‘Šä¸€å€‹carï¼Œä¾†æ¥æ”¶Bodyçš„å€¼ (type, number)</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/car"</span>)</span><br><span class="line">    <span class="function">function <span class="title">getCar</span><span class="params">(@RequestBody Car car)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RequestHeaderã€-CookieValue"><a href="#RequestHeaderã€-CookieValue" class="headerlink" title="@RequestHeaderã€@CookieValue"></a>@RequestHeaderã€@CookieValue</h3><p>è™•ç†request headeréƒ¨åˆ†çš„æ³¨è§£ï¼š</p><p>Request Headerçš„å…§å®¹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Host                    localhost:8080  </span><br><span class="line">Accept                  text/html,application/xhtml+xml,application/xml;q=0.9  </span><br><span class="line">Accept-Language         fr,en-gb;q=0.7,en;q=0.3  </span><br><span class="line">Accept-Encoding         gzip,deflate  </span><br><span class="line">Accept-Charset          ISO-8859-1,utf-8;q=0.7,*;q=0.7  </span><br><span class="line">Keep-Alive              300</span><br></pre></td></tr></table></figure></p><p>é€é @RequestHeader(â€œâ€)æ¥å—å…¶Headerå€¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(&quot;/displayHeaderInfo.do&quot;)  </span><br><span class="line">public void displayHeaderInfo(@RequestHeader(&quot;Accept-Encoding&quot;) String encoding,  </span><br><span class="line">                              @RequestHeader(&quot;Keep-Alive&quot;) long keepAlive)  &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="SessionAttributes"><a href="#SessionAttributes" class="headerlink" title="@SessionAttributes"></a>@SessionAttributes</h3><p>è©²è¨»è§£ç”¨ä¾†ç¶å®šHttpSessionä¸­çš„attributeå°è±¡çš„å€¼ï¼Œä¾¿æ–¼åœ¨æ–¹æ³•ä¸­çš„åƒæ•¸é‡Œä½¿ç”¨ã€‚</p><p>è©²è¨»è§£æœ‰valueã€typeså…©å€‹å±¬æ€§ï¼Œå¯ä»¥é€šéåå­—å’Œé¡å‹æŒ‡å®šè¦ä½¿ç”¨çš„attribute å°è±¡ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span>  </span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editPet.do"</span>)  </span><br><span class="line"><span class="meta">@SessionAttributes</span>(<span class="string">"pet"</span>)  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EditPetForm</span> </span>&#123;  </span><br><span class="line">    <span class="comment">// ...   </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åƒè€ƒè³‡æ–™:<br>Spring MVCå¸¸ç”¨æ³¨è§£@PathVariableã€@RequestHeaderã€@CookieValueã€@RequestParamã€@RequestBodyã€@SessionAttributesã€@ModelAttribute</p><p><a href="https://www.cnblogs.com/EasonJim/p/8323017.html" target="_blank" rel="noopener">https://www.cnblogs.com/EasonJim/p/8323017.html</a></p><h3 id="JsonProperty-é‡é»ï¼Œé‡åˆ°æ¥ä¸åˆ°requestçš„å€¼ï¼Œç”¨é€™å°±å°äº†"><a href="#JsonProperty-é‡é»ï¼Œé‡åˆ°æ¥ä¸åˆ°requestçš„å€¼ï¼Œç”¨é€™å°±å°äº†" class="headerlink" title="@JsonProperty (é‡é»ï¼Œé‡åˆ°æ¥ä¸åˆ°requestçš„å€¼ï¼Œç”¨é€™å°±å°äº†)"></a>@JsonProperty (é‡é»ï¼Œé‡åˆ°æ¥ä¸åˆ°requestçš„å€¼ï¼Œç”¨é€™å°±å°äº†)</h3><p>ç”¨ä¾†æ¥æ”¶application/jsonä¸­ï¼Œæœ‰å¤§å°ä¸ä¸€å‹åˆ¥çš„è®Šæ•¸</p><p>ex: Postman script<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"contact"</span>:&#123;</span><br><span class="line">        <span class="attr">"cPhone"</span>:<span class="string">"0912345678"</span>, </span><br><span class="line">        <span class="attr">"cMail"</span>:<span class="string">" abc@test.com.tw "</span>, </span><br><span class="line">        <span class="attr">"cAddress"</span>:<span class="string">"å°åŒ—å¸‚ä¸­æ­£å€ä¿¡ç¾©è·¯ä¸€æ®µ21-3è™Ÿ"</span></span><br><span class="line">    &#125;,...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è‹¥è¦æ¥åˆ° PHONEæˆ–Websiteï¼Œéœ€è¦å®šç¾© @JsonProperty(â€œPHONEâ€), @JsonProperty(â€œWebsiteâ€)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lia201iReqDTO</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    contactDto contact;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="meta">@AllArgsConstructor</span></span><br><span class="line">    <span class="meta">@NoArgsConstructor</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">contactDto</span> </span>&#123;</span><br><span class="line">        <span class="meta">@NotNull</span></span><br><span class="line">        <span class="meta">@JsonProperty</span>(<span class="string">"cPhone"</span>)</span><br><span class="line">        String cPhone;</span><br><span class="line">        <span class="meta">@JsonProperty</span>(<span class="string">"cMail"</span>)</span><br><span class="line">        String cMail;</span><br><span class="line">        <span class="meta">@JsonProperty</span>(<span class="string">"cAddress"</span>)</span><br><span class="line">        String cAddress;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åƒè€ƒè³‡æ–™"><a href="#åƒè€ƒè³‡æ–™" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h4><p>Spring REST consuming JSON uppercase vs lowercase<br><a href="https://stackoverflow.com/questions/26890398/spring-rest-consuming-json-uppercase-vs-lowercase" target="_blank" rel="noopener">https://stackoverflow.com/questions/26890398/spring-rest-consuming-json-uppercase-vs-lowercase</a></p><h2 id="é©—è­‰ç›¸é—œçš„Annotation"><a href="#é©—è­‰ç›¸é—œçš„Annotation" class="headerlink" title="é©—è­‰ç›¸é—œçš„Annotation"></a>é©—è­‰ç›¸é—œçš„Annotation</h2><h3 id="Validèˆ‡-Validated"><a href="#Validèˆ‡-Validated" class="headerlink" title="@Validèˆ‡@Validated"></a>@Validèˆ‡@Validated</h3><p>è² è²¬é©—è­‰æœ‰è¢«å®šç¾©æ ¡æ­£çš„åƒæ•¸æˆ–object</p><p>å…ˆç”¢ç”Ÿè¦æ ¡æ­£çš„å¯¦é«”é¡(class)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;    </span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min</span>(<span class="number">18</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pattern</span>(regexp = <span class="string">"^1(3|4|5|7|8)\\d&#123;9&#125;$"</span>,message = <span class="string">"æ‰‹æœºå·ç æ ¼å¼é”™è¯¯"</span>)</span><br><span class="line">    <span class="meta">@NotBlank</span>(message = <span class="string">"æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Email</span>(message = <span class="string">"é‚®ç®±æ ¼å¼é”™è¯¯"</span>)</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//... getter setter</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ–¼@Controllerä¸­ã€€ä½¿ç”¨Validåšæ ¡æ­£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class FooController &#123;</span><br><span class="line"></span><br><span class="line">    // å°Foo classç”¢ç”Ÿçš„fooåšæ ¡æ­£</span><br><span class="line">    @RequestMapping(&quot;/foo&quot;)</span><br><span class="line">    public String foo(@Validated Foo foo &lt;1&gt;, BindingResult bindingResult &lt;2&gt;) &#123;</span><br><span class="line">        if(bindingResult.hasErrors())&#123;</span><br><span class="line">            for (FieldError fieldError : bindingResult.getFieldErrors()) &#123;</span><br><span class="line">                //...</span><br><span class="line">            &#125;</span><br><span class="line">            return &quot;fail&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;success&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Validate-èˆ‡-Validå·®ç•°"><a href="#Validate-èˆ‡-Validå·®ç•°" class="headerlink" title="@Validate èˆ‡ @Validå·®ç•°"></a>@Validate èˆ‡ @Validå·®ç•°</h4><p>@Validèƒ½é€²è¡ŒåµŒå¥—é©—è­‰ï¼Œ @Validateä¸è¡Œ</p><p>å› ç‚º@Validèƒ½åŠ åœ¨æˆå“¡å±¬æ€§ä¸Šï¼Œåè€Œ@Validatedä¸èƒ½ç”¨åœ¨æˆå“¡å±¬æ€§ã€‚</p><p>èˆ‰ä¾‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"idä¸èƒ½ç‚ºç©ºå€¼"</span>)</span><br><span class="line">    <span class="meta">@Min</span>(value = <span class="number">1</span>, message = <span class="string">"idå¿…é ˆç‚ºæ­£æ•´æ•¸"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"propsä¸èƒ½ç‚ºç©ºç›´"</span>)</span><br><span class="line">    <span class="meta">@Size</span>(min = <span class="number">1</span>, message = <span class="string">"è‡³å°‘è¦æœ‰ä¸€å€‹å±¬æ€§"</span>)</span><br><span class="line">    <span class="keyword">private</span> List&lt;Prop&gt; props;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶è€Œ Prop classå¦‚ä¸‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Prop</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"pidä¸èƒ½ç‚ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Min</span>(value = <span class="number">1</span>, message = <span class="string">"pidå¿…é ˆç‚ºæ­£æ•´æ•¸"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long pid;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"vidä¸èƒ½ç‚ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Min</span>(value = <span class="number">1</span>, message = <span class="string">"vidå¿…é ˆç‚ºæ­£æ•´æ•¸"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long vid;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotBlank</span>(message = <span class="string">"pidNameä¸èƒ½ç‚ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String pidName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotBlank</span>(message = <span class="string">"vidNameä¸èƒ½ç‚ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String vidName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç¾åœ¨æˆ‘å€‘æœ‰å€‹ItemControlleræ¥å—ä¸€å€‹Itemçš„åƒæ•¸ï¼Œæƒ³è¦å°Itemé€²è¡Œé©—è­‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/item/add"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addItem</span><span class="params">(@Validated Item item, BindingResult bindingResult)</span> </span>&#123;</span><br><span class="line">        doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šåœ–ä¸­ï¼Œå¦‚æœItemå¯¦é«”çš„propså±¬æ€§ä¸é¡å¤–åŠ è¨»é‡‹ï¼Œåªæœ‰@NotNullå’Œ@Sizeï¼Œç„¡è«–å…¥åƒæ¡ç”¨@Validatedé‚„æ˜¯@Validé©—è­‰ï¼ŒSpring Validationæ¡†æ¶åªæœƒå°Itemçš„idå’Œpropsåšéç©ºå’Œæ•¸é‡é©—è­‰ï¼Œä¸æœƒå°propså­—æ®µè£¡çš„Propå¯¦é«”é€²è¡Œå­—æ®µé©—è­‰ï¼Œä¹Ÿå°±æ˜¯@Validatedå’Œ@ValidåŠ åœ¨æ–¹æ³•åƒæ•¸å‰ï¼Œ<span style="color:red">éƒ½ä¸æœƒè‡ªå‹•å°åƒæ•¸é€²è¡ŒåµŒå¥—é©—è­‰&lt;/ span&gt;</span></p><p>:::info<br>é€™é‚ŠæŒ‡çš„åµŒå¥—(Nested)é©—è­‰ï¼ŒæŒ‡çš„æ˜¯è‹¥class Itemä¸­é‚„æœ‰ä¸€å€‹è®Šæ•¸List<props> ä¸”é€™å€‹Propsçš„classå…§ä¹Ÿæœ‰è‡ªå·±å®šç¾©é©—è­‰@Notnull, @NotBlank, ä¸€å±¤classå…§é‚„æœ‰ä¸€å€‹classå®šç¾©è‡ªå·±çš„é©—è­‰ï¼Œå°±å«åšåµŒå¥—é©—è­‰<br>:::</props></p><p>è¦é€²è¡ŒåµŒå¥—é©—è­‰çš„è©±å¾—åœ¨ class Propsä¸­åŠ å…¥@Valid </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Item</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"idä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Min</span>(value = <span class="number">1</span>, message = <span class="string">"idå¿…é¡»ä¸ºæ­£æ•´æ•°"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Valid</span> <span class="comment">// åµŒå¥—éªŒè¯å¿…é¡»ç”¨@Valid</span></span><br><span class="line">    <span class="meta">@NotNull</span>(message = <span class="string">"propsä¸èƒ½ä¸ºç©º"</span>)</span><br><span class="line">    <span class="meta">@Size</span>(min = <span class="number">1</span>, message = <span class="string">"propsè‡³å°‘è¦æœ‰ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§"</span>)</span><br><span class="line">    <span class="keyword">private</span> List&lt;Prop&gt; props;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è£œå……-è² è²¬æ ¡é©—çš„Annotation"><a href="#è£œå……-è² è²¬æ ¡é©—çš„Annotation" class="headerlink" title="è£œå…… è² è²¬æ ¡é©—çš„Annotation"></a>è£œå…… è² è²¬æ ¡é©—çš„Annotation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Null è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆç‚º null</span><br><span class="line">@NotNull è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆä¸ç‚º null</span><br><span class="line">@AssertTrue è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆç‚º true</span><br><span class="line">@AssertFalse è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆç‚º false</span><br><span class="line">@Min(value) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹æ•¸å­—ï¼Œå…¶å€¼å¿…é ˆå¤§æ–¼ç­‰æ–¼æŒ‡å®šçš„æœ€å°å€¼</span><br><span class="line">@Max(value) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹æ•¸å­—ï¼Œå…¶å€¼å¿…é ˆå°æ–¼ç­‰æ–¼æŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class="line">@DecimalMin(value) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹æ•¸å­—ï¼Œå…¶å€¼å¿…é ˆå¤§æ–¼ç­‰æ–¼æŒ‡å®šçš„æœ€å°å€¼</span><br><span class="line">@DecimalMax(value) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹æ•¸å­—ï¼Œå…¶å€¼å¿…é ˆå°æ–¼ç­‰æ–¼æŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class="line">@Size(max=, min=) è¢«è¨»é‡‹çš„å…ƒç´ çš„å¤§å°å¿…é ˆåœ¨æŒ‡å®šçš„ç¯„åœå…§</span><br><span class="line">@Digits (integer, fraction) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹æ•¸å­—ï¼Œå…¶å€¼å¿…é ˆåœ¨å¯æ¥å—çš„ç¯„åœå…§</span><br><span class="line">@Past è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹éå»çš„æ—¥æœŸ</span><br><span class="line">@Future è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯ä¸€å€‹å°‡ä¾†çš„æ—¥æœŸ</span><br><span class="line">@Pattern(regex=,flag=) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆç¬¦åˆæŒ‡å®šçš„æ­£å‰‡è¡¨é”å¼</span><br><span class="line"></span><br><span class="line">@NotBlank(message =) é©—è­‰å­—ç¬¦ä¸²énullï¼Œä¸”é•·åº¦å¿…é ˆå¤§æ–¼0</span><br><span class="line">@Email è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆæ˜¯é›»å­éƒµç®±åœ°å€</span><br><span class="line">@Length(min=,max=) è¢«è¨»é‡‹çš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é ˆåœ¨æŒ‡å®šçš„ç¯„åœå…§</span><br><span class="line">@NotEmpty è¢«è¨»é‡‹çš„å­—ç¬¦ä¸²çš„å¿…é ˆéç©º</span><br><span class="line">@Range(min=,max=,message=) è¢«è¨»é‡‹çš„å…ƒç´ å¿…é ˆåœ¨åˆé©çš„ç¯„åœå…§</span><br></pre></td></tr></table></figure><h4 id="è£œå……-ç”¨BindingResultæ¥æ”¶-Validæ‹‹å‡ºä¾†çš„éŒ¯èª¤è¨Šæ¯"><a href="#è£œå……-ç”¨BindingResultæ¥æ”¶-Validæ‹‹å‡ºä¾†çš„éŒ¯èª¤è¨Šæ¯" class="headerlink" title="è£œå……: ç”¨BindingResultæ¥æ”¶@Validæ‹‹å‡ºä¾†çš„éŒ¯èª¤è¨Šæ¯"></a>è£œå……: ç”¨<code>BindingResult</code>æ¥æ”¶@Validæ‹‹å‡ºä¾†çš„éŒ¯èª¤è¨Šæ¯</h4><p>å‡è¨­æœ‰é©—è­‰éŒ¯èª¤çš„ç‰©ä»¶ç‚º BindingResult bindingResult<br>å¯é€ébindResultå–å¾—éŒ¯èª¤è³‡è¨Š</p><p>èˆ‰ä¾‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class FlightDTO &#123;</span><br><span class="line">    @NotBlank</span><br><span class="line">    private String terminal; // èˆªå»ˆ</span><br><span class="line">    @NotBlank</span><br><span class="line">    private String type; // èˆªç­ç¨®é¡</span><br><span class="line">    @NotBlank</span><br><span class="line">    private String carrier; // èˆªç©ºå…¬å¸ä»£ç¢¼</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥ä½¿ç”¨@Validå°FlightDTOåšåƒæ•¸é©—è­‰ï¼Œå‡è¨­æœ‰ä¸€Requestå°‘è¼¸å…¥terminalè³‡è¨Šï¼Œå°±æœƒç™¼å‡ºbindingResultè¨Šæ¯ï¼Œå…¶ä¸­åŒ…å«ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">List&lt;FieldError&gt; fieldErrors = bindingResult.getFieldErrors();</span><br><span class="line"><span class="keyword">for</span>(FieldError fieldError: fieldErrors) &#123;</span><br><span class="line">    <span class="comment">//ã€€å°è£éŒ¯èª¤æ ¼å¼</span></span><br><span class="line">    FieldResource fieldResource = <span class="keyword">new</span> FieldResource(</span><br><span class="line">        fieldError.getObjectName(), <span class="comment">// å–å¾—ç‰©ä»¶åç¨±ï¼šç‚ºFlightDTO</span></span><br><span class="line">        fieldError.getField(), <span class="comment">// ç‚ºproperties(terminal)</span></span><br><span class="line">        fieldError.getCode(), <span class="comment">// ç‚º@Notblank</span></span><br><span class="line">        fieldError.getDefaultMessage() <span class="comment">// ç‚º@Notblankçš„éŒ¯èª¤è³‡è¨Š</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>:::info<br>BindingResultç‚ºErrorçš„å­ä»‹é¢</p><p>BindingResult<br><a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/BindingResult.html" target="_blank" rel="noopener">https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/BindingResult.html</a><br>Error:<br><a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/Errors.html" target="_blank" rel="noopener">https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/Errors.html</a><br>:::</p><h4 id="åƒè€ƒè³‡æ–™ï¼š"><a href="#åƒè€ƒè³‡æ–™ï¼š" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h4><p>ä½¿ç”¨spring validationå®Œæˆæ•°æ®åç«¯æ ¡éªŒ<br><a href="https://www.cnkirito.moe/spring-validation/" target="_blank" rel="noopener">https://www.cnkirito.moe/spring-validation/</a></p><p>@Validatedå’Œ@ValidåŒºåˆ«ï¼šSpring validationéªŒè¯æ¡†æ¶å¯¹å…¥å‚å®ä½“è¿›è¡ŒåµŒå¥—éªŒè¯å¿…é¡»åœ¨ç›¸åº”å±æ€§ï¼ˆå­—æ®µï¼‰åŠ ä¸Š@Validè€Œä¸æ˜¯@Validated<br><a href="https://blog.csdn.net/qq_27680317/article/details/79970590" target="_blank" rel="noopener">https://blog.csdn.net/qq_27680317/article/details/79970590</a></p><h2 id="æ“ä½œæ•¸æ“šåº«ç›¸é—œæ•¸æ“šç›¸é—œçš„Annotation"><a href="#æ“ä½œæ•¸æ“šåº«ç›¸é—œæ•¸æ“šç›¸é—œçš„Annotation" class="headerlink" title="æ“ä½œæ•¸æ“šåº«ç›¸é—œæ•¸æ“šç›¸é—œçš„Annotation"></a>æ“ä½œæ•¸æ“šåº«ç›¸é—œæ•¸æ“šç›¸é—œçš„Annotation</h2><h3 id="Entity"><a href="#Entity" class="headerlink" title="@Entity"></a>@Entity</h3><p>è¡¨ç¤ºæ˜¯ä¸€å€‹å°æ‡‰åˆ°DB Tableçš„ç‰©ä»¶</p><h3 id="Id"><a href="#Id" class="headerlink" title="@Id"></a>@Id</h3><p>è²æ˜è©²æ¬„ä½ç‚ºä¸»éµ</p><h3 id="GeneratedValue"><a href="#GeneratedValue" class="headerlink" title="@GeneratedValue"></a>@GeneratedValue</h3><p>æŒ‡å®šIDç”Ÿæˆçš„ç­–ç•¥ï¼Œè‹¥æ²’æœ‰è¨­ç½®çš„åŒ–, Hibernateå°æ‡‰çš„æ˜¯ç‚ºä¸€å€‹Not nullçš„ç‰©ä»¶ï¼Œå¾—è‡ªè¡Œè¨­å®šidåˆ°ç‰©ä»¶å…§ã€‚<br>ä½†é€šå¸¸æœƒè‡ªè¡Œåœ¨æ–°å¢è³‡æ–™æ™‚ç”¢ç”ŸID, æ•…@Idèˆ‡@GeneratedValueæœƒå¸¸å¸¸åŒæ™‚å‡ºç¾</p><p>å› ç‚ºHibernateæœƒé‡è¦‹ä¸åŒçš„Databaseï¼Œæ‰€ä»¥æœ‰å„ç¨®ä¸åŒçš„ç”Ÿæˆç­–ç•¥:</p><h4 id="GenerationType-Auto"><a href="#GenerationType-Auto" class="headerlink" title="GenerationType.Auto"></a>GenerationType.Auto</h4><p>Hibernateæœƒæ ¹æ“šæ¡ç”¨çš„Databaseç‚ºä½•ï¼Œä¾†æ±ºå®šè¦ç”¨ GenerationType.Identity æˆ– GenerationType.SEQUENCEã€‚<br>(å¤§éƒ¨åˆ†çš„æƒ…æ³éƒ½æœƒæ¡ç”¨ GenerationType.SEQUENCE)</p><h4 id="GenerationType-IDENTITY"><a href="#GenerationType-IDENTITY" class="headerlink" title="GenerationType.IDENTITY"></a>GenerationType.IDENTITY</h4><p>é€éauto-incremented database columnä¾†ç”¢ç”Ÿprimary key.<br>å¸¸è¦‹çš„MySQLå’ŒMMSQLéƒ½æ¡ç”¨è©²æ–¹å¼ï¼Œç›¸å°æ‡‰çš„DDLèªè¨€ç‚ºä»¥ä¸‹æ‰€ç¤º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id BIGINT NOT NULL AUTO_INCREMENT</span><br></pre></td></tr></table></figure></p><h4 id="GenerationType-SEQUENCE"><a href="#GenerationType-SEQUENCE" class="headerlink" title="GenerationType.SEQUENCE"></a>GenerationType.SEQUENCE</h4><p>è¨­å®šè©²ç­–ç•¥ï¼Œé€šå¸¸ä¹Ÿæœƒçµ¦å…¥å¦ä¸€å€‹Annotation <code>@SequenceGenerator</code>ï¼Œå¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue</span>(strategy = GenerationType.SEQUENCE, generator = <span class="string">"author_generator"</span>)</span><br><span class="line"><span class="meta">@SequenceGenerator</span>(name=<span class="string">"author_generator"</span>, sequenceName = <span class="string">"author_seq"</span>, allocationSize=<span class="number">50</span>)</span><br><span class="line"><span class="meta">@Column</span>(name = <span class="string">"id"</span>, updatable = <span class="keyword">false</span>, nullable = <span class="keyword">false</span>)</span><br><span class="line"><span class="keyword">private</span> Long id</span><br></pre></td></tr></table></figure><p>è‹¥æ²’æœ‰æŒ‡å®šï¼ŒHibernateæœƒä½¿ç”¨é è¨­çš„SequenceGenerator</p><p>å¯ä»¥çœ‹åˆ°è‹¥æŒ‡å®š sequenceGeneratorçš„nameç‚ºauthor_seq, Hibernateå°±æœƒåœ¨ <code>author_seq</code>é€™å€‹tableæŸ¥æ‰¾ä¸‹ä¸€å€‹idå€¼ç‚ºå¤šå°‘</p><p><img src="https://i.imgur.com/Uw8ebCO.jpg" alt=""></p><p>æ³¨æ„ï¼Œåœ¨Postgresæƒ…æ³ä¸‹ä¸é©åˆç”¨è©²æ–¹æ³•<br><a href="https://stackoverflow.com/questions/4288740/hibernate-use-of-postgresql-sequence-does-not-affect-sequence-table/4502062#4502062" target="_blank" rel="noopener">https://stackoverflow.com/questions/4288740/hibernate-use-of-postgresql-sequence-does-not-affect-sequence-table/4502062#4502062</a></p><h4 id="GenerationType-SEQUENCE-1"><a href="#GenerationType-SEQUENCE-1" class="headerlink" title="GenerationType.SEQUENCE"></a>GenerationType.SEQUENCE</h4><p>ç•¶ä¸å¸Œæœ›æ‡‰ç”¨ç¨‹å¼èˆ‡æŸä¸€ç¨® Database Engine ç¶æ­»çš„æ™‚å€™ï¼Œå¯ä»¥ä½¿ç”¨é€™ç¨®æ–¹æ³•ï¼Œé€éå¦å¤–ä¸€å€‹è¡¨æ ¼ä¾†å®šç¾© ID</p><p>æœƒé€éSQLï¼Œå»ºç«‹å­˜æ”¾å„ç¨®columnçš„seqeunce<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE APP_SEQ_STORE ( APP_SEQ_NAME VARCHAR(255) NOT NULL, APP_SEQ_VALUE BIGINT NOT NULL, PRIMARY KEY(APP_SEQ_NAME) );</span><br></pre></td></tr></table></figure></p><h5 id="Reference-https-thoughts-on-java-org-jpa-generate-primary-keys"><a href="#Reference-https-thoughts-on-java-org-jpa-generate-primary-keys" class="headerlink" title="Reference: https://thoughts-on-java.org/jpa-generate-primary-keys/"></a>Reference: <a href="https://thoughts-on-java.org/jpa-generate-primary-keys/" target="_blank" rel="noopener">https://thoughts-on-java.org/jpa-generate-primary-keys/</a></h5><h4 id="IdClass-å¤åˆä¸»é”®"><a href="#IdClass-å¤åˆä¸»é”®" class="headerlink" title="@IdClass å¤åˆä¸»é”®"></a>@IdClass å¤åˆä¸»é”®</h4><p>å¤åˆä¸»é”®ç”±å¤šä¸ªä¸»é”®å­—æ®µç»„æˆã€‚æ¯ä¸ªä¸»é”®å­—æ®µå¿…é¡»æ˜¯ä¸Šé¢åˆ—å‡ºçš„æ”¯æŒç±»å‹ä¹‹ä¸€ã€‚<br>ä¾‹å¦‚ï¼Œä»¥ä¸‹é¡¹ç›®å®ä½“ç±»çš„ä¸»é”®ç”±ä¸¤ä¸ªå­—æ®µç»„æˆ:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span> <span class="meta">@IdClass</span>(ProjectId.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Project</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span> <span class="keyword">int</span> departmentId;</span><br><span class="line">    <span class="meta">@Id</span> <span class="keyword">long</span> projectId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨ProjectId.classä¸­è²æ˜å…©å€‹ä¸»éµå€¼<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class ProjectId &#123;</span><br><span class="line">    <span class="keyword">int</span> departmentId;</span><br><span class="line">    <span class="keyword">long</span> projectId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Embeddable"><a href="#Embeddable" class="headerlink" title="@Embeddable"></a>@Embeddable</h4><p>åµŒå…¥å¼ä¸»é”®<br>è¡¨ç¤ºå¤åˆä¸»é”®çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å¯åµŒå…¥çš„ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Project</span> </span>&#123;</span><br><span class="line">    <span class="meta">@EmbeddedId</span> ProjectId id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Embeddable</span></span><br><span class="line">Class ProjectId &#123;</span><br><span class="line">    <span class="keyword">int</span> departmentId;</span><br><span class="line">    <span class="keyword">long</span> projectId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Column"><a href="#Column" class="headerlink" title="@Column"></a>@Column</h3><p>å®£å‘Šè©²è®Šæ•¸èˆ‡è³‡æ–™åº«æ¬„ä½çš„å°æ˜ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column</span>(nam=â€category_nameâ€ length=<span class="number">20</span>)</span><br><span class="line"><span class="function">Public <span class="keyword">void</span> <span class="title">getCategoryName</span><span class="params">()</span></span>&#123;</span><br><span class="line">  Return <span class="keyword">this</span>.categoryName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åƒè€ƒè³‡æ–™-1"><a href="#åƒè€ƒè³‡æ–™-1" class="headerlink" title="åƒè€ƒè³‡æ–™:"></a>åƒè€ƒè³‡æ–™:</h4><p>SPRINGä¸­å¸¸ç”¨çš„æ³¨è§£ï¼ˆ@ENTITYï¼Œ@TABLEï¼Œ@COLUMNï¼Œ@REPOSITORYï¼Œ@SERVICEï¼‰<a href="https://www.cnblogs.com/hoojjack/p/6568920.html" target="_blank" rel="noopener">https://www.cnblogs.com/hoojjack/p/6568920.html</a></p><p>JPA ä¸»é”®@Idã€@IdClassã€@Embeddableã€@EmbeddedId<br><a href="https://blog.csdn.net/tracycater/article/details/78319021" target="_blank" rel="noopener">https://blog.csdn.net/tracycater/article/details/78319021</a></p><h3 id="Data"><a href="#Data" class="headerlink" title="@Data"></a>@Data</h3><p>@Data è‡ªå‹•ç”¢ç”Ÿ getter(), setter(), toString(), ç¯€çœä¸€å¤§å †ä»£ç¢¼çš„ç¥Annotation</p><h4 id="å‰ç½®ä½œæ¥­ï¼š-å¼•å…¥lombok"><a href="#å‰ç½®ä½œæ¥­ï¼š-å¼•å…¥lombok" class="headerlink" title="å‰ç½®ä½œæ¥­ï¼š å¼•å…¥lombok"></a>å‰ç½®ä½œæ¥­ï¼š å¼•å…¥lombok</h4><p>è¦ä½¿ç”¨ @Data æ³¨è§£è¦å…ˆå¼•å…¥lombok</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lombokç‚ºä¸€å€‹Libraryï¼Œå¯ä»¥ç”¨ç°¡å–®çš„è¨»è§£å½¢å¼ä¾†ç°¡åŒ–ä»£ç¢¼ï¼Œæé«˜é–‹ç™¼æ•ˆç‡ã€‚</span><br></pre></td></tr></table></figure><h4 id="å¦‚ä½•ä½¿ç”¨lobok"><a href="#å¦‚ä½•ä½¿ç”¨lobok" class="headerlink" title="å¦‚ä½•ä½¿ç”¨lobok"></a>å¦‚ä½•ä½¿ç”¨lobok</h4><ol><li><p>åœ¨<code>maven</code>ä¸­æ·»åŠ ä¾è³´</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.18.4&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ç·¨è­¯å™¨ä¸­æ·»åŠ æ’ä»¶</p></li></ol><p>ä»¥IDEAç‚ºä¾‹ï¼Œåœ¨settingçš„pluginè£¡æœç´¢lombok pluginï¼Œå®‰è£æ’ä»¶ã€‚</p><p>ç›´æ¥åœ¨Classä¸ŠåŠ ä¸Š@Dataå³å¯</p><p>ä¾‹å¦‚ä¸€ä¸ªç®€å•çš„Person Class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String hobbit;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, String address, Integer age, String hobbit, String phone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.hobbit = hobbit;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getHobbit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hobbit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHobbit</span><span class="params">(String hobbit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hobbit = hobbit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(String phone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Person&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", address='"</span> + address + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">", hobbit='"</span> + hobbit + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", phone='"</span> + phone + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨äº† @Data</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String hobbit;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æŒ‰å¿«æ·éµ <code>Ctrl + F12</code>ï¼Œå¯ä»¥æŸ¥æ‰¾åˆ°set,get,toString æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ @Data è¨»è§£å°±å¯ä»¥æœ‰ä¸‹é¢å¹¾å€‹è¨»è§£çš„åŠŸèƒ½ï¼š @ToStringã€@Getterã€@Setterã€@EqualsAndHashCodeã€@NoArgsConstructor ã€‚</p><p>:::info<br>å¸¸ç”¨çš„å¹¾å€‹è¨»è§£ï¼š<br>@Data ï¼š æ³¨åœ¨é¡ä¸Šï¼Œæä¾›é¡çš„getã€setã€equalsã€hashCodeã€canEqualã€toStringæ–¹æ³•<br>@Setter ï¼š æ³¨åœ¨å±¬æ€§ä¸Šï¼Œæä¾› set æ–¹æ³•<br>@Getter ï¼š æ³¨åœ¨å±¬æ€§ä¸Šï¼Œæä¾› get æ–¹æ³•<br>æ§‹é€ å‡½æ•¸</p><p>@AllArgsConstructor<br>ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å˜é‡ï¼ŒåŒæ—¶å¦‚æœå˜é‡ä½¿ç”¨äº†NotNull annotation ï¼Œ ä¼šè¿›è¡Œæ˜¯å¦ä¸ºç©ºçš„æ ¡éªŒï¼Œ<br>å…¨éƒ¨å‚æ•°çš„Constructorå‡½æ•°çš„è‡ªåŠ¨ç”Ÿæˆï¼Œè¯¥æ³¨è§£çš„ä½œç”¨åŸŸä¹Ÿæ˜¯åªæœ‰åœ¨å®ä½“ç±»ä¸Šï¼Œå‚æ•°çš„é¡ºåºä¸å±æ€§å®šä¹‰çš„é¡ºåºä¸€è‡´ã€‚</p><p>ç¯„ä¾‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import lombok.AllArgsConstructor;</span><br><span class="line"></span><br><span class="line">@AllArgsConstructor</span><br><span class="line">class MyClass&#123;</span><br><span class="line">    private String one;</span><br><span class="line">    private Integer three;  </span><br><span class="line">    private Integer two;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è‡ªå‹•ç”Ÿæˆå»ºæ§‹å­:</span><br><span class="line">public MyClass(String one, Integer three, Integer two) &#123;</span><br><span class="line">    this.one = one;</span><br><span class="line">    this.three = three;</span><br><span class="line">    this.two = two;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åƒè€ƒ: <a href="https://stackoverflow.com/questions/49106072/how-to-specify-the-order-of-parameters-in-allargsconstructor-in-lombok" target="_blank" rel="noopener">https://stackoverflow.com/questions/49106072/how-to-specify-the-order-of-parameters-in-allargsconstructor-in-lombok</a></p><p>@NoArgsConstructor<br>ç”¢ç”Ÿæ²’æœ‰åƒæ•¸çš„å»ºæ§‹å­<br>generate a constructor with no parameters.</p><p>@RequiredArgsConstructor<br>ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å«å¸¸é‡ï¼ˆfinalï¼‰ï¼Œå’Œæ ‡è¯†äº†@NotNullçš„å˜é‡ çš„æ„é€ æ–¹æ³•ã€‚</p><p>@EqualsAndHashCode ï¼š æ³¨åœ¨ç±»ä¸Šï¼Œæä¾›å¯¹åº”çš„ equals å’Œ hashCode æ–¹æ³•<br>@Log4j/@Slf4j ï¼š æ³¨åœ¨ç±»ä¸Šï¼Œæä¾›å¯¹åº”çš„ Logger å¯¹è±¡ï¼Œå˜é‡åä¸º log<br>:::</p><p>:::warning<br>æ³¨æ„çš„æ˜¯ï¼ŒåŒæ—¶ä½¿ç”¨@Data å’Œ @AllArgsConstructor å ï¼Œé»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°å¤±æ•ˆï¼Œå¦‚æœéœ€è¦å®ƒï¼Œè¦é‡æ–°è®¾ç½® @NoArgsConstructor<br>:::</p><p>åƒè€ƒè³‡æ–™</p><p>@Dataæ³¨è§£ ä¸ lombok<br><a href="https://www.jianshu.com/p/c1ee7e4247bf" target="_blank" rel="noopener">https://www.jianshu.com/p/c1ee7e4247bf</a><br>å­¦ä¹ Spring Bootï¼šï¼ˆåäº”ï¼‰ä½¿ç”¨Lombokæ¥ä¼˜é›…çš„ç¼–ç <br><a href="https://blog.wuwii.com/springboot-15.html" target="_blank" rel="noopener">https://blog.wuwii.com/springboot-15.html</a></p><h2 id="Springè¼‰å…¥Beanèˆ‡æ¨™ç¤ºç‚ºBeanæœ‰é—œçš„Annotation"><a href="#Springè¼‰å…¥Beanèˆ‡æ¨™ç¤ºç‚ºBeanæœ‰é—œçš„Annotation" class="headerlink" title="Springè¼‰å…¥Beanèˆ‡æ¨™ç¤ºç‚ºBeanæœ‰é—œçš„Annotation"></a>Springè¼‰å…¥Beanèˆ‡æ¨™ç¤ºç‚ºBeanæœ‰é—œçš„Annotation</h2><h3 id="Bean"><a href="#Bean" class="headerlink" title="@Bean"></a>@Bean</h3><p>å®šç¾©å¯å…±ç‰©ä»¶åŒ–çš„é¡åˆ¥ï¼Œå«åšBeanï¼Œä¸¦ä¸”æ”¾ç½®åœ¨Spring Ioc Containerä¸­ä¸¦ä¸”çµ¦å…¶ç®¡ç†ï¼Œç­‰å¾…è¢«å‘¼å«ä½¿ç”¨ã€‚</p><h4 id="é…ç½®æ–¹å¼"><a href="#é…ç½®æ–¹å¼" class="headerlink" title="é…ç½®æ–¹å¼"></a>é…ç½®æ–¹å¼</h4><h5 id="1-ç¨‹å¼ç¢¼Java-Codeé…ç½®"><a href="#1-ç¨‹å¼ç¢¼Java-Codeé…ç½®" class="headerlink" title="1. ç¨‹å¼ç¢¼Java Codeé…ç½®"></a>1. ç¨‹å¼ç¢¼Java Codeé…ç½®</h5><p>Spring çš„@Beané€šå¸¸å®£å‘Šåœ¨æ›æœ‰@Configurationçš„Springé…ç½®é¡åˆ¥ä¸­çš„æ–¹æ³•å‰ï¼Œä¾‹å¦‚å®£å‘Šä¸€å€‹ AppConfig.javaï¼Œè‹¥æœ‰è¶…éä¸€å€‹ä»¥ä¸Šçš„beanï¼Œä½¿ç”¨ @Qualifierçµ¦äºˆåç¨±</p><p><img src="https://i.imgur.com/EsiQv3V.png" alt=""></p><p>AppConfig.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span>(name=<span class="string">"add"</span>)</span><br><span class="line">    <span class="function">Calculator <span class="title">addCalculator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AddCalculator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name=<span class="string">"sub"</span>)</span><br><span class="line">    <span class="function">Calculator <span class="title">subCalculator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SubCalculator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name=<span class="string">"mul"</span>)</span><br><span class="line">    <span class="function">Calculator <span class="title">mulCalculator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MulCalculator();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®šç¾©Calculatorçš„ä»‹é¢</p><p>Calculator.interface<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface Calculator &#123;</span><br><span class="line">    int calc(int a, int b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å®šç¾©ä¸€å€‹å¯¦ä½œCalculatorçš„é¡åˆ¥</p><p>CalculatorImpl.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.will.advanced.demo.bean;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddCalculator</span> <span class="keyword">implements</span> <span class="title">Calculator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubCalculator</span> <span class="keyword">implements</span>  <span class="title">Calculator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a - b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MulCalculator</span> <span class="keyword">implements</span>  <span class="title">Calculator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a * b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å–å¾—è¨»å†Šçš„beançš„æ–¹å¼"><a href="#å–å¾—è¨»å†Šçš„beançš„æ–¹å¼" class="headerlink" title="å–å¾—è¨»å†Šçš„beançš„æ–¹å¼"></a>å–å¾—è¨»å†Šçš„beançš„æ–¹å¼</h4><h5 id="1-ä½¿ç”¨-Autowire-èˆ‡-Qualifier"><a href="#1-ä½¿ç”¨-Autowire-èˆ‡-Qualifier" class="headerlink" title="1. ä½¿ç”¨@Autowire èˆ‡ @Qualifier"></a>1. ä½¿ç”¨@Autowire èˆ‡ @Qualifier</h5><p>ç„¶å¾Œåœ¨ CommandLineRunnerä¸­ä½¿ç”¨ @AutoWireä½¿ç”¨@Bean<br>ï¼Œç„¶è€Œè‹¥è¦Autowiredçš„é¡åˆ¥å°è±¡æ˜¯ä»‹é¢çš„è©±ï¼Œä¸”ä»‹é¢æœ‰å¾ˆå¤šçš„å¯¦ä½œå­é¡åˆ¥<br>(AddCalculator, SubCalculator, MulCalculator)</p><p>é‚£å¾—é€é @Qualifierä¾†æŒ‡åæ˜¯å“ªä¸€å€‹å­é¡åˆ¥</p><p>CommandLineAppStartupRunner.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandLineAppStartupRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext context;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier</span>(<span class="string">"add"</span>)</span><br><span class="line">    Calculator addCalculator;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier</span>(<span class="string">"sub"</span>)</span><br><span class="line">    Calculator subCalculator;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier</span>(<span class="string">"mul"</span>)</span><br><span class="line">    Calculator mulCaculator;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String...args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(addCalculator.calc(<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(subCalculator.calc(<span class="number">3</span>,<span class="number">2</span>));</span><br><span class="line">        System.out.println(mulCaculator.calc(<span class="number">2</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="2-ä½¿ç”¨getBean"><a href="#2-ä½¿ç”¨getBean" class="headerlink" title="2. ä½¿ç”¨getBean()"></a>2. ä½¿ç”¨getBean()</h5><p>CommandLineAppStartupRunner.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandLineAppStartupRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String...args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//ã€€å–å¾—æ‰€æœ‰å·²ç¶“è¨»å†Šçš„bean</span></span><br><span class="line">        System.out.println(Arrays.asList(context.getBeanDefinitionNames()));</span><br><span class="line">        <span class="comment">// å–å¾—åç¨±ç‚ºaddçš„bean</span></span><br><span class="line">        Calculator addCalculator = context.getBean(<span class="string">"add"</span>, Calculator.class);</span><br><span class="line">        Calculator subCalculator = context.getBean(<span class="string">"sub"</span>, Calculator.class);</span><br><span class="line">        Calculator mulCalculator = context.getBean(<span class="string">"mul"</span>, Calculator.class);</span><br><span class="line">        </span><br><span class="line">        System.out.println(addCalculator.calc(<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(subCalculator.calc(<span class="number">3</span>,<span class="number">2</span>));</span><br><span class="line">        System.out.println(mulCalculator.calc(<span class="number">2</span>,<span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h6 id="è£œå……-ä½¿ç”¨CommandlineRunnerè®“Springè¨­ç½®å¯ä»¥å…ˆè¢«è¼‰å…¥ï¼Œç„¶å¾Œå¯é€érun-å®šç¾©è‡ªè¨‚ç¾©åŸ·è¡Œçš„å…§å®¹"><a href="#è£œå……-ä½¿ç”¨CommandlineRunnerè®“Springè¨­ç½®å¯ä»¥å…ˆè¢«è¼‰å…¥ï¼Œç„¶å¾Œå¯é€érun-å®šç¾©è‡ªè¨‚ç¾©åŸ·è¡Œçš„å…§å®¹" class="headerlink" title="è£œå……: ä½¿ç”¨CommandlineRunnerè®“Springè¨­ç½®å¯ä»¥å…ˆè¢«è¼‰å…¥ï¼Œç„¶å¾Œå¯é€érun()å®šç¾©è‡ªè¨‚ç¾©åŸ·è¡Œçš„å…§å®¹"></a>è£œå……: ä½¿ç”¨CommandlineRunnerè®“Springè¨­ç½®å¯ä»¥å…ˆè¢«è¼‰å…¥ï¼Œç„¶å¾Œå¯é€érun()å®šç¾©è‡ªè¨‚ç¾©åŸ·è¡Œçš„å…§å®¹</h6><p><a href="https://dzone.com/articles/spring-boot-applicationrunner-and-commandlinerunne" target="_blank" rel="noopener">https://dzone.com/articles/spring-boot-applicationrunner-and-commandlinerunne</a></p><h5 id="3-xmlæª”æ¡ˆé…ç½®"><a href="#3-xmlæª”æ¡ˆé…ç½®" class="headerlink" title="3. xmlæª”æ¡ˆé…ç½®"></a>3. xmlæª”æ¡ˆé…ç½®</h5><p>ä¸Šé¢çš„å¯«æ³•ç­‰åŒåœ¨ <code>appConfig.xml</code> å®£å‘Š:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans&gt;</span><br><span class="line">    &lt;bean name=&quot;addCalculator&quot; class=&quot;com.will.advanced.TransferServiceImpl&quot;/&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></p><h4 id="ComponentScan-æƒææŒ‡å®špackageä¸­æ›æœ‰-Componentçš„é¡åˆ¥ï¼Œè‡ªå‹•è¨»å†ŠåŒ…å«çš„bean"><a href="#ComponentScan-æƒææŒ‡å®špackageä¸­æ›æœ‰-Componentçš„é¡åˆ¥ï¼Œè‡ªå‹•è¨»å†ŠåŒ…å«çš„bean" class="headerlink" title="@ComponentScan: æƒææŒ‡å®špackageä¸­æ›æœ‰@Componentçš„é¡åˆ¥ï¼Œè‡ªå‹•è¨»å†ŠåŒ…å«çš„bean"></a>@ComponentScan: æƒææŒ‡å®špackageä¸­æ›æœ‰@Componentçš„é¡åˆ¥ï¼Œè‡ªå‹•è¨»å†ŠåŒ…å«çš„bean</h4><p>ä¸éä¸€èˆ¬åœ¨æ²’æœ‰ç‰¹æ®Šéœ€æ±‚çš„æƒ…æ³ä¸‹éƒ½æœƒä½¿ç”¨@ComponentScanæƒææŒ‡å®špackageä¸­æ›æœ‰@Componentçš„é¡åˆ¥ä¾†è‡ªå‹•è¨»å†Šç‚ºbeanã€‚</p><p>è€Œæœƒä½¿ç”¨@Beançš„æ™‚æ©Ÿç‚ºï¼Œç•¶è¦è¢«è¨»å†Šç‚ºbeançš„é¡åˆ¥å»ºæ§‹æ­¥é©Ÿæˆ–é‚è¼¯æ¯”è¼ƒè¤‡é›œï¼Œæ­¤æ™‚å°±éœ€è¦@Beanè®“ä½ å¯ä»¥åœ¨æ§‹é€ beançš„æ–¹æ³•å…§æ’°å¯«æ§‹é€ çš„è©³ç´°é‚è¼¯ï¼Œè€Œ@ComponentScanå°±ç„¡æ³•æ»¿è¶³æ¯”è¼ƒç´°å¾®çš„é…ç½®ã€‚</p><p>ä¾‹å¦‚åœ¨ serviceå±¤ä¸­æ–°å¢ä¸€å€‹ TestService class<br>é€é@Componentå°‡TestServiceè¨»å†ŠæˆBean<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class TestService &#123;</span><br><span class="line">    public String test() &#123;</span><br><span class="line">        return &quot;testing&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€é@ComponentScanå¯ä½¿ç”¨@Componentè¨»å†Šçš„beanï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandLineAppStartupRunner</span> <span class="keyword">implements</span> <span class="title">CommandLineRunner</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    TestService testService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(String...args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(testService.test());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åƒè€ƒè³‡æ–™-2"><a href="#åƒè€ƒè³‡æ–™-2" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h5><p>Spring: A Head Start ğŸ”¥ â€” Beans Configuration (Part 2)<br><a href="https://medium.com/omarelgabrys-blog/spring-a-head-start-beans-configuration-part-2-4a8c239b070a" target="_blank" rel="noopener">https://medium.com/omarelgabrys-blog/spring-a-head-start-beans-configuration-part-2-4a8c239b070a</a></p><h4 id="Scope-å®šç¾©Beanè¢«å¼•ç”¨æ™‚è¦æ€æ¨£è¢«ä½¿ç”¨"><a href="#Scope-å®šç¾©Beanè¢«å¼•ç”¨æ™‚è¦æ€æ¨£è¢«ä½¿ç”¨" class="headerlink" title="@Scope: å®šç¾©Beanè¢«å¼•ç”¨æ™‚è¦æ€æ¨£è¢«ä½¿ç”¨"></a>@Scope: å®šç¾©Beanè¢«å¼•ç”¨æ™‚è¦æ€æ¨£è¢«ä½¿ç”¨</h4><ul><li>singletonï¼šåœ¨Spring IoC Containerï¼Œè©²beanåªæœƒæœ‰å–®ä¸€å¯¦ä¾‹(a single instance)ï¼Œæ­¤ç‚ºSpringé è¨­å€¼</li><li>prototypeï¼šåœ¨Spring IoC Containerä¸­ï¼Œè©²beanå¯ä»¥æœ‰å¤šå€‹å¯¦ä¾‹(any number of object instances)</li><li>requestï¼š åœ¨æ¯ä¸€æ¬¡çš„HTTP Requestï¼Œspring containeræœƒæ ¹æ“šloginAction beançš„å®šç¾©ä¾†å»ºç«‹ä¸€å€‹å…¨æ–°çš„instanceï¼Œè€Œä¸”åƒ…åœ¨ç›®å‰çš„requestä¸­æœ‰æ•ˆï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒçš„å»æ›´æ”¹instanceçš„å…§éƒ¨ç‹€æ…‹ï¼Œè«‹æ±‚çµæŸï¼Œrequest scopeçš„bean instanceæœƒè¢«destroy</li><li>sessionï¼šé‡å°æŸå€‹HTTP Sessionï¼Œspring containeræœƒæ ¹æ“šuserPreference beançš„å®šç¾©ä¾†å»ºç«‹ä¸€å€‹å…¨æ–°çš„instanceï¼ŒåŒæ¨£çš„ï¼Œå’Œrequest scopeä¸€æ¨£ï¼Œå¯ä»¥æ”¾å¿ƒçš„å»æ›´æ”¹instanceå…§éƒ¨ç‹€æ…‹ã€‚</li><li>global-sessionï¼šåƒ…åœ¨portletç‚ºåŸºç¤çš„Webæ‡‰ç”¨ä¸‹æœ‰ä½œç”¨ã€‚Porletçš„è¦ç¯„ä¸­å®šç¾©äº†global sessionçš„æ¦‚å¿µã€‚</li></ul><h5 id="åƒè€ƒè³‡æ–™-3"><a href="#åƒè€ƒè³‡æ–™-3" class="headerlink" title="åƒè€ƒè³‡æ–™:"></a>åƒè€ƒè³‡æ–™:</h5><p>Spring Bean Scope å­¸ç¿’<br><a href="https://kevingo75.blogspot.com/2012/03/spring-bean-scope.html" target="_blank" rel="noopener">https://kevingo75.blogspot.com/2012/03/spring-bean-scope.html</a></p><h4 id="è£œå……-ä»€éº¼æ˜¯Spring-IoC-Inversion-of-Control-container"><a href="#è£œå……-ä»€éº¼æ˜¯Spring-IoC-Inversion-of-Control-container" class="headerlink" title="è£œå……: ä»€éº¼æ˜¯Spring IoC (Inversion of Control) container."></a>è£œå……: ä»€éº¼æ˜¯Spring IoC (Inversion of Control) container.</h4><p> Inversion of Control, or IoC for short, is a process in which an object defines its dependencies without creating them. This object delegates the job of constructing such dependencies to an IoC container.</p><p>ç”¨ä¸€æŸ±è©±æè¿°IoCï¼š classä¸ç”¨è‡ªå·±ä¸»å‹•newæ¬²ä¾è³´classçš„instanceï¼Œè€Œæ˜¯é€éå¤–éƒ¨ã€€(main()æ–¹æ³•)ã€€ä»¥å»ºæ§‹å­ã€setteræˆ–æ˜¯ä»‹é¢æ³¨å…¥ä¾†ç”¢ç”Ÿä¾è³´classçš„instance</p><p>:::success<br>éœ€è¦çš„ éŠæˆ²ï¼Œä¸ç”¨è‡ªå·± ä¸‹è¼‰ï¼Œè€Œæ˜¯ ç¶²å’–æä¾› çµ¦ä½ ã€‚<br>â€”â€”â€”â€”â€”â€”â€”-||â€”â€”â€”â€”â€”â€”â€”</p><p>éœ€è¦çš„ ç‰©ä»¶ï¼Œä¸ç”¨è‡ªå·± å–å¾—ï¼Œè€Œæ˜¯ æœå‹™å®¹å™¨ æä¾› çµ¦ä½ ã€‚<br>â€”â€”â€”â€”â€”â€”â€”-||â€”â€”â€”â€”â€”â€”â€”<br>éœ€è¦çš„ ä¾è³´å¯¦ä¾‹ï¼Œä¸ç”¨ ä¸»å‹• (Active) å»ºç«‹ï¼Œè€Œæ˜¯ è¢«å‹• (Passive) æ¥æ”¶ã€‚<br>:::</p><h5 id="åƒè€ƒè³‡æ–™ï¼š-1"><a href="#åƒè€ƒè³‡æ–™ï¼š-1" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h5><p>æ§åˆ¶åè½‰ (IoC) èˆ‡ ä¾è³´æ³¨å…¥ (DI)<br><a href="https://notfalse.net/3/ioc-di" target="_blank" rel="noopener">https://notfalse.net/3/ioc-di</a></p><h3 id="Repository"><a href="#Repository" class="headerlink" title="@Repository"></a>@Repository</h3><p>ç®€åŒ– Spring çš„å¼€å‘ã€‚@Repositoryæ³¨è§£ä¾¿å±äºæœ€å…ˆå¼•å…¥çš„ä¸€æ‰¹ï¼Œå®ƒç”¨äºå°†æ•°æ®è®¿é—®å±‚ (DAO å±‚ ) çš„ç±»æ ‡è¯†ä¸º Spring Beanã€‚å…·ä½“åªéœ€å°†è¯¥æ³¨è§£æ ‡æ³¨åœ¨ DAOç±»ä¸Šå³å¯ã€‚</p><h3 id="Serviceã€-Controller-å’Œ-Component-å°‡classæ¨™ç¤ºä¸ºBean"><a href="#Serviceã€-Controller-å’Œ-Component-å°‡classæ¨™ç¤ºä¸ºBean" class="headerlink" title="@Serviceã€@Controller å’Œ @Component å°‡classæ¨™ç¤ºä¸ºBean"></a>@Serviceã€@Controller å’Œ @Component å°‡classæ¨™ç¤ºä¸ºBean</h3><ul><li>@Component æ˜¯ä¸€ä¸ªæ³›åŒ–çš„æ¦‚å¿µï¼Œä»…ä»…è¡¨ç¤ºä¸€ä¸ªç»„ä»¶ (Bean) ï¼Œå¯ä»¥ä½œç”¨åœ¨ä»»ä½•å±‚æ¬¡ã€‚</li><li>@Service é€šå¸¸ä½œç”¨åœ¨æ¥­å‹™é‚è¼¯å±¤ï¼Œä½†æ˜¯ç›®å‰è¯¥åŠŸèƒ½ä¸ @Component ç›¸åŒã€‚</li><li>@Controller é€šå¸¸ä½œç”¨åœ¨æ§åˆ¶å±¤(Controller)ï¼Œä½†æ˜¯ç›®å‰è¯¥åŠŸèƒ½èˆ‡@Component ç›¸åŒã€‚</li></ul><h3 id="PostConstruct"><a href="#PostConstruct" class="headerlink" title="@PostConstruct"></a>@PostConstruct</h3><p>è¢«@PostConstructä¿®é£¾çš„æ–¹æ³•æœƒåœ¨æœå‹™å™¨åŠ è¼‰Servletçš„æ™‚å€™é‹è¡Œï¼Œä¸¦ä¸”åªæœƒè¢«æœå‹™å™¨åŸ·è¡Œä¸€æ¬¡ã€‚</p><h3 id="Transactional"><a href="#Transactional" class="headerlink" title="@Transactional"></a>@Transactional</h3><p>å‡è‹¥ä½ åœ¨classä¸­è¨­å®šäº†@Transactional, è©²classæ‰€æœ‰çš„methodæœ‰ä½¿ç”¨åˆ°JPAçš„éƒ½æœƒè¢«springçš„transactionæ‰€ç®¡ç†ã€‚</p><p>èˆ‰ä¾‹ï¼šç•¶æœ‰å€‹Transactionæœ‰ä¸‰å€‹å‹•ä½œï¼šentity1.save, entity2.save, entity3.save.</p><p>è‹¥entity3.saveå¤±æ•—ï¼Œé‚£Springå°±æœƒå°‡entity1.saveèˆ‡entity2.saveçš„åŸ·è¡Œçµæœçµ¦rollbackï¼Œé‚„åŸå…¶å‹•ä½œã€‚</p><h4 id="åƒè€ƒè³‡æ–™-4"><a href="#åƒè€ƒè³‡æ–™-4" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h4><p><a href="https://stackoverflow.com/questions/1099025/spring-transactional-what-happens-in-background" target="_blank" rel="noopener">https://stackoverflow.com/questions/1099025/spring-transactional-what-happens-in-background</a></p><h2 id="AOPç›¸é—œçš„Annotaion"><a href="#AOPç›¸é—œçš„Annotaion" class="headerlink" title="AOPç›¸é—œçš„Annotaion"></a>AOPç›¸é—œçš„Annotaion</h2><h3 id="Aspect"><a href="#Aspect" class="headerlink" title="@Aspect"></a>@Aspect</h3><p>@Aspect:å®šç¾©AOPï¼Œä½œç”¨åœ¨class</p><p>AOPç‚º Aspect Oritented Programming<br>AOPé€šéçµ¦ç¨‹åºå®šç¾©ä¸€å€‹åˆ‡å…¥é»ï¼Œç„¶å¾Œåœ¨å…¶å‰å¾Œåˆ‡å…¥ä¸åŒçš„åŸ·è¡Œå…§å®¹<br>AOPä¸æœƒç ´å£åŸä¾†çš„ç¨‹åºé‚è¼¯<br>AOPä½¿ç”¨å ´æ™¯ï¼š</p><ul><li>ç´€éŒ„æ—¥èªŒ</li><li>äº‹å‹™ç®¡ç†</li><li>å®‰å…¨æª¢æŸ¥</li><li>è³‡æºæ§åˆ¶</li></ul><h3 id="Pointcut-Before-After"><a href="#Pointcut-Before-After" class="headerlink" title="@Pointcut, @Before, @After"></a>@Pointcut, @Before, @After</h3><p>ç¯„ä¾‹<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(<span class="keyword">this</span>.getClass());</span><br><span class="line">    <span class="comment">// åˆ‡å…¥packageç‚ºcom.william.demo.apiçš„LogTestApié¡åˆ¥çš„logå‡½å¼</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(* com.william.demo.api.LogTestApi.log(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸Œæœ›åœ¨åˆ‡å…¥é»ã€€log()å‡½å¼å‰åŸ·è¡ŒæŸäº›å…§å®¹</span></span><br><span class="line">    <span class="comment">// æˆ–æ˜¯ç”¨ç›´æ¥ç”¨ã€€@Before("execution(* com.william.demo.api.LogTestApi.log(..))");</span></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"log()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"----------do before---------"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"log()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        logger.info(<span class="string">"----------do after----------"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å…¶ä»–Annotation"><a href="#å…¶ä»–Annotation" class="headerlink" title="å…¶ä»–Annotation"></a>å…¶ä»–Annotation</h2><h3 id="Cache"><a href="#Cache" class="headerlink" title="@Cache"></a>@Cache</h3><p>å®šç¾©cacheç­–ç•¥èˆ‡ç¯„åœï¼Œå¯ä»¥å®šç¾©ä»¥ä¸‹åƒæ•¸ï¼š</p><ul><li><p>usage: ç•¶å‰ç·©å­˜ç­–ç•¥(NONE, READ_ONLY, NONSTRICT_READ_WRITE, TRANSACTIONAL)</p><ul><li>read-only: åªè®€ç·©å­˜<ul><li>å¦‚æœä½ çš„æ‡‰ç”¨ç¨‹åºåªéœ€è®€å–ä¸€å€‹æŒä¹…åŒ–é¡çš„å¯¦ä¾‹ï¼Œè€Œç„¡éœ€å°å…¶ä¿®æ”¹ï¼Œ é‚£éº¼å°±å¯ä»¥å°å…¶é€²è¡Œåªè®€ç·©å­˜</li></ul></li><li>read-write: è®€å¯«ç·©å­˜<ul><li>å¦‚æœæ‡‰ç”¨ç¨‹åºéœ€è¦æ›´æ–°æ•¸æ“šï¼Œé‚£éº¼ä½¿ç”¨è®€/å¯«ç·©å­˜æ¯”è¼ƒåˆé©ã€‚å¦‚æœæ‡‰ç”¨ç¨‹åºè¦æ±‚â€œåºåˆ—åŒ–äº‹å‹™â€çš„éš”é›¢ç´šåˆ¥ï¼ˆserializable transaction isolation levelï¼‰ï¼Œé‚£éº¼å°±æ±ºä¸èƒ½ä½¿ç”¨é€™ç¨®ç·©å­˜ç­–ç•¥</li></ul></li><li>nonstrict-read-write: ä¸åš´æ ¼è®€å¯«ç·©å­˜<ul><li>å¦‚æœæ‡‰ç”¨ç¨‹åºåªå¶çˆ¾éœ€è¦æ›´æ–°æ•¸æ“šï¼ˆä¹Ÿå°±æ˜¯èªªï¼Œå…©å€‹äº‹å‹™åŒæ™‚æ›´æ–°åŒä¸€è¨˜éŒ„çš„æƒ…æ³å¾ˆä¸å¸¸è¦‹ï¼‰ï¼Œä¹Ÿä¸éœ€è¦ååˆ†åš´æ ¼çš„äº‹å‹™éš”é›¢ï¼Œé‚£éº¼æ¯”è¼ƒé©åˆä½¿ç”¨éåš´æ ¼è®€/å¯«ç·©å­˜ç­–ç•¥ã€‚</li></ul></li><li>transactional :äº‹å‹™æ€§ç·©å­˜<ul><li>Hibernate çš„äº‹å‹™ç·©å­˜ç­–ç•¥æä¾›äº†å…¨äº‹å‹™çš„ç·©å­˜æ”¯æŒï¼Œä¾‹å¦‚å° JBoss TreeCache çš„æ”¯æŒã€‚é€™æ¨£çš„ç·©å­˜åªèƒ½ç”¨æ–¼ JTA ç’°å¢ƒä¸­ï¼Œä½ å¿…é ˆæŒ‡å®šç‚ºå…¶hibernate.transaction.manager_lookup_classå±¬æ€§ã€‚</li></ul></li></ul></li><li><p>region: å¯é¸åƒæ•¸ï¼ŒæŒ‡å®šäºŒç´šç·©å­˜çš„å»åŸŸåï¼Œé»˜èªç‚ºé¡æˆ–è€…é›†åˆçš„åå­—ã€‚</p></li><li>include: å¯é¸åƒæ•¸(all, non-lazy)ã€‚ allåŒ…å«æ‰€æœ‰å±¬æ€§ï¼Œnon-lazyåƒ…åŒ…å«éå»¶é²åŠ è¼‰çš„å±¬æ€§ã€‚</li></ul><h4 id="ç¯„ä¾‹"><a href="#ç¯„ä¾‹" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Table(name = &quot;PROVICE&quot;)</span><br><span class="line">@Cache(usage =CacheConcurrencyStrategy.READ_ONLY)</span><br><span class="line">public class Province() &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Table(name = &quot;PROVICE&quot;)</span><br><span class="line">@Cache(usage =CacheConcurrencyStrategy.READ_ONLY)</span><br><span class="line">public class Province() &#123; </span><br><span class="line">    @OneToMany(fetch = FetchType.LAZY)</span><br><span class="line">    @JoinColumn(name = &quot;cityId&quot;)</span><br><span class="line">    @Cache(usage = CacheConcrrencyStrategy.READ_ONLY)</span><br><span class="line">    private Set&lt;City&gt; cities;</span><br></pre></td></tr></table></figure><h5 id="åƒè€ƒè³‡æ–™-5"><a href="#åƒè€ƒè³‡æ–™-5" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h5><p>Hibernate @Cacheæ³¨è§£-å¤©æ‰å°å°å¸ƒ<br><a href="https://blog.csdn.net/w410589502/article/details/54603265" target="_blank" rel="noopener">https://blog.csdn.net/w410589502/article/details/54603265</a></p><h3 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h3><p>@Configurationçš„ä½œç”¨åŒä»¥å‰çš„xmlé…ç½®æª”ï¼ˆä¾‹å¦‚Springçš„applicationContext.xmlæˆ–dispatcher-servlet.xmlï¼‰ï¼Œç”¨ä¾†è¨­å®šSpringç’°å¢ƒé…ç½®ï¼Œä¾‹å¦‚å®£å‘ŠåŠè¨»å†Šbeanè‡³Springå®¹å™¨ä¸­ï¼Œæ³¨å…¥propertiesåƒæ•¸ç­‰ã€‚</p><h4 id="ç¯„ä¾‹-1"><a href="#ç¯„ä¾‹-1" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h4><p>ä¾‹å¦‚æˆ‘å€‘æœ‰ä¸€å€‹FooServiceé¡åˆ¥ï¼Œè‹¥æ­¤é¡åˆ¥è¦æˆç‚ºSpringå®¹å™¨ç®¡ç†çš„beanï¼Œæœ‰å…©ç¨®æ–¹æ³•ï¼š</p><ol><li>ä¸€èˆ¬åœ¨è©²é¡åˆ¥ä¸Šå®£å‘Š@Componentä¸¦æ­é…@ComponentScanæƒæçš„æ–¹å¼è¨»å†Šç‚ºbean</li><li>é€éåœ¨@Configurationé¡åˆ¥ä¸­æ­é…@Beançš„æ–¹å¼è¨»å†Šã€‚</li></ol><p>ä¾‹å¦‚å»ºç«‹ä¸€å€‹AppConfigä¸¦åœ¨é¡åˆ¥åç¨±å‰æ›ä¸Š@Configurationï¼Œå‰‡æ­¤é¡åˆ¥åŠæˆç‚ºSpringçš„é…ç½®é¡ã€‚åœ¨é…ç½®é¡çš„æ–¹æ³•å‰æ›ä¸Š@Beanå‰‡æ–¹æ³•å›å‚³çš„ç‰©ä»¶å°±æœƒè¢«è¨»å†Šç‚ºSpringå®¹å™¨ç®¡ç†çš„bean</p><p>fooService()æ–¹æ³•ä¾¿æœƒå°‡FooServiceè¨»å†Šç‚ºbeanã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.will.advanced.demo.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.will.advanced.demo.service.FooService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FooService <span class="title">fooService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FooService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç‚ºäº†ç¨‹å¼ç®¡ç†åŠç¶­è­·ä¸Šçš„æ–¹ä¾¿ï¼Œé€šå¸¸æˆ‘å€‘æœƒæŠŠæŸäº›ç›¸é—œçš„é…ç½®å¯«åœ¨å¦å¤–çš„é…ç½®æª”ï¼Œè€Œä¸æ˜¯å…¨éƒ¨å¡åœ¨åŒä¸€å€‹é¡åˆ¥ï¼Œæ­¤æ™‚å°±å¯ä»¥åˆ©ç”¨@Configurationå¦å¤–å®šç¾©ä¸€å€‹é…ç½®æª”ï¼Œä¾‹å¦‚ä¸Šé¢çš„AppConfigã€‚</p><h4 id="SpringBootApplication-æœ¬èº«ä¹ŸåŒ…å«-Configuration"><a href="#SpringBootApplication-æœ¬èº«ä¹ŸåŒ…å«-Configuration" class="headerlink" title="@SpringBootApplication: æœ¬èº«ä¹ŸåŒ…å«@Configuration"></a>@SpringBootApplication: æœ¬èº«ä¹ŸåŒ…å«@Configuration</h4><p>è€Œåœ¨Spring Bootä¸­ï¼Œ<span style="color:red">@SpringBootApplicationé¡æœ¬èº«å³åŒ…å«äº†@Configurationï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨è£¡é¢é€²è¡Œå¦‚ä¸ŠBeançš„é…ç½®</span>ï¼Œä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.will.advanced.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.will.advanced.demo.FooService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootBeanDemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringBootBeanDemoApplication.class, args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FooService <span class="title">fooService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FooService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åƒè€ƒè³‡æ–™-6"><a href="#åƒè€ƒè³‡æ–™-6" class="headerlink" title="åƒè€ƒè³‡æ–™"></a>åƒè€ƒè³‡æ–™</h5><p>Spring @Configurationä½œç”¨<br><a href="https://matthung0807.blogspot.com/2019/04/spring-configuration_28.html" target="_blank" rel="noopener">https://matthung0807.blogspot.com/2019/04/spring-configuration_28.html</a></p><h3 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h3><p>å®šç¾© @SpringBootApplicationçš„é è¨­æƒç„beançš„ç¯„åœ</p><p>Spring Bootçš„@SpringBootApplicationé è¨­åªæœƒæƒææ‰€å±¬packageä¸‹çš„é¡ï¼Œå› æ­¤è‹¥@Configurationé¡åˆ¥å®šç¾©åœ¨@SpringBootApplicationé¡ä»¥å¤–çš„packageï¼Œå‰‡è¦ç”¨scanBasePackageså±¬æ€§ä¾†è¨­å®šè¦é¡å¤–æƒæçš„packageï¼Œä¾‹å¦‚@SpringBootApplication(scanBasePackages=â€com.will.advanced.demo.configâ€)ã€€ï¼ˆ@ConfigurationåŒ…å«äº†@Componentï¼‰ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.will.advanced.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="comment">// æ³¨æ„åœ¨scanBasePackagesçš„packageåç¨±</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span>(scanBasePackages=<span class="string">"com.will.advanced.demo.config"</span>) </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootBeanDemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringBootBeanDemoApplication.class, args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Import"><a href="#Import" class="headerlink" title="@Import"></a>@Import</h4><p>æˆ–æ˜¯é€é@Importä¾†å¼•å…¥ ï¼Œä¾‹å¦‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.will.advanced.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Import;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="comment">// æ³¨æ„pacakgeåç¨±</span></span><br><span class="line"><span class="meta">@Import</span>(value = &#123; com.will.advanced.demo.config.AnotherAppConfig.class &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringBootBeanDemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(SpringBootBeanDemoApplication.class, args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>:::warning<br>æ³¨æ„ä½¿ç”¨@Importæœƒå¿½ç•¥@Configurationè¨­å®š<br>:::</p><h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><p>ä¾è³´æ³¨å…¥ç‰©ä»¶</p><p>Springçš„@Autowiredç”¨ä¾†ä¾è³´æ³¨å…¥ç‰©ä»¶ï¼Œå…¸å‹çš„ç”¨æ³•å°±æ˜¯æ›åœ¨é¡åˆ¥æˆå“¡è®Šæ•¸ä¸Šã€‚@Autowiredé è¨­æœƒä¾æ³¨å…¥å°è±¡çš„é¡åˆ¥å‹æ…‹ä¾†é¸æ“‡å®¹å™¨(é€é@Configurationå®šç¾©çš„classæœƒæˆç‚ºå®¹å™¨)ä¸­ç›¸ç¬¦çš„ç‰©ä»¶(è¨­ç½®æˆbean)ä¾†æ³¨å…¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Car car;</span><br></pre></td></tr></table></figure><p>Springæœƒè‡ªå‹•å»å®¹å™¨ä¸­æ‰¾åˆ°ã€€æœ‰å®¹å™¨å®šç¾©CarBeansçš„bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ....xxx.Car;</span><br><span class="line"><span class="meta">@Configuation</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CarBeans</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Car <span class="title">car</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> Car() &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@Autowireç‚ºSpring IoCçš„å¯¦ç¾ï¼Œä¸ç”¨è‡ªå·±å»newä¸€å€‹carå‡ºä¾†ï¼Œè€Œæ˜¯é€éå®¹å™¨(æœƒåšconstructor or setter or interface injection)ï¼Œä¾†å»å¯¦ç¾å¤–éƒ¨æ³¨å…¥ï¼Œé™ä½æ¨¡çµ„(class)ä¹‹é–“çš„è€¦åˆæ€§</p><h3 id="EnableScheduling"><a href="#EnableScheduling" class="headerlink" title="@EnableScheduling"></a>@EnableScheduling</h3><p>è‹¥é–‹ç™¼è€…åœ¨AppConfigé¡ä¸­ä½¿ç”¨äº†@EnableSchedulingï¼Œä¸¦åœ¨æŸå€‹task classä¸­ä½¿ç”¨äº†@Scheduleè¨»è§£ï¼Œé‚£éº¼è¢«@Scheduleæ¨™è¨»çš„æ–¹æ³•æ—¢å¯ä»¥åœ¨æŒ‡å®šæ™‚é–“å…§è‡ªå‹•åŸ·è¡Œ</p><p>æ³¨æ„ï¼š@EnableSchedulingè¦èˆ‡@Scheduleæ­é…ä½¿ç”¨æ‰æœ‰æ•ˆæœ</p><h3 id="ConfigurationProperties"><a href="#ConfigurationProperties" class="headerlink" title="@ConfigurationProperties"></a>@ConfigurationProperties</h3><p>è‹¥æƒ³è¦æŠŠé…ç½®æ–‡ä»¶çš„ä¿¡æ¯ï¼Œè®€å–å¥½ä¸¦è‡ªå‹•å°è£(getterè®€å–privateçš„configå€¼)æˆå¯¦é«”é¡ï¼Œå¦‚æ­¤ä¸€ä¾†æˆ‘å€‘åœ¨ä»£ç¢¼è£¡é¢ä½¿ç”¨å°±è¼•é¬†è¨±å¤šï¼Œé€™æ™‚å°±å¯ä»¥ä½¿ç”¨@ConfiguationPropertiesï¼ŒæŠŠåŒé¡çš„é…ç½®è¨Šæ¯è‡ªå‹•å°è£æˆå¯¦é«”é¡ã€‚</p><p>å‡è¨­æœ‰è¨­å®šæ–‡ä»¶åœ¨ <code>application.properties</code>ä¹‹ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">connection.username=admin</span><br><span class="line">connection.password=kyjufskifas2jsfs</span><br><span class="line">connection.remoteAddress=192.168.1.1</span><br></pre></td></tr></table></figure></p><p>æˆ‘å€‘å¯ä»¥å®šç¾©ä¸€å€‹å¯¦é«”é¡åœ¨è£è¼‰é…ç½®æ–‡ä»¶ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix=<span class="string">"connection"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectionSettings</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String remoteAddress;</span><br><span class="line">    <span class="keyword">private</span> String password ;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRemoteAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> remoteAddress;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemoteAddress</span><span class="params">(String remoteAddress)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.remoteAddress = remoteAddress;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº¦å¯ä»¥æŠŠ @ConfigurationProperties å®šç¾©åœ¨@Beanä¹‹ä¸‹ï¼Œèªªæ˜@Beanæ˜¯åƒè€ƒåˆ°æœ‰ç”¨configuationPropertiesè¨­å®šçš„class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplication</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"connection"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ConnectionSettings <span class="title">connectionSettings</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConnectionSettings();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦ä½¿ç”¨æ™‚ç›´æ¥ç”¨@Autowireæ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/task"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ã€€åœ¨é€™è£¡æ³¨å…¥ configï¼</span></span><br><span class="line">    <span class="meta">@Autowired</span> ConnectionSettings conn;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = &#123;<span class="string">"/"</span>,<span class="string">""</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hellTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String userName = conn.getUsername();     </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello task !!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åƒè€ƒè³‡æ–™ï¼š-2"><a href="#åƒè€ƒè³‡æ–™ï¼š-2" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h5><p>spring boot ä½¿ç”¨@ConfigurationProperties<br><a href="https://blog.csdn.net/yingxiake/article/details/51263071" target="_blank" rel="noopener">https://blog.csdn.net/yingxiake/article/details/51263071</a></p><h3 id="ConditionalOnClass"><a href="#ConditionalOnClass" class="headerlink" title="@ConditionalOnClass"></a>@ConditionalOnClass</h3><p>æ˜¯Springbootå®ç°è‡ªåŠ¨é…ç½®çš„é‡è¦æ”¯æ’‘ä¹‹ä¸€ã€‚å…¶ç”¨é€”æ˜¯åˆ¤æ–­å½“å‰classpathä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šç±»ï¼Œè‹¥æ˜¯åˆ™å°†å½“å‰çš„é…ç½®è£…è½½å…¥springå®¹å™¨ã€‚</p><h5 id="åƒè€ƒè³‡æ–™ï¼š-3"><a href="#åƒè€ƒè³‡æ–™ï¼š-3" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h5><p>@ConditionalOnClassçš„ä½¿ç”¨æ¢ç´¢ æ–°æ—¥æš®é‡Œæ ¼æ–—å¤§ä¼š<br><a href="https://blog.csdn.net/lucyTheSlayer/article/details/80430912" target="_blank" rel="noopener">https://blog.csdn.net/lucyTheSlayer/article/details/80430912</a></p><h3 id="ConditionalOnMissingBean"><a href="#ConditionalOnMissingBean" class="headerlink" title="@ConditionalOnMissingBean"></a>@ConditionalOnMissingBean</h3><p>ç»“åˆä½¿ç”¨æ³¨è§£@ConditionalOnMissingBeanå’Œ@Bean,å¯ä»¥åšåˆ°åªæœ‰ç‰¹å®šåç§°æˆ–è€…ç±»å‹çš„Beanä¸å­˜åœ¨äºBeanFactoryä¸­æ—¶æ‰åˆ›å»ºæŸä¸ªBean </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConditionalOnMissingBeanConfig</span> </span>&#123;</span><br><span class="line">  <span class="comment">//ã€€ç„¡æ¢ä»¶å®šç¾©ä¸€å€‹bean</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> A <span class="title">beanA</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> A(); <span class="comment">//ã€€</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">ã€€<span class="meta">@ConditionalOnMissingBean</span>(name=<span class="string">"beanA"</span>)</span><br><span class="line">ã€€<span class="function"><span class="keyword">public</span> B <span class="title">beanB</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ beanFactory ä¸­å­˜åœ¨ä¸€ä¸ªåç§°ä¸º beanA çš„ beanï¼Œæ‰å®šä¹‰bean ï¼š beanBï¼›</span></span><br><span class="line">ã€€ã€€<span class="comment">// å› ä¸ºä¸Šé¢çš„æ–¹æ³•å·²ç»å®šä¹‰äº†ä¸€ä¸ª beanAï¼Œæ‰€ä»¥è¿™é‡Œ beanBå®šä¹‰å¹¶ä¸ä¼šå‘ç”Ÿã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> B(); </span><br><span class="line">ã€€&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ã€€<span class="meta">@Bean</span></span><br><span class="line">ã€€<span class="meta">@ConditionalOnMissingBean</span>(name=<span class="string">"beanD"</span>)</span><br><span class="line">ã€€<span class="function"><span class="keyword">public</span> C <span class="title">beanC</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ beanFactory ä¸­å­˜åœ¨ä¸€ä¸ªåç§°ä¸º beanDçš„ beanï¼Œæ‰å®šä¹‰bean ï¼š beanCï¼›    </span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> C(); </span><br><span class="line">ã€€&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åƒè€ƒè³‡æ–™ï¼š-4"><a href="#åƒè€ƒè³‡æ–™ï¼š-4" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h4><p>Spring BootåŸºäºç‰¹å®šæ¡ä»¶åˆ›å»ºBeanä¾‹å­ : ConditionalOnMissingBeanhttps:<br>//blog.csdn.net/andy_zhang2007/article/details/81285130</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Spring-Annotation-ç­†è¨˜&quot;&gt;&lt;a href=&quot;#Spring-Annotation-ç­†è¨˜&quot; class=&quot;headerlink&quot; title=&quot;Spring Annotation ç­†è¨˜&quot;&gt;&lt;/a&gt;Spring Annotation ç­†è¨˜&lt;/h1&gt;&lt;p&gt;é€™é‚Šä¸»è¦æ•´ç†äº†æˆ‘ä½¿ç”¨æˆ–æ˜¯é‡åˆ°çš„Spring Annotationè³‡æ–™æŸ¥è©¢èˆ‡çµ±æ•´çš„ç´€éŒ„&lt;/p&gt;
    
    </summary>
    
      <category term="Spring" scheme="http://a10000005588.github.io/categories/Spring/"/>
    
    
      <category term="Java" scheme="http://a10000005588.github.io/tags/Java/"/>
    
      <category term="Spring" scheme="http://a10000005588.github.io/tags/Spring/"/>
    
  </entry>
  
</feed>
