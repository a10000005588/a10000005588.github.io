<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>Archives: 2020 | William&#39;s 隨手札記</title>
  <meta name="description" content="Just record it.">
  <meta name="keywords" content="">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/images/shiba.ico">
  <link rel="alternate" href="/atom.xml" title="William's 隨手札記">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Just record it.">
<meta property="og:type" content="website">
<meta property="og:title" content="William&#39;s 隨手札記">
<meta property="og:url" content="http://a10000005588.github.io/archives/2020/index.html">
<meta property="og:site_name" content="William&#39;s 隨手札記">
<meta property="og:description" content="Just record it.">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="William&#39;s 隨手札記">
<meta name="twitter:description" content="Just record it.">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href="//cdn.bootcss.com/node-waves/0.7.5/waves.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>
</html>
<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class="wrapper">
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href="/">
				William's 隨手札記
			</a>
			<div class="menu">
				<ul class="h-list">
					
						<li>
							<a class="flat-box nav-home" href="/">
								Home
							</a>
						</li>
					
						<li>
							<a class="flat-box nav-archives" href="/archives">
								History Path
							</a>
						</li>
					
						<li>
							<a class="flat-box nav-about" href="/about">
								About Me
							</a>
						</li>
					
				</ul>
				<div class="underline"></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search">
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a href="javascript:void(0)"><span class="icon icon-search flat-box"></span></a></li>
				
				<li class="s-menu"><a href="javascript:void(0)"><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class="nav-sub container container--flex">
			<a class="logo" href="javascript:void(0)">
				Word of Forks
			</a>

			<ul class="switcher h-list">
				<li class="s-comment"><a href="javascript:void(0)"><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class="s-top"><a href="javascript:void(0)"><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class="s-toc"><a href="javascript:void(0)"><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				History Path
			</a>
		
			<a href="/about" class="nav-about nav">
				About Me
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        
	
  <script>
    window.subData= { title:'Year : 2020'}
  </script>

<section class="post-list">
	
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/11/07/Go-Module-入門與使用介紹介紹/">
        Go Module 入門與使用介紹介紹 
      </a>
    </h2>
    
    <time>
      Nov 7, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <h1 id="Go-Modules-入門與使用紀錄"><a href="#Go-Modules-入門與使用紀錄" class="headerlink" title="Go Modules 入門與使用紀錄"></a>Go Modules 入門與使用紀錄</h1><p>Go Modules 為目前最主流的依賴解決的方案</p>
<p>發佈於 Go 11.1版，於Go 1.14推薦在Production環境上使用</p>
<p>Go Modules的出現解決了以下幾點爭議：</p>
<ul>
<li>依賴問題</li>
<li>淘汰GOPATH的機制</li>
<li>統一社群中其他依賴管理工具</li>
</ul>
<h2 id="為何-GOPATH-不在被推薦使用"><a href="#為何-GOPATH-不在被推薦使用" class="headerlink" title="為何 GOPATH 不在被推薦使用"></a>為何 GOPATH 不在被推薦使用</h2><h3 id="簡單介紹"><a href="#簡單介紹" class="headerlink" title="簡單介紹"></a>簡單介紹</h3><p>GOPATH原先是透過定義好的目錄結構如下：</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">go</span><br><span class="line">|--bin</span><br><span class="line">|--pkg</span><br><span class="line">|--src</span><br><span class="line">    |--github.com</span><br><span class="line">    |--golang.org</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>各目錄分別為：</p>
<ul>
<li>bin: 儲存所編譯產生的二進位檔案</li>
<li>pkg: 儲存預先編譯的目的檔案，以加快程式的後續編譯速度</li>
<li>src: 儲存所有 .go 檔案或原始程式碼<ul>
<li>一般會以 <code>$GOPATH/src/github.com/</code> 儲存 Go的應用程式和函式庫</li>
</ul>
</li>
</ul>
<h3 id="棄用原因-無法明確定義與參照依賴-Dependency-的版本"><a href="#棄用原因-無法明確定義與參照依賴-Dependency-的版本" class="headerlink" title="棄用原因: 無法明確定義與參照依賴(Dependency)的版本"></a>棄用原因: 無法明確定義與參照依賴(Dependency)的版本</h3><p>因為<code>.go</code> 專案都必須要儲存在 <code>$GOPATH/src</code> 底下，但該依賴管理方式並沒有提供版本控制的概念，會造成以下問題：</p>
<ol>
<li>執行<code>go get</code> 取得遠端的依賴包時，會無法得知目前所載的版本</li>
<li>無法處理 v1,v2,v3等不同版本的參考問題，假設有的Library叫做 <code>/foo/bar</code> 但不管幾版，都會在GOPATH底下，其路徑都會是一樣的 (都在github.com/foo/bar)</li>
</ol>
<h2 id="Go-modules的基本使用方式"><a href="#Go-modules的基本使用方式" class="headerlink" title="Go modules的基本使用方式"></a>Go modules的基本使用方式</h2><h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><ul>
<li><code>go mod init</code>: 產生 go.mod 檔案</li>
<li><code>go mod download</code>: 下載go.mod檔案中指明的所有依賴</li>
<li><code>go mod tidy</code>: 整理所有依賴</li>
<li><code>go mod graph</code>: 檢視現有的依賴結構</li>
<li><code>go mod edit</code>: 編輯 go.mod 檔案</li>
<li><code>go mod vendor</code>: 會出專案所有的依賴到vendor目錄</li>
<li><code>go mod verify</code>: 驗證一個模組是否被竄改過</li>
<li><code>go mod why</code>: 檢視為何需要依賴該模組</li>
</ul>
<h3 id="環境變數"><a href="#環境變數" class="headerlink" title="環境變數"></a>環境變數</h3><p>可透過 <code>go env</code> 來檢視常用的環境變數，以下為與Go Module相關的環境變數</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> GOMODULES新增的環境變數</span><br><span class="line">GO111MODULE="on"</span><br><span class="line">GOPROXY="https://proxy.golang.org,direct"</span><br><span class="line">GONOPROXY=""</span><br><span class="line">GOSUMDB="sum.golang.org"</span><br><span class="line">GONOSUMDB=""</span><br><span class="line">GOPRIVATE=""</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 以下為原本GOPATH就有的環境變數</span><br><span class="line">GOARCH="amd64"</span><br><span class="line">GOBIN="/Users/user/go/bin"</span><br><span class="line">GOCACHE="/Users/user/Library/Caches/go-build"</span><br><span class="line">GOENV="/Users/user/Library/Application Support/go/env"</span><br><span class="line">GOEXE=""</span><br><span class="line">GOFLAGS=""</span><br><span class="line">GOHOSTARCH="amd64"</span><br><span class="line">GOHOSTOS="darwin"</span><br><span class="line">GOINSECURE=""</span><br><span class="line">GOMODCACHE="/Users/user/go/pkg/mod"</span><br><span class="line">GOOS="darwin"</span><br><span class="line">GOPATH="/Users/user/go"</span><br><span class="line">GOROOT="/usr/local/Cellar/go/1.15/libexec"</span><br><span class="line">GOTMPDIR=""</span><br><span class="line">GOTOOLDIR="/usr/local/Cellar/go/1.15/libexec/pkg/tool/darwin_amd64"</span><br><span class="line">GCCGO="gccgo"</span><br><span class="line">AR="ar"</span><br><span class="line">CC="clang"</span><br><span class="line">CXX="clang++"</span><br><span class="line">CGO_ENABLED="1"</span><br><span class="line">GOMOD="/dev/null"</span><br><span class="line">CGO_CFLAGS="-g -O2"</span><br><span class="line">CGO_CPPFLAGS=""</span><br><span class="line">CGO_CXXFLAGS="-g -O2"</span><br><span class="line">CGO_FFLAGS="-g -O2"</span><br><span class="line">CGO_LDFLAGS="-g -O2"</span><br><span class="line">PKG_CONFIG="pkg-config"</span><br><span class="line">GOGCCFLAGS="-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/3t/8jsg2cz52yn2glq8rk_9y7x40000gn/T/go-build233814295=/tmp/go-build -gno-record-gcc-switches -fno-common"</span><br></pre></td></tr></table></figure>
<h4 id="GO111MODULE"><a href="#GO111MODULE" class="headerlink" title="GO111MODULE"></a>GO111MODULE</h4><p>透過GO111MODULE作為該專案是否使用 Go modules的開關，可設定以下內容</p>
<ul>
<li>auto: 只要專案包含 <code>go.mod</code> 檔案，就使用Go modules (在Go 1.11~1.14，為預設)</li>
<li>on: 啟用Go modules (推薦使用)</li>
<li>off: 禁用Go modules</li>
</ul>
<div style="
border-radius: 10px;
padding: 20px;
background-color: #C8FAFF;
color: black;
margin-bottom: 15px;
"><br>為何叫做 GO111MODULE?<br><br>因為go modules是在 go1.11版本所提出的<br></div>

<h4 id="GOPROXY"><a href="#GOPROXY" class="headerlink" title="GOPROXY"></a>GOPROXY</h4><p>設定GO模組的proxy, 使Go在後續拉取模組的版本時，直接透過映像檔網站快速拉取，而非到Github這種Version control service平台</p>
<p>GOPROXY預設值為 <code>https://proxy.golang.org,direct</code>，透過逗號將代理的地方給隔開</p>
<p>若不想使用GOPROXY, 可設置為 GOPROXY=”off”</p>
<p>其中最後有 <code>direct</code> 一詞的用意是，若前面的proxy值都沒辦法載到<br>模組，例如在 <code>https://proxy.golang.org</code>抓不到，那麼就會回到原位置(例如Github)去下載</p>
<h4 id="GOSUMDB"><a href="#GOSUMDB" class="headerlink" title="GOSUMDB"></a>GOSUMDB</h4><p>GOSUMDB為Go checksum database，驗證拉取的模組版本資料未經過竄改</p>
<p>預設值為 <code>sum.golang.org</code>，也可設置成 <code>off</code>，禁止Go在後續操作中做驗證版本的動作</p>
<h4 id="GONOPROXY-GONOSUMDB-GOPRIVATE"><a href="#GONOPROXY-GONOSUMDB-GOPRIVATE" class="headerlink" title="GONOPROXY/GONOSUMDB/GOPRIVATE"></a>GONOPROXY/GONOSUMDB/GOPRIVATE</h4><p>設定私有模組的環境變數，一般來說建議直接設定 GONOPROXY，會作為 GONOPROXY與GONOSUMDB的預設值</p>
<p>值可設定多組，例如<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GOPRIVATE="git.xxx.com,github.com/eddycjy/mquote"</span><br></pre></td></tr></table></figure></p>
<p>設定之後字首為 <code>git.xxx.com</code> 以及 <code>github.com/eddycjy/mquote</code> 的模組會被認為是私有模組</p>
<p>也可以直接用設定 <code>*</code>，以下表示來自<code>.example.com</code> 的子域名的都表示來自私有倉庫</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GOPRIVATE="*.example.com"</span><br></pre></td></tr></table></figure>
<h3 id="啟用方式"><a href="#啟用方式" class="headerlink" title="啟用方式"></a>啟用方式</h3><p>Go modules預設不是開啟的，透過<code>GO111MODULE</code>來做設定，可用<code>auto</code>, <code>on</code>, <code>off</code>做設定</p>
<p>透過env進行設定 <code>go env -w</code><br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go env -w GO111MODULE=on</span><br></pre></td></tr></table></figure></p>
<h3 id="初始化一個專案"><a href="#初始化一個專案" class="headerlink" title="初始化一個專案"></a>初始化一個專案</h3><p>在一個資料夾內，透過 <code>go mod init</code> 初始化一個專案</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go mod init github.com/jellyhola/module-repo</span><br><span class="line">go: creating new go.mod: module github.com/jellyhola/module-repo</span><br></pre></td></tr></table></figure>
<p>這時會產生一個 <code>go.mod</code> 檔案，會紀錄目前專案模組為 <code>github.com/jellyhola/module-repo</code>，go版本為<code>1.15</code><br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line">go 1.15</span><br></pre></td></tr></table></figure></p>
<p>這時定義一份 <code>main.go</code> 檔案，import <code>github.com/example/hello</code><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"rsc.io/quote"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	Hello()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Hello :print quote.Hello()</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hello</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> quote.Hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>這時專案目錄會自動產生 <code>go.sum</code>檔案, 以及<code>go.mod</code>會多紀錄使用了 <code>rsc.io/quote</code>模組以及使用的版本為 <code>1.5.2</code></p>
<p>go.sum<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c h1:qgOY6WgZOaTkIIMiVjBQcw93ERBE4m30iBm00nkL0i8=</span><br><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=</span><br><span class="line">rsc.io/quote v1.5.2 h1:w5fcysjrx7yqtD/aO+QwRjYZOKnaM9Uh2b40tElTs3Y=</span><br><span class="line">rsc.io/quote v1.5.2/go.mod h1:LzX7hefJvL54yjefDEDHNONDjII0t9xZLPXsUe+TKr0=</span><br><span class="line">rsc.io/sampler v1.3.0 h1:7uVkIFmeBqHfdjD+gZwtXXI+RODJ2Wc4O7MPEh/QiW4=</span><br><span class="line">rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA=</span><br></pre></td></tr></table></figure></p>
<p>go.mod<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line">go 1.15</span><br><span class="line"></span><br><span class="line">require rsc.io/quote v1.5.2</span><br></pre></td></tr></table></figure></p>
<div style="
border-radius: 10px;
padding: 20px;
background-color: #C8FAFF;
color: black;
margin-bottom: 15px;
"><br><br>建議將 go.sum與go.mod這兩個檔案提交到版本控制<br><br></div>

<p>由於本身<code>rsc.io/quote</code>這個模組，下載go時就已經安裝完畢，故不用透過 <code>go get</code>來額外下載</p>
<p>接著可用<code>go list -m all</code> 檢視目前專案所使用的依賴</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go list -m all</span><br><span class="line">github.com/jellyhola/module-repo</span><br><span class="line">golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c</span><br><span class="line">rsc.io/quote v1.5.2</span><br><span class="line">rsc.io/sampler v1.3.0</span><br></pre></td></tr></table></figure>
<p>可看到目前 <code>golang.org/x/text</code>這項模組，為untagged的狀況，接著可以透過 <code>go get</code>來更新此模組到最新的tag</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go get golang.org/x/text</span><br><span class="line">go: golang.org/x/text upgrade =&gt; v0.3.4</span><br><span class="line">go: downloading golang.org/x/text v0.3.4</span><br></pre></td></tr></table></figure>
<p>可看到 go.mod內容改變了<br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module github.com/jellyhola/module-repo</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.15</span></span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">	golang.org/x/text v0<span class="number">.3</span><span class="number">.4</span> <span class="comment">// indirect</span></span><br><span class="line">	rsc.io/quote v1<span class="number">.5</span><span class="number">.2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>其中 <code>// indirect</code> 表示該模組為間接依賴，表示目前應用程式的import敘述中，並沒有發現這模組的明確參考，有可能是</p>
<ul>
<li>事先手動go get拉取下來的模組</li>
<li>該專案所依賴模組之所依賴的</li>
</ul>
<p>試著跑一下專案，驗證模組是否能正常運作</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> go run main.go</span><br><span class="line">你好，世界。%</span><br></pre></td></tr></table></figure>
<h3 id="拉取的模組會存在哪？"><a href="#拉取的模組會存在哪？" class="headerlink" title="拉取的模組會存在哪？"></a>拉取的模組會存在哪？</h3><p>go mod會將拉取的模組放置在 <code>$GOPATH/pkg/mod</code> 與 <code>$GOPATH/pkg/sumdb</code> 目錄下！</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ls $GOPATH/pkg</span><br><span class="line">cache      github.com golang.org  rsc.io</span><br></pre></td></tr></table></figure>
<p>若想要清除已經快取的模組版本，使用 <code>go clean -modcache</code> 指令</p>
<h2 id="Go-module-進階探討"><a href="#Go-module-進階探討" class="headerlink" title="Go module 進階探討"></a>Go module 進階探討</h2><h3 id="Go-modules的go-get探討"><a href="#Go-modules的go-get探討" class="headerlink" title="Go modules的go get探討"></a>Go modules的go get探討</h3><p>使用go get取得模組時，會分別進行3個步驟</p>
<ol>
<li>finding: 查找模組是否存在</li>
<li>downloading: 進行下載</li>
<li>extracting: 分析下載的模組的雜湊值是否正確</li>
</ol>
<p>像上一節所拉取的模組 <code>golang.org/x/text</code> 其拉取的資訊如下</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">版本資訊-commit的時間-雜湊值</span><br><span class="line">v0.0.0-20170915032832-14c0d48ead0c</span><br></pre></td></tr></table></figure>
<ul>
<li>commit的時間會是以UTC時區為準</li>
<li>go get拉取的指令若沒有指定版本，會直接拉取到 v0.0.0版</li>
</ul>
<h3 id="go-get行為"><a href="#go-get行為" class="headerlink" title="go get行為"></a>go get行為</h3><ul>
<li>go get: 直接拉取dependency，只會更新指定的他自己</li>
<li>go get -u: 更新現有的dependency，會強制更新該denpendency所依賴的其他模組</li>
<li>go get -u -t: 更新所有denpendency，以及包含單元測試使用到的</li>
</ul>
<h3 id="go-get版本指定"><a href="#go-get版本指定" class="headerlink" title="go get版本指定"></a>go get版本指定</h3><ul>
<li>go get golang.org/x/text@latest : 拉取最新的版本，若存在tag，優先使用之</li>
<li>go get golang.org/x/text@master : 拉取master分支的最新commit</li>
<li>go get <a href="mailto:golang.org/x/text@v0.3.2" target="_blank" rel="noopener">golang.org/x/text@v0.3.2</a> : 拉取tag為v0.3.2的commit</li>
<li>go get golang.org/x/text@342b2e : 拉取hash為342b2e的commit，最後轉為 v0.3.2</li>
</ul>
<h2 id="Go-modules的go-run與go-build"><a href="#Go-modules的go-run與go-build" class="headerlink" title="Go modules的go run與go build"></a>Go modules的go run與go build</h2><p>執行go build時，會根據go.mod自動下載該專案所需的模組，才進行編譯</p>
<div style="
border-radius: 10px;
padding: 20px;
background-color: #FFF6C8;
color: black;
margin-bottom: 15px;
"><br><br>若是要使用 vendor目錄作為denpendency, 在執行 go mod vendor產生vendor目錄後，需要執行 go build -mod=vendor<br>才可使用 go build -mod=vendor 使用vendor目錄作為denpendency來編譯<br><br></div>

<h2 id="Go-modules匯入路徑說明"><a href="#Go-modules匯入路徑說明" class="headerlink" title="Go modules匯入路徑說明"></a>Go modules匯入路徑說明</h2><p>Go modules在主版本編號為 v0與v1的情況會省略其編號，在v2以上則需要明確指定！</p>
<p>假如要匯入 v2以上的<a href="mailto:golang.org/example@v2.0.0" target="_blank" rel="noopener">golang.org/example@v2.0.0</a>，則必須要在import底下明確指定v2</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"github.com/example/v2"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="為何省略v0與v1"><a href="#為何省略v0與v1" class="headerlink" title="為何省略v0與v1??"></a>為何省略v0與v1??</h3><p>因為官方鼓勵開發人員將模組建立到v1版本就不在變動。</p>
<p>所以若開發人員在發佈v2版本時，會被擁有明確的v1版本尾綴，近一步導致v1版本變成雜訊且沒有什麼意義</p>
<p>在匯入路徑忽略v0版本，因為根據語意化版本標準，v0的這些版本大多沒有相容性保證</p>
<h2 id="Go-modules-語意化版本控制"><a href="#Go-modules-語意化版本控制" class="headerlink" title="Go modules 語意化版本控制"></a>Go modules 語意化版本控制</h2><p>一個go modules的版本資訊如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//主版本號.次版本號.修訂號</span><br><span class="line">v1.2.3</span><br></pre></td></tr></table></figure></p>
<ul>
<li>主版本編號：做了不相容的API修改之類的</li>
<li>次版本編號: 做了向下相容的功能性新增</li>
<li>修訂好: 向下相容的功能除錯</li>
</ul>
<p>若是先行版本的話，那加上 <code>pre</code> 後綴<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1.2.3-pre</span><br></pre></td></tr></table></figure></p>
<div style="
border-radius: 10px;
padding: 20px;
background-color: #FFF6C8;
color: black;
margin-bottom: 15px;
"><br><br>發佈新版本時應遵循語意化版本規則，否則無法被go get所拉取<br><br></div>

<h2 id="go-list的功能"><a href="#go-list的功能" class="headerlink" title="go list的功能"></a>go list的功能</h2><p>提供該專案所有denpendency的資訊</p>
<p>透過 <code>go list -m -u all</code> 可以檢視所有的dependency資訊</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ go list -m -u all</span><br><span class="line">github.com/jellyhola/module-repo</span><br><span class="line">golang.org/x/text v0.3.4</span><br><span class="line">golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e</span><br><span class="line">rsc.io/quote v1.5.2</span><br><span class="line">rsc.io/sampler v1.3.0</span><br></pre></td></tr></table></figure>
<ul>
<li>-m: 顯示所有依賴的模組</li>
<li>-u: 顯示能夠升級的版本</li>
</ul>


    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Golang/">Golang</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/10/04/gitbook-tutorial/">
        Gitbook的使用紀錄
      </a>
    </h2>
    
    <time>
      Oct 4, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>Gitbook提供了能夠將markdown格式轉寫成一本電子書的樣子</p>

    
	  <div class="readmore">
      <a href="/2020/10/04/gitbook-tutorial/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Tool/">Tool</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/08/17/Static_vs_Shared_Lib/">
        Static 與 Shared Libraries的介紹與差異
      </a>
    </h2>
    
    <time>
      Aug 17, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>剛好在複習Golang的時候看到Go有支援載入C Language的Static Library與Shared Libraries，於是來複習一下他們之間的差異</p>

    
	  <div class="readmore">
      <a href="/2020/08/17/Static_vs_Shared_Lib/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Computer-Science/">Computer Science</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/08/08/Design-Pattern-Java-State-Pattern-狀態模式/">
        State Pattern 狀態模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Aug 8, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>透過統一的”狀態類別”，來定義物件的內部狀態是如何</p>

    
	  <div class="readmore">
      <a href="/2020/08/08/Design-Pattern-Java-State-Pattern-狀態模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/08/06/Design-Pattern-Java-Composite-Pattern-合成模式/">
        Composite Pattern 合成模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Aug 6, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>將有階層關係的類別狀態給扁平化，給使用者看到的是一致性的關係</p>

    
	  <div class="readmore">
      <a href="/2020/08/06/Design-Pattern-Java-Composite-Pattern-合成模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/08/03/Design-Pattern-Java-Iterator-Pattern-反覆器模式/">
        Iterator Pattern 反覆器模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Aug 3, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>將處理陣列或是取值方式的邏輯給封裝起來，不需讓使用者直接處理操作取值的邏輯</p>

    
	  <div class="readmore">
      <a href="/2020/08/03/Design-Pattern-Java-Iterator-Pattern-反覆器模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/07/29/Design-Pattern-Java-Template-Pattern-樣板模式/">
        Template Pattern 樣板模式  [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Jul 29, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>樣板, 顧名思義就是把同樣的邏輯定義成一個樣板, 可讓其他類別共同使用</p>
<p>樣板也會開放可客製化的方法 (抽象方法), 供其他類別實作</p>

    
	  <div class="readmore">
      <a href="/2020/07/29/Design-Pattern-Java-Template-Pattern-樣板模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/07/29/Design-Pattern-Java-Facade-Pattern-表象模式/">
        Facade Pattern 表象模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Jul 29, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>將複雜的類別關係, 用一個類別包裝起來, 供呼叫</p>
<p>不會讓使用者直接看到背後複雜的邏輯, 只會看到 “表面的現象”, 故叫做表象模式</p>

    
	  <div class="readmore">
      <a href="/2020/07/29/Design-Pattern-Java-Facade-Pattern-表象模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/07/29/Design-Pattern-Java-Adaptor-Pattern-轉接器模式/">
        Adaptor Pattern 轉接器模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Jul 29, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>假如要使用A, 但無法直接使用, 只能使用B介面</p>
<p>所以我們用轉接器類別包裝A的方法，並且實作B，達到轉接的效果</p>

    
	  <div class="readmore">
      <a href="/2020/07/29/Design-Pattern-Java-Adaptor-Pattern-轉接器模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
    <div class="post-wrapper">
      <article class="post reveal">
  <section class="meta">
    
    <h2 class="title">
      <a href="/2020/07/26/Design-Pattern-Java-Observer-Pattern-觀察者模式/">
        Observer Pattern 觀察者模式 [Design Pattern in Java]
      </a>
    </h2>
    
    <time>
      Jul 26, 2020
    </time>
		
  </section>
  <section class="article typo">
	  <p>觀察者模式可以讓物件了解資料變化的情況。<br>物件甚至可以在執行期間決定是否要繼續被通知，又或者是可以主動去詢問資料的狀態。<br>在此模式中也會了解一對多，以及物件鬆綁的意義是如何。</p>

    
	  <div class="readmore">
      <a href="/2020/07/26/Design-Pattern-Java-Observer-Pattern-觀察者模式/">Read More</a>
    </div>
    
    
    
	  <div class="full-width auto-padding tags">
      
        <a href="/tags/Design-Pattern/">Design Pattern</a>
      
	  </div>
    
  </section>
</article>
    </div>
  
</section>


  <nav id="page-nav">
    
    
    <a class="next" rel="next" href="/archives/2020/page/2/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  


      </div>
      <aside class='l_side'>
        
  <section class="m_widget about">

<img class="avatar waves-image" src="/images/william.png">

<div class="header">William L.K.</div>
<div class="content">
<div class="desc">
  <span>這裡為整理我網站開發學習記錄的Blog，偶爾紀錄一些讀書心得之類的事</span><br><br>
  <span>下方Links有我在HackMD上面隨手紀錄的筆記，請多多指教</span>
</div>
</div>
</section>

  <section class="m_widget links">
<div class="header">Links</div>
<div class="content">
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://hackmd.io/aM_7XTXfSa2eo5uaiOHBrw">
            <div class="name">Git筆記整理</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://hackmd.io/Lln8jajXSQGRwc1Csey7rA">
            <div class="name">Linux筆記整理</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://hackmd.io/TqzyDhnRQXaoXktvgiyMwQ">
            <div class="name">OS筆記整理</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://github.com/a10000005588/Leetcode-Java-2020">
            <div class="name">Leetcode刷題紀錄(使用Java)</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://hackmd.io/P7WDzlCrRGCKbO_Y_t3wWw">
            <div class="name">Solidity以太坊智能合約開發筆記整理</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://hackmd.io/imaqKW5_S7icDtMAcvDk9Q">
            <div class="name">Docker筆記</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class="m_widget categories">
<div class="header">Categories</div>
<div class="content">
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/Consensus/"><div class="name">Consensus</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Ethereum/"><div class="name">Ethereum</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Golang/"><div class="name">Golang</div><div class="badget">4</div></a></li>
    
        <li><a class="flat-box" href="/categories/Hexo/"><div class="name">Hexo</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Javascript/"><div class="name">Javascript</div><div class="badget">2</div></a></li>
    
        <li><a class="flat-box" href="/categories/Life/"><div class="name">Life</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Solidity/"><div class="name">Solidity</div><div class="badget">5</div></a></li>
    
        <li><a class="flat-box" href="/categories/Spring/"><div class="name">Spring</div><div class="badget">2</div></a></li>
    
    </ul>
    
</div>
</section>

  
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class="content">
        <a href="/tags/Authentication/" style="font-size: 14px; color: #808080">Authentication</a> <a href="/tags/Blockchain/" style="font-size: 16.4px; color: #4d4d4d">Blockchain</a> <a href="/tags/Computer-Science/" style="font-size: 14px; color: #808080">Computer Science</a> <a href="/tags/Consensus/" style="font-size: 14px; color: #808080">Consensus</a> <a href="/tags/Design-Pattern/" style="font-size: 20px; color: #000">Design Pattern</a> <a href="/tags/Ethereum/" style="font-size: 18.8px; color: #1a1a1a">Ethereum</a> <a href="/tags/Frontend/" style="font-size: 14px; color: #808080">Frontend</a> <a href="/tags/Golang/" style="font-size: 18.8px; color: #1a1a1a">Golang</a> <a href="/tags/Java/" style="font-size: 15.2px; color: #666">Java</a> <a href="/tags/Javascript/" style="font-size: 15.2px; color: #666">Javascript</a> <a href="/tags/Life/" style="font-size: 15.2px; color: #666">Life</a> <a href="/tags/Smart-Contract/" style="font-size: 14px; color: #808080">Smart Contract</a> <a href="/tags/Solidity/" style="font-size: 17.6px; color: #333">Solidity</a> <a href="/tags/Spring/" style="font-size: 15.2px; color: #666">Spring</a> <a href="/tags/Tool/" style="font-size: 14px; color: #808080">Tool</a> <a href="/tags/Truffle/" style="font-size: 15.2px; color: #666">Truffle</a>
    </div>
</div>



      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/" class="social github" target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/" class="social twitter" target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss" target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>Theme <a href="https://github.com/stkevintan/hexo-theme-material-flow" class="codename">MaterialFlow</a> designed by <a href="http://keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  
<script>
  var disqus_shortname = 'William';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/node-waves/0.7.5/waves.min.js"></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
</body>
</html>
